/*! For license information please see 568.07e119b271a5cff8cdcf.js.LICENSE.txt */
(self.webpackChunkwidget_bandsplot=self.webpackChunkwidget_bandsplot||[]).push([[568],{2643:(t,e,n)=>{var o=n(8628).BandPlot,a=n(8628).getPathStringFromPathArray,s=n(8628).getValidPointNames,i=n(8628).getPathArrayFromPathString,r=n(969);n(548),plots={},t.exports={bandPlot:function(t,e,n,l,d,c,u,m){plots[t]={};var h=window.performance.now();console.log("start time: plotting band plot: current time => ",t,h);var p=new o(t,d,c,u);n.forEach((function(t,e){var n;if(void 0!==m){var o=tinycolor(m[e]);n=[o.toHexString(),o.darken(20).toHexString(),o.brighten(20).toHexString()]}p.addBandStructure(t,n)})),p.addDos(l),p.updateBandPlot();var f=document.getElementById(e);f.value=a(p.getDefaultPath()),f.onkeyup=function(){var t=document.getElementById(e).value,n=i(t);p.updateBandPlot(n)},s(p.allData).join(", "),plots[t].plotObj=p,document.getElementById(t+"bt-reset").onclick=function(){document.getElementById(e).value=a(p.getDefaultPath()),p.updateBandPlot(p.getDefaultPath(),!0)},document.getElementById(t+"bt-resetZoom").onclick=function(){p.resZoom()},document.getElementById(t+"bt-dragPan").onclick=function(){r("#"+t+"bt-dragPan").addClass("button"),r("#"+t+"bt-dragPan").removeClass("button-white"),r("#"+t+"bt-dragZoom").addClass("button-white"),r("#"+t+"bt-dragZoom").removeClass("button"),p.myChart.options.pan={enabled:!0,mode:"y",onPanComplete:function(t){p.myDos.options.scales.yAxes[0].ticks.min=p.myChart.options.scales.yAxes[0].ticks.min,p.myDos.options.scales.yAxes[0].ticks.max=p.myChart.options.scales.yAxes[0].ticks.max,p.myDos.update()}},p.myChart.options.zoom={enabled:!1,mode:"y",drag:!0},p.myChart.update(),p.myDos.options.pan={enabled:!0,mode:"y",onPanComplete:function(t){p.myChart.options.scales.yAxes[0].ticks.min=p.myDos.options.scales.yAxes[0].ticks.min,p.myChart.options.scales.yAxes[0].ticks.max=p.myDos.options.scales.yAxes[0].ticks.max,p.myChart.update()}},p.myDos.options.zoom={enabled:!1,mode:"y",drag:!0},p.myDos.update()},document.getElementById(t+"bt-dragZoom").onclick=function(){r("#"+t+"bt-dragZoom").addClass("button"),r("#"+t+"bt-dragZoom").removeClass("button-white"),r("#"+t+"bt-dragPan").addClass("button-white"),r("#"+t+"bt-dragPan").removeClass("button"),p.myChart.options.pan={enabled:!1,mode:"y"},p.myChart.options.zoom={enabled:!0,mode:"y",drag:!0,onZoomComplete:function(t){p.myDos.options.scales.yAxes[0].ticks.min=p.myChart.options.scales.yAxes[0].ticks.min,p.myDos.options.scales.yAxes[0].ticks.max=p.myChart.options.scales.yAxes[0].ticks.max,p.myDos.update()}},p.myChart.update(),p.myDos.options.pan={enabled:!1,mode:"y"},p.myDos.options.zoom={enabled:!0,mode:"y",drag:!0,onZoomComplete:function(t){p.myChart.options.scales.yAxes[0].ticks.min=p.myDos.options.scales.yAxes[0].ticks.min,p.myChart.options.scales.yAxes[0].ticks.max=p.myDos.options.scales.yAxes[0].ticks.max,p.myChart.update()}},p.myDos.update()};var g=document.getElementById(t+"bt-togglePdos");g.onclick=function(){if(g.classList.contains("button")){r("#"+t+"bt-togglePdos").addClass("button-white"),r("#"+t+"bt-togglePdos").removeClass("button");for(var e=1;e<p.dosSeries.length;e++)p.dosSeries[e].hidden=!0;p.myDos.update()}else{for(r("#"+t+"bt-togglePdos").addClass("button"),r("#"+t+"bt-togglePdos").removeClass("button-white"),e=1;e<p.dosSeries.length;e++)p.dosSeries[e].hidden=!1;p.myDos.update()}},console.log("end time: plotting band plot: current time, total time => ",t,window.performance.now(),window.performance.now()-h)}}},8628:(t,e,n)=>{var o=n(800);const{nodeName:a}=n(969);var s=n(8115);n(548),n(7990);var i=function(){var t=[].slice.call(arguments),e=0===t.length?[]:t.reduce((function(t,e){return t.length<e.length?t:e}));return e.map((function(e,n){return t.map((function(t){return t[n]}))}))};function r(t){var e=[];t.forEach((function(t){t.hasOwnProperty("paths")&&t.paths.forEach((function(t){e.push(t.from),e.push(t.to)}))}));var n=Array.from(new Set(e));return n.sort(),n}var l=function(t,e,n,o){this.divID=t,this.allData=[],this.dosData={},this.allSeries=[],this.dosSeries=[],this.allColorInfo=[],this.dosColorInfo=[],this.dosBackgroundColorInfo=[],this.currentPath=[],this.fermiEnergy=e,this.showFermi=n,this.yLimit=o,this.yLabel="",void 0!==this.myChart&&this.myChart.destroy()};l.prototype.addBandStructure=function(t,e){var n=["#555555","#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00"];if(void 0===e){var o=this.allColorInfo.length,a=s(n[o%n.length]);e=[a.toHexString(),a.darken(20).toHexString(),a.brighten(20).toHexString()]}this.allColorInfo.push(e),this.allData.push(t)},l.prototype.addDos=function(t){this.dosData=t;var e=1+t.pdos.length,n=["#555555","#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"];for(let t=0;t<e;t++){var o=s(n[t%n.length]);this.dosColorInfo.push(o);var a=s(n[t%n.length]);a.setAlpha(.4),this.dosBackgroundColorInfo.push(a)}console.log(this.dosColorInfo),console.log(this.backgroundColor)},l.prototype.initChart=function(t){var e=this,n={type:"scatter",data:{datasets:this.allSeries},options:{legend:{display:!1},animation:{duration:0},hover:{animationDuration:0,mode:"point"},responsiveAnimationDuration:0,elements:{line:{tension:0}},responsive:!0,maintainAspectRatio:!1,tooltips:!1,scales:{xAxes:[{display:!0,ticks:{callback:function(t,e,n){return this.options.customTicks[e].label}},customTicks:t,afterBuildTicks:function(t,e){return t.options.customTicks.map((function(t){return t.value}))}}],yAxes:[{display:!0,ticks:{callback:function(t,e,n){if(0!==e&&e!=n.length-1)return t}},scaleLabel:{display:!0},gridLines:{display:!1}}]},zoom:{enabled:!0,mode:"y",drag:!0,onZoomComplete:function(t){e.myDos.options.scales.yAxes[0].ticks.min=e.myChart.options.scales.yAxes[0].ticks.min,e.myDos.options.scales.yAxes[0].ticks.max=e.myChart.options.scales.yAxes[0].ticks.max,e.myDos.update()}}}};e.yLimit&&(n.options.scales.yAxes[0].ticks.min=e.yLimit.ymin,n.options.scales.yAxes[0].ticks.max=e.yLimit.ymax),e.xLimit&&(n.options.scales.xAxes[0].ticks.min=e.xLimit.xmin,n.options.scales.xAxes[0].ticks.max=e.xLimit.xmax),e.yLabel&&(n.options.scales.yAxes[0].scaleLabel.labelString=e.yLabel);var a=document.getElementById(this.divID).getContext("2d");e.myChart=new o(a,n);var s={type:"line",id:"fermiLine",scaleID:"dosA",mode:"horizontal",value:0,borderColor:"red",borderWidth:2,label:{enabled:!0,position:"right",content:"Fermi",xAdjust:4}};!1===this.showFermi&&(s={}),dosOptions={type:"scatter",data:{datasets:this.dosSeries},options:{responsive:!0,maintainAspectRatio:!1,animation:{duration:0},hover:{animationDuration:0,mode:null},responsiveAnimationDuration:0,legend:{display:!0,position:"right"},scales:{xAxes:[{gridLines:{display:!0,drawBorder:!0,drawOnChartArea:!1,zeroLineWidth:2},ticks:{min:0}}],yAxes:[{id:"dosA",display:!0,position:"right",gridLines:{display:!0,drawBorder:!0,drawOnChartArea:!1,tickMarkLength:0},ticks:{min:e.yLimit.ymin,max:e.yLimit.ymax,padding:10,callback:function(t,e,n){if(0!==e&&e!=n.length-1)return t}},scaleLabel:{display:!0,labelString:"Density of States (eV)"}},{display:!0,position:"left",gridLines:{display:!0,drawBorder:!0,drawOnChartArea:!1,tickMarkLength:0},ticks:{display:!1}}]},annotation:{annotations:[s]},elements:{point:{radius:0}},zoom:{enabled:!0,mode:"y",drag:!0,onZoomComplete:function(t){e.myChart.options.scales.yAxes[0].ticks.min=e.myDos.options.scales.yAxes[0].ticks.min,e.myChart.options.scales.yAxes[0].ticks.max=e.myDos.options.scales.yAxes[0].ticks.max,e.myChart.update()}}}};var i=document.getElementById(this.divID+"dos").getContext("2d");e.myDos=new o(i,dosOptions)},l.prototype.getDefaultPath=function(){return this.allData.length>0?this.allData[0].path:[]},l.prototype.updateBandPlot=function(t,e){var n=this,o=null;void 0===e&&(e=!1),o=void 0===t?n.getDefaultPath():t;var a=!1;if(n.currentPath.length!=o.length?a=!0:i(n.currentPath,o).forEach((function(t){t[0][0]!=t[1][0]&&(a=!0),t[0][1]!=t[1][1]&&(a=!0)})),a||e){n.currentPath=o;var s=0,r=[];n.allSeries=[],n.dosSeries=[],o.forEach((function(t,e){0===r.length?r.push([s,t[0]]):r[r.length-1][1]!=t[0]&&(r[r.length-1][1]+="|"+t[0]);var o,a=!1,l=null;n.allData.forEach((function(e,r){var d=function(t,e){for(var n=0;n<e.length;n++){var o=e[n];if(o.from==t[0]&&o.to==t[1])return{segment:o,reverse:!1};if(o.from==t[1]&&o.to==t[0])return{segment:o,reverse:!0}}return null}(t,e.paths);if(d){a=!0;var c=[],u=d.segment.x.length;if(d.reverse)for(o=d.segment.x.length-1;o>=0;o--)c.push(d.segment.x[u-1]-d.segment.x[o]);else for(o=0;o<u;o++)c.push(d.segment.x[o]-d.segment.x[0]);var m=d.segment.two_band_types||!1,h=d.segment.values.length;null===l&&(l=c[c.length-1]);var p=1;if(c[c.length-1]>0)for(p=l/c[c.length-1],o=0;o<c.length;o++)c[o]*=p;l>0&&d.segment.values.forEach((function(e,o){var a,l=[];if(a=d.reverse?e.slice().reverse():e,n.fermiEnergy){var u=a.map((function(t){return t-n.fermiEnergy}));a=u}i(c,a).forEach((function(t){l.push({x:t[0]+s,y:t[1]})}));var p,f=n.allColorInfo[r];p=m?2*o<h?f[1]:f[2]:f[0];var g={label:t[0]+"-"+t[1]+"."+o,borderColor:p,borderWidth:2,data:l,fill:!1,showLine:!0,pointRadius:0};n.allSeries.push(g)}))}})),s+=a&&l>0?l:.1,r.push([s,t[1]])}));var l=n.updateTicks(r).map((function(t,e){return{value:t[0],label:t[1]}}));n.xLimit={xmin:0,xmax:s},n.yLabel=n.allData[0].Y_label,void 0===n.yLabel&&(n.yLabel="Electronic bands (eV)"),void 0===n.myChart?n.initChart(l):(n.myChart.options.scales.xAxes[0].customTicks=l,n.myChart.data.datasets=n.allSeries,n.myChart.options.scales.xAxes[0].ticks.max=s,n.myChart.update()),curve=[];var d=n.dosData.tdos["energy | eV"].data,c=n.dosData.tdos.values["dos | states/eV"].data;d.forEach((function(t,e){curve.push({x:c[e],y:t-n.fermiEnergy})}));var u={borderColor:n.dosColorInfo[0],backgroundColor:n.dosBackgroundColorInfo[0],borderWidth:2,data:curve,fill:!0,showLine:!0,pointRadius:0,label:"Total"};n.dosSeries.push(u);for(let t=1;t<n.dosColorInfo.length;t++){curve=[];var m=n.dosData.pdos[t-1]["energy | eV"].data,h=n.dosData.pdos[t-1]["pdos | states/eV"].data;m.forEach((function(t,e){curve.push({x:h[e],y:t-n.fermiEnergy})}));var p={borderColor:n.dosColorInfo[t],backgroundColor:n.dosBackgroundColorInfo[t],hidden:!1,borderWidth:1,data:curve,fill:!0,showLine:!0,pointRadius:0,label:n.dosData.pdos[t-1].kind+" "+n.dosData.pdos[t-1].orbital};n.dosSeries.push(p)}console.log(n.dosColorInfo),n.myDos.update()}},l.prototype.resZoom=function(){var t=this;t.myChart.resetZoom(),t.myChart.options.scales.xAxes[0].ticks.min=t.xLimit.xmin,t.myChart.options.scales.xAxes[0].ticks.max=t.xLimit.xmax,t.myChart.options.scales.yAxes[0].ticks.min=t.yLimit.ymin,t.myChart.options.scales.yAxes[0].ticks.max=t.yLimit.ymax,t.myChart.update(),t.myDos.resetZoom(),t.myDos.options.scales.yAxes[0].ticks.min=t.yLimit.ymin,t.myDos.options.scales.yAxes[0].ticks.max=t.yLimit.ymax,t.myDos.update()},l.prototype.updateTicks=function(t){var e,n=function(t,n){var o={};for(e=0;e<n.length;e++)o[n[e][0]]=n[e][1];var a,s,i=r([t]);return s=-1==i.findIndex((function(t){return"GAMMA"==t}))&&-1!=i.findIndex((function(t){return"G"==t})),a=s?function(t){return"G"==t&&(t="Γ"),(t=t.replace(/\-/gi,"—")).replace(/(\d)/gi,(function(t,e,n,o){switch(e){case"0":return"₀";case"1":return"₁";case"2":return"₂";case"3":return"₃";case"4":return"₄";case"5":return"₅";case"6":return"₆";case"7":return"₇";case"8":return"₈";case"9":return"₉"}return e}))}:function(t){return(t=(t=(t=(t=(t=t.replace(/GAMMA/gi,"Γ")).replace(/DELTA/gi,"Δ")).replace(/SIGMA/gi,"Σ")).replace(/LAMBDA/gi,"Λ")).replace(/\-/gi,"—")).replace(/_(.)/gi,(function(t,e,n,o){switch(e){case"0":return"₀";case"1":return"₁";case"2":return"₂";case"3":return"₃";case"4":return"₄";case"5":return"₅";case"6":return"₆";case"7":return"₇";case"8":return"₈";case"9":return"₉"}return e}))},function(t){return void 0===t?t:a(t)}}(this.allData,t);return t.map((function(t){return[t[0],n(t[1])]}))},t.exports={BandPlot:l,getPathStringFromPathArray:function(t){var e=[],n="";return t.forEach((function(t){0===e.length?(e+=t[0],e+="-",e+=t[1]):(n!=t[0]&&(e+="|"+t[0]),e+="-",e+=t[1]),n=t[1]})),e},getValidPointNames:r,getPathArrayFromPathString:function(t){var e=[];return t.split("|").forEach((function(t){var n=t.split("-").map((function(t){return t.trim()})).filter((function(t){return""!==t}));i(n.slice(0,n.length-1),n.slice(1)).forEach((function(t){e.push([t[0],t[1]])}))})),e}}},3163:(t,e,n)=>{var o=n(1337),a=n(5431),s=n(969),i=(a=n(9827),n(2643).bandPlot);n(6445),n(1768);var r=o.DOMWidgetModel.extend({defaults:a.extend(o.DOMWidgetModel.prototype.defaults(),{_model_name:"BandsplotModel",_view_name:"BandsplotView",_model_module:"widget-bandsplot",_view_module:"widget-bandsplot",_model_module_version:"0.1.0",_view_module_version:"0.1.0",value:"Hello World!"})}),l=o.DOMWidgetView.extend({initialize:function(){this.uuidCanvas=a.uniqueId("bandsCanvas"),this.uuidTextbox=a.uniqueId("bandsTextbox")},render:function(){this.value_changed(),this.model.on("change:value",this.value_changed,this),this.model.on("change:showFermi",this.bandsplot_changed,this),this.model.on("change:bandsData",this.bandsplot_changed,this),this.model.on("change:dosData",this.bandsplot_changed,this),this.model.on("change:fermiEnergy",this.bandsplot_changed,this),this.model.on("change:yLimit",this.bandsplot_changed,this),this.el.innerHTML='<div class="all-widget"><div id="bandsplot-div" class="bands-plot"> <canvas id="'+this.uuidCanvas+'"> </canvas> </div><div id="dosplot-div" class="dos-plot"> <canvas id="'+this.uuidCanvas+'dos"> </canvas> </div><p> <span class="span-label"> Edit the path:</span > <input id="'+this.uuidTextbox+'" class="bands-input" type="text"></input></p><button type="button" id="'+this.uuidCanvas+'bt-reset" class="button"> Reset default path </button><button type="button" id="'+this.uuidCanvas+'bt-resetZoom" class="button"> Reset zoom </button><button type="button" id="'+this.uuidCanvas+'bt-dragZoom" class="button"> Drag (or pinch) to zoom </button><button type="button" id="'+this.uuidCanvas+'bt-dragPan" class="button-white"> Drag to pan </button><button type="button" id="'+this.uuidCanvas+'bt-togglePdos" class="button"> Toggle PDOS </button></div > ';var t=this.model.get("bandsData"),e=this.model.get("dosData"),n=this.model.get("fermiEnergy"),o=this.model.get("yLimit"),a=this.model.get("showFermi");that=this,s(document).ready((function(){i(that.uuidCanvas,that.uuidTextbox,t,e,n,a,o)}))},value_changed:function(){this.el.textContent=this.model.get("value")},bandsplot_changed:function(){var t=this.model.get("bandsData"),e=this.model.get("dosData"),n=this.model.get("fermiEnergy"),o=this.model.get("yLimit"),a=this.model.get("showFermi");i(that.uuidCanvas,that.uuidTextbox,t,e,n,a,o)}});t.exports={BandsplotModel:r,BandsplotView:l}},1568:(t,e,n)=>{t.exports=n(3163),t.exports.version=n(306).version},2210:(t,e,n)=>{"use strict";n.d(e,{Z:()=>s});var o=n(3645),a=n.n(o)()((function(t){return t[1]}));a.push([t.id,"h3 {\n    text-align: center;\n    background-color: red;\n}\n\n.bands-plot {\n    width: 60%;\n    height: 450px;\n    float: left;\n}\n\n.dos-plot {\n    width: 40%;\n    height: 450px;\n    float: right;\n}\n\n.all-widget {\n    width: 100%;\n}\n\n.span-label {\n    width: 10%;\n    font-size: large;\n    font-weight: bold;\n}\n\n.bands-input {\n    width: 60%;\n    font-size: large;\n    font-size: bold;\n}\n\n.button {\n    border-radius: 6px;\n    border-color: #4285F4;\n    background-color: #4285F4;\n    color: white;\n    margin: 5px;\n    height: 28px;\n    font-size: large;\n}\n\n\n.button-white {\n    border-radius: 6px;\n    border-color: #4285F4;\n    background-color: white;\n    color: #4285F4;\n    margin: 5px;\n    height: 28px;\n    font-size: large;\n}",""]);const s=a},3645:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n=t(e);return e[2]?"@media ".concat(e[2]," {").concat(n,"}"):n})).join("")},e.i=function(t,n,o){"string"==typeof t&&(t=[[null,t,""]]);var a={};if(o)for(var s=0;s<this.length;s++){var i=this[s][0];null!=i&&(a[i]=!0)}for(var r=0;r<t.length;r++){var l=[].concat(t[r]);o&&a[l[0]]||(n&&(l[2]?l[2]="".concat(n," and ").concat(l[2]):l[2]=n),e.push(l))}},e}},6445:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>i});var o=n(3379),a=n.n(o),s=n(2210);a()(s.Z,{insert:"head",singleton:!1});const i=s.Z.locals||{}},3379:(t,e,n)=>{"use strict";var o,a=function(){var t={};return function(e){if(void 0===t[e]){var n=document.querySelector(e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}t[e]=n}return t[e]}}(),s=[];function i(t){for(var e=-1,n=0;n<s.length;n++)if(s[n].identifier===t){e=n;break}return e}function r(t,e){for(var n={},o=[],a=0;a<t.length;a++){var r=t[a],l=e.base?r[0]+e.base:r[0],d=n[l]||0,c="".concat(l," ").concat(d);n[l]=d+1;var u=i(c),m={css:r[1],media:r[2],sourceMap:r[3]};-1!==u?(s[u].references++,s[u].updater(m)):s.push({identifier:c,updater:f(m,e),references:1}),o.push(c)}return o}function l(t){var e=document.createElement("style"),o=t.attributes||{};if(void 0===o.nonce){var s=n.nc;s&&(o.nonce=s)}if(Object.keys(o).forEach((function(t){e.setAttribute(t,o[t])})),"function"==typeof t.insert)t.insert(e);else{var i=a(t.insert||"head");if(!i)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");i.appendChild(e)}return e}var d,c=(d=[],function(t,e){return d[t]=e,d.filter(Boolean).join("\n")});function u(t,e,n,o){var a=n?"":o.media?"@media ".concat(o.media," {").concat(o.css,"}"):o.css;if(t.styleSheet)t.styleSheet.cssText=c(e,a);else{var s=document.createTextNode(a),i=t.childNodes;i[e]&&t.removeChild(i[e]),i.length?t.insertBefore(s,i[e]):t.appendChild(s)}}function m(t,e,n){var o=n.css,a=n.media,s=n.sourceMap;if(a?t.setAttribute("media",a):t.removeAttribute("media"),s&&"undefined"!=typeof btoa&&(o+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(s))))," */")),t.styleSheet)t.styleSheet.cssText=o;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(o))}}var h=null,p=0;function f(t,e){var n,o,a;if(e.singleton){var s=p++;n=h||(h=l(e)),o=u.bind(null,n,s,!1),a=u.bind(null,n,s,!0)}else n=l(e),o=m.bind(null,n,e),a=function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(n)};return o(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;o(t=e)}else a()}}t.exports=function(t,e){(e=e||{}).singleton||"boolean"==typeof e.singleton||(e.singleton=(void 0===o&&(o=Boolean(window&&document&&document.all&&!window.atob)),o));var n=r(t=t||[],e);return function(t){if(t=t||[],"[object Array]"===Object.prototype.toString.call(t)){for(var o=0;o<n.length;o++){var a=i(n[o]);s[a].references--}for(var l=r(t,e),d=0;d<n.length;d++){var c=i(n[d]);0===s[c].references&&(s[c].updater(),s.splice(c,1))}n=l}}}},306:t=>{"use strict";t.exports={version:"0.1.0"}}}]);