(self.webpackChunkspreadsheet_editor=self.webpackChunkspreadsheet_editor||[]).push([[553],{553:(e,t,n)=>{"use strict";n.r(t),n.d(t,{CommandIDs:()=>H,SpreadsheetEditorFactory:()=>I,addCreateNewCommands:()=>R,addCreateNewToLauncher:()=>B,addUndoRedoToEditMenu:()=>S,default:()=>z});var s=n(508),o=n(496),l=n(187),i=n(979),a=n(577),h=n(487),r=n(379),c=n.n(r),d=n(760);c()(d.Z,{insert:"head",singleton:!1}),d.Z.locals;var u=n(510),m=n(797),g=n(637),p=n(983),w=n.n(p),v=n(408),x=n.n(v),f=n(168);class _ extends u.Widget{constructor(e){super(),this._ready=new m.PromiseDelegate,this.id=m.UUID.uuid4(),this.title.label=g.PathExt.basename(e.localPath),this.title.closable=!0,this.context=e,this.separator="",this.fitMode="all-equal-default",e.localPath.endsWith("tsv")&&(this.separator="\t"),e.localPath.endsWith("csv")&&(this.separator=","),this.hasFrozenColumns=!1,this.firstRowAsHeader=!1,e.ready.then((()=>{this._onContextReady()})).catch(console.warn),this.changed=new f.Signal(this)}parseValue(e){const t=w().parse(e,{delimiter:this.separator});this.separator||(this.separator=t.meta.delimiter),this.linebreak=t.meta.linebreak,t.errors.length&&console.warn("Parsing errors encountered",t.errors);const n=this.extractColumnNumber(t.data);return void 0===this.columnTypes&&(this.columnTypes=[...Array(n).map((()=>"text"))]),this.firstRowAsHeader?this.header=t.data.shift():this.header=null,t.data}extractColumnNumber(e){return e.length?e[0].length:0}columns(e){const t=[];for(let n=0;n<e;n++)t.push({title:this.header?this.header[n]:null,type:this.columnTypes[n]});return t}onChange(){this.context.model.value.text=this.getValue(),this.changed.emit()}_onContextReady(){if(this.isDisposed)return;const e=this.context.model,t=e.toString(),n=this.parseValue(t),s={data:n,minDimensions:[1,1],csvFileName:this.title.label,columnDrag:!0,onchange:()=>{this.onChange()},oninsertrow:()=>{this.onChange()},oninsertcolumn:()=>{this.onChange(),this.populateColumnTypesBar(),this.onResize()},onmoverow:()=>{this.onChange()},onmovecolumn:()=>{this.onChange()},ondeleterow:()=>{this.onChange()},ondeletecolumn:()=>{this.onChange(),this.populateColumnTypesBar(),this.onResize()},onresizecolumn:()=>{this.adjustColumnTypesWidth()},onselection:(e,t,n,s,o,l)=>{this.scrollCellIntoView({column:t,row:n})},columns:this.columns(this.extractColumnNumber(n))},o=document.createElement("div");o.className="se-area-container",this.node.appendChild(o),this.columnTypesBar=document.createElement("div"),this.columnTypesBar.classList.add("se-column-types"),this.columnTypesBar.classList.add("se-hidden"),this.columnTypeSelectors=new Map,o.appendChild(this.columnTypesBar),this.editor=document.createElement("div"),o.appendChild(this.editor),this.container=o,this.createEditor(s),e.contentChanged.connect(this._onContentChanged,this),this.populateColumnTypesBar(),n.length&&n[0].length*n.length<1e4&&(this.fitMode="fit-cells",this.relayout()),this._ready.resolve(void 0)}reloadEditor(e){const t=this.jexcel.getConfig();this.jexcel.destroy(),this.createEditor(Object.assign(Object.assign({},t),e)),this.relayout()}switchHeaders(){const e=this.getValue();this.firstRowAsHeader=!this.firstRowAsHeader;const t=this.parseValue(e);this.reloadEditor({data:t,columns:this.columns(this.extractColumnNumber(t))})}switchTypesBar(){this.columnTypesBar.classList.toggle("se-hidden")}populateColumnTypesBar(){const e=["text","numeric","hidden","dropdown","autocomplete","checkbox","radio","calendar","image","color","html"];this.columnTypesBar.innerHTML="",this.columnTypeSelectors.clear();for(let t=0;t<this.columnsNumber;t++){const n=document.createElement("select");for(const t of e){const e=document.createElement("option");e.value=t,e.text=t,n.appendChild(e)}n.onchange=e=>{const n=e.target;this.columnTypes[t]=n.options[n.selectedIndex].value,this.reloadEditor({columns:this.columns(this.columnTypes.length)})},this.columnTypeSelectors.set(t,n),this.columnTypesBar.appendChild(n)}}adjustColumnTypesWidth(){if(0===this.columnTypeSelectors.size)return;this.columnTypesBar.style.marginLeft=this.selectAllElement.offsetWidth+"px";const e=this.jexcel.getWidth(null);for(let t=0;t<this.columnsNumber;t++)this.columnTypeSelectors.get(t).style.width=e[t]+"px"}createEditor(e){this.jexcel=x()(this.editor,e),this.selectAllElement=this.jexcel.headerContainer.querySelector(".jexcel_selectall")}onAfterShow(e){super.onAfterShow(e),this.relayout()}get ready(){return this._ready.promise}getValue(){const e=this.jexcel.getData();return this.firstRowAsHeader&&e.unshift(this.jexcel.getHeaders(!0)),w().unparse(e,{delimiter:this.separator,newline:this.linebreak})}setValue(e){const t=this.parseValue(e);this.jexcel.setData(t)}_onContentChanged(){const e=this.getValue(),t=this.context.model.toString();e!==t&&this.setValue(t)}get wrapper(){return this.hasFrozenColumns?this.jexcel.content:this.container}onResize(){void 0!==this.jexcel&&("all-equal-fit"===this.fitMode&&this.relayout(),this.hasFrozenColumns&&(this.jexcel.content.style.width=this.node.offsetWidth+"px",this.jexcel.content.style.height=this.node.querySelector(".jexcel_content").offsetHeight+"px"),this.adjustColumnTypesWidth())}onActivateRequest(e){this.jexcel.el.focus()}dispose(){this.jexcel&&this.jexcel.destroy(),super.dispose()}updateModel(){this.context.model.value.text=this.getValue()}freezeSelectedColumns(){const e=this.jexcel.getSelectedColumns();this.reloadEditor({freezeColumns:Math.max(...e)+1,tableOverflow:!0,tableWidth:this.node.offsetWidth+"px",tableHeight:this.node.offsetHeight+"px"}),this.hasFrozenColumns=!0}unfreezeColumns(){this.reloadEditor({freezeColumns:null,tableOverflow:!1,tableWidth:null,tableHeight:null}),this.hasFrozenColumns=!1}get columnsNumber(){const e=this.jexcel.getData();if(e.length)return e[0].length}getHeaderElements(){const e=[];for(const t of this.jexcel.headerContainer.children)"jexcel_selectall"!==t.className&&e.push(t);return e}relayout(){if(void 0===this.jexcel)return;const e=this.columnsNumber;if(e){switch(this.fitMode){case"all-equal-default":{const t=this.jexcel.getConfig();for(let n=0;n<e;n++)this.jexcel.setWidth(n,t.defaultColWidth,null);break}case"all-equal-fit":{const t=this.node.querySelector(".jexcel_selectall"),n=(this.node.clientWidth-t.offsetWidth)/e;for(let t=0;t<e;t++)this.jexcel.setWidth(t,n,null);break}case"fit-cells":{const t=this.jexcel.getData(),n=this.getHeaderElements();for(let s=0;s<e;s++){let e=Math.max(25,n[s].scrollWidth);for(let n=0;n<t.length;n++){const t=this.jexcel.getCellFromCoords(s,n);e=Math.max(e,t.scrollWidth)}this.jexcel.setWidth(s,e,null)}break}}this.adjustColumnTypesWidth()}}scrollCellIntoView(e){const t=this.jexcel.getCellFromCoords(e.column,e.row),n=t.getBoundingClientRect(),s=this.wrapper.getBoundingClientRect();let o=!1;n.right>s.right?this.wrapper.scrollBy(n.right-s.right,0):n.left<s.left&&this.wrapper.scrollBy(n.left-s.left,0),n.top-3<s.top&&(o=!0),(o||n.bottom+3>s.bottom)&&t.scrollIntoView(o)}}var b=n(971);class C extends l.DocumentWidget{constructor(e){super(e);const t=new a.ToolbarButton({icon:new b.LabIcon({name:"spreadsheet:add-row",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" focusable="false" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path d="M22 10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V3h2v2h4V3h2v2h4V3h2v2h4V3h2v7M4 10h4V7H4v3m6 0h4V7h-4v3m10 0V7h-4v3h4m-9 4h2v3h3v2h-3v3h-2v-3H8v-2h3v-3z" fill="#626262" class=\'jp-icon3\'/></svg>\n'}),onClick:()=>{this.content.jexcel.insertRow(),this.content.updateModel()},tooltip:"Insert a row at the end"});this.toolbar.addItem("spreadsheet:insert-row",t);const n=new a.ToolbarButton({icon:new b.LabIcon({name:"spreadsheet:remove-row",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" focusable="false" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path d="M9.41 13L12 15.59L14.59 13L16 14.41L13.41 17L16 19.59L14.59 21L12 18.41L9.41 21L8 19.59L10.59 17L8 14.41L9.41 13M22 9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v3M4 9h4V6H4v3m6 0h4V6h-4v3m6 0h4V6h-4v3z" fill="#626262" class=\'jp-icon3\'/></svg>\n'}),onClick:()=>{this.content.jexcel.deleteRow(this.content.jexcel.rows.length-1,1),this.content.updateModel()},tooltip:"Remove the last row"});this.toolbar.addItem("spreadsheet:remove-row",n);const s=new a.ToolbarButton({icon:new b.LabIcon({name:"spreadsheet:add-column",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" focusable="false" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path d="M11 2a2 2 0 0 1 2 2v16a2 2 0 0 1-2 2H2V2h9m-7 8v4h7v-4H4m0 6v4h7v-4H4M4 4v4h7V4H4m11 7h3V8h2v3h3v2h-3v3h-2v-3h-3v-2z" fill="#626262" class=\'jp-icon3\'/></svg>\n'}),onClick:()=>{this.content.jexcel.insertColumn(null,null),this.content.updateModel()},tooltip:"Insert a column at the end"});this.toolbar.addItem("spreadsheet:insert-column",s);const o=new a.ToolbarButton({icon:new b.LabIcon({name:"spreadsheet:remove-column",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" focusable="false" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path d="M4 2h7a2 2 0 0 1 2 2v16a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2m0 8v4h7v-4H4m0 6v4h7v-4H4M4 4v4h7V4H4m13.59 8L15 9.41L16.41 8L19 10.59L21.59 8L23 9.41L20.41 12L23 14.59L21.59 16L19 13.41L16.41 16L15 14.59L17.59 12z" fill="#626262" class=\'jp-icon3\'/></svg>\n'}),onClick:()=>{this.content.jexcel.deleteColumn(this.content.columnsNumber,null),this.content.updateModel()},tooltip:"Remove the last column"});this.toolbar.addItem("spreadsheet:remove-column",o);let l=!0;const i=new a.ToolbarButton({icon:new b.LabIcon({name:"spreadsheet:show-hide-index",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" focusable="false" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path d="M7 13v-2h14v2H7m0 6v-2h14v2H7M7 7V5h14v2H7M3 8V5H2V4h2v4H3m-1 9v-1h3v4H2v-1h2v-.5H3v-1h1V17H2m2.25-7a.75.75 0 0 1 .75.75c0 .2-.08.39-.21.52L3.12 13H5v1H2v-.92L4 11H2v-1h2.25z" fill="#626262" class=\'jp-icon3\'/></svg>\n'}),onClick:()=>{l?this.content.jexcel.hideIndex():this.content.jexcel.showIndex(),l=!l},tooltip:"Show/hide row numbers"});this.toolbar.addItem("spreadsheet:show-hide-index",i);const h=new a.ToolbarButton({icon:new b.LabIcon({name:"spreadsheet:fit-columns",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" focusable="false" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path d="M5 8h14a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V10a2 2 0 0 1 2-2m0 4v3h6v-3H5m8 0v3h6v-3h-6m-8 5v3h6v-3H5m8 0v3h6v-3h-6M11 2h10v4h-2V4h-6v2h-2V2z" fill="#626262" class=\'jp-icon3\'/></svg>\n'}),onClick:()=>{switch(this.content.fitMode){case"fit-cells":this.content.fitMode="all-equal-fit";break;case"all-equal-fit":this.content.fitMode="all-equal-default";break;case"all-equal-default":this.content.fitMode="fit-cells"}this.content.relayout()},tooltip:"Fit columns width"});this.toolbar.addItem("spreadsheet:fit-columns",h);const r=new a.ToolbarButton({icon:new b.LabIcon({name:"spreadsheet:freeze-columns",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" focusable="false" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path d="M20.79 13.95l-2.33.62l-2-1.13v-2.88l2-1.13l2.33.62l.52-1.93l-1.77-.47l.46-1.77l-1.93-.52l-.62 2.33l-2 1.13L13 7.38V5.12l1.71-1.71L13.29 2L12 3.29L10.71 2L9.29 3.41L11 5.12v2.26L8.5 8.82l-2-1.13l-.58-2.33L4 5.88l.47 1.77l-1.77.47l.52 1.93l2.33-.62l2 1.13v2.89l-2 1.13l-2.33-.62l-.52 1.93l1.77.47L4 18.12l1.93.52l.62-2.33l2-1.13L11 16.62v2.26l-1.71 1.71L10.71 22L12 20.71L13.29 22l1.41-1.41l-1.7-1.71v-2.26l2.5-1.45l2 1.13l.62 2.33l1.88-.51l-.47-1.77l1.77-.47l-.51-1.93M9.5 10.56L12 9.11l2.5 1.45v2.88L12 14.89l-2.5-1.45v-2.88z" fill="#626262" class=\'jp-icon3\'/></svg>\n'}),onClick:()=>{this.content.freezeSelectedColumns()},tooltip:"Freeze the initial columns (up to the selected column)"});this.toolbar.addItem("spreadsheet:freeze-columns",r);const c=new a.ToolbarButton({icon:new b.LabIcon({name:"spreadsheet:unfreeze-columns",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" focusable="false" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path d="M11 5.12L9.29 3.41L10.71 2L12 3.29L13.29 2l1.42 1.41L13 5.12v2.26l2.45 1.44l2-1.13l.62-2.33l1.93.52l-.46 1.77l1.77.47l-.52 1.93l-2.33-.62l-2 1.13v2.7L14.5 11.3v-.74l-1.76-1.02l-2.01-2.01l.27-.15V5.12m7.46 9.45l-1.59-.9l2.68 2.68l1.75-.47l-.51-1.93l-2.33.62M13 16.62v2.26l1.7 1.71L13.29 22L12 20.71L10.71 22l-1.42-1.41L11 18.88v-2.26l-2.45-1.44l-2 1.13l-.62 2.33L4 18.12l.47-1.76l-1.77-.47l.52-1.93l2.33.62l2-1.13v-2.89l-2-1.13l-2.33.62l-.52-1.93l1.77-.47L4 5.89L1.11 3l1.28-1.27l19.72 19.73l-1.27 1.27L14.1 16l-1.1.62m-1-1.73l.63-.39l-3.13-3.11v2.05l2.5 1.45z" fill="#626262" class=\'jp-icon3\'/></svg>\n'}),onClick:()=>{this.content.unfreezeColumns()},tooltip:"Unfreeze frozen column"});this.toolbar.addItem("spreadsheet:unfreeze-columns",c);const d=new a.ToolbarButton({icon:new b.LabIcon({name:"spreadsheet:switch-headers",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" focusable="false" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path d="M6 2h12a2 2 0 0 1 2 2v16a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2m0 2v4h12V4H6z" fill="#626262" class=\'jp-icon3\'/></svg>\n\n'}),onClick:()=>{this.content.switchHeaders()},tooltip:"First row as a header"});this.toolbar.addItem("spreadsheet:switch-headers",d);const u=new a.ToolbarButton({icon:new b.LabIcon({name:"spreadsheet:column-types",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" focusable="false" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><path d="M5 9.5L7.5 14h-5L5 9.5M3 4h4v4H3V4m2 16a2 2 0 0 0 2-2a2 2 0 0 0-2-2a2 2 0 0 0-2 2a2 2 0 0 0 2 2M9 5v2h12V5H9m0 14h12v-2H9v2m0-6h12v-2H9v2z" fill="#626262" class=\'jp-icon3\'/></svg>\n'}),onClick:()=>{this.content.switchTypesBar()},tooltip:"Show/hide column types bar"});this.toolbar.addItem("spreadsheet:switch-column-types-bar",u)}}class y{constructor(){this._set=new Set}_valueToString(e){return void 0===e?e:e.column+"|"+e.row}_stringToValue(e){if(void 0===e)return e;const t=e.split("|");return 2!==t.length&&console.warn("A problem with stringToValue input detected!"),{column:parseInt(t[0],10),row:parseInt(t[1],10)}}add(e){return this._set.add(this._valueToString(e)),this}delete(e){return this._set.delete(this._valueToString(e))}has(e){return this._set.has(this._valueToString(e))}values(){const e=this._set.values(),t=this._stringToValue;return{[Symbol.iterator](){return this},return(n){const s=e.return(n);return{done:s.done,value:t(s.value)}},next(){const n=e.next();return{done:n.done,value:t(n.value)}},throw(){const n=e.throw();return{done:n.done,value:t(n.value)}}}}clear(){return this._set.clear()}}class M{constructor(){this._changed=new f.Signal(this),this.backlitMatches=new y}static canSearchOn(e){return e instanceof l.DocumentWidget&&e.content instanceof _}get changed(){return this._changed}get currentMatchIndex(){return this._currentMatchIndex}get matches(){return this._matches}endQuery(){return this.backlightOff(),this._currentMatchIndex=null,this._matches=[],this._sheet.changed.disconnect(this._onSheetChanged,this),Promise.resolve(void 0)}backlightOff(){for(const e of this.backlitMatches.values())this._target.getCellFromCoords(e.column,e.row).classList.remove("se-backlight");this.backlitMatches.clear()}async endSearch(){return null==this._target.selectedCell&&this.mostRecentSelectedCell&&(this._target.selectedCell=this.mostRecentSelectedCell),this.endQuery()}getSelectedCellCoordinates(){const e=this._target,t=e.getSelectedColumns(),n=e.getSelectedRows(!0);if(1===n.length&&1===t.length)return{column:t[0],row:n[0]}}getInitialQuery(e){this._target=e.content.jexcel;const t=this.getSelectedCellCoordinates();if(this._initialQueryCoodrs=t,t){const e=this._target.getValueFromCoords(t.column,t.row,!1);if(e)return e}return null}async highlightNext(){this._currentMatchIndex+1<this.matches.length?this._currentMatchIndex+=1:this._currentMatchIndex=0;const e=this.matches[this.currentMatchIndex];if(e)return this.highlight(e),e}async highlightPrevious(){this._currentMatchIndex>0?this._currentMatchIndex-=1:this._currentMatchIndex=this.matches.length-1;const e=this.matches[this.currentMatchIndex];if(e)return this.highlight(e),e}highlight(e){this.backlightMatches(),this._target.updateSelectionFromCoords(e.column,e.line,e.column,e.line,null),this.mostRecentSelectedCell=this._target.selectedCell,this._target.selectedCell=null,this._sheet.scrollCellIntoView({row:e.line,column:e.column})}async replaceAllMatches(e){for(let t=0;t<this.matches.length;t++)this._currentMatchIndex=t,await this.replaceCurrentMatch(e,!0);return this._matches=this.findMatches(),this.backlightMatches(),!0}async replaceCurrentMatch(e,t=!1){let n=!1;const s=this.matches[this.currentMatchIndex],o=this._target.getValueFromCoords(s.column,s.line,!1);let l=-1,i=0;const a=String(o).replace(this._query,(t=>(l+=1,i+=1,l===s.index?(n=!0,e):t)));let h=this.currentMatchIndex+1;for(;h<this.matches.length;){const e=this.matches[h];if(e.column!==s.column||e.line!==s.line)break;e.index-=1,h+=1}if(this._target.setValueFromCoords(s.column,s.line,a,!1),!t&&1===i){const e={column:s.column,row:s.line};this._target.getCellFromCoords(s.column,s.line).classList.remove("se-backlight"),this.backlitMatches.delete(e)}return t||await this.highlightNext(),n}_onSheetChanged(){this._matches=this.findMatches(!1),this.backlightOff(),this.backlightMatches(),this._changed.emit(void 0)}backlightMatches(e=1e3){for(let t=Math.max(0,this._currentMatchIndex-e/2);t<Math.min(this._currentMatchIndex+e/2,this.matches.length);t++){const e=this.matches[t],n={column:e.column,row:e.line};this.backlitMatches.has(n)||(this._target.getCellFromCoords(e.column,e.line).classList.add("se-backlight"),this.backlitMatches.add(n))}}findMatches(e=!0){const t=this._initialQueryCoodrs;this._initialQueryCoodrs=null;let n=0;const s=[],o=this._target.getData();let l=0,i=-1,a=0,h=0;for(const e of o){for(const o of e){if(i+=1,!o)continue;const e=String(o).match(this._query);if(e){a=0,null!=t&&t.row===l&&t.column===i&&(n=h);for(const t of e)s.push({line:l,column:i,index:a,fragment:t,text:t}),a+=1,h+=1}}i=-1,l+=1}return this._currentMatchIndex=n,this._matches=s,s.length&&e&&this.highlight(s[this._currentMatchIndex]),s}async startQuery(e,t){if(!M.canSearchOn(t))throw new Error("Cannot find Spreadsheet editor instance to search");return this._sheet=t.content,this._query=e,this._target=t.content.jexcel,this._target.resetSelection(!0),this._target.el.blur(),this._sheet.changed.connect(this._onSheetChanged,this),this.findMatches()}}var j=n(869),k=n(473);const L="Spreadsheet Editor",V="Spreadsheet Editor";class I extends l.ABCWidgetFactory{createNewWidget(e){const t=new _(e);return new C({content:t,context:e})}}function S(e,t){e.editMenu.undoers.add({tracker:t,undo:e=>{e.content.jexcel.undo()},redo:e=>{e.content.jexcel.redo()}})}function T(e,t,n="tsv"){return e.execute("docmanager:new-untitled",{path:t,type:"file",ext:n}).then((t=>e.execute("docmanager:open",{path:t.path,factory:V})))}var H;function B(e){e.add({command:H.createNewCSV,category:"Other",rank:3}),e.add({command:H.createNewTSV,category:"Other",rank:3})}function R(e,t){e.addCommand(H.createNewCSV,{label:e=>e.isPalette?"New CSV File":"CSV File",caption:"Create a new CSV file",icon:e=>e.isPalette?void 0:b.spreadsheetIcon,execute:n=>{const s=n.cwd||t.defaultBrowser.model.path;return T(e,s,"csv")}}),e.addCommand(H.createNewTSV,{label:e=>e.isPalette?"New TSV File":"TSV File",caption:"Create a new TSV file",icon:e=>e.isPalette?void 0:b.spreadsheetIcon,execute:n=>{const s=n.cwd||t.defaultBrowser.model.path;return T(e,s,"tsv")}})}!function(e){e.createNewCSV="spreadsheet-editor:create-new-csv-file",e.createNewTSV="spreadsheet-editor:create-new-tsv-file"}(H||(H={}));const z={id:"spreadsheet-editor",autoStart:!0,requires:[i.IEditorTracker,k.IFileBrowserFactory],optional:[a.ICommandPalette,j.ILauncher,o.IMainMenu,s.ILayoutRestorer,h.ISearchProviderRegistry],activate:(e,t,n,s,o,l,i,h)=>{const r=new I({name:V,fileTypes:["csv","tsv","*"],defaultFor:["csv","tsv"]}),c=new a.WidgetTracker({namespace:"spreadsheet-editor"});i&&i.restore(c,{command:"docmanager:open",args:e=>({path:e.context.path,factory:V}),name:e=>e.context.path}),e.docRegistry.addWidgetFactory(r);const d=e.docRegistry.getFileType("csv");r.widgetCreated.connect(((e,t)=>{c.add(t),t.context.pathChanged.connect((()=>{c.save(t)})),d&&(t.title.icon=d.icon,t.title.iconClass=d.iconClass,t.title.iconLabel=d.iconLabel)})),h&&h.register("spreadsheet-editor",M),R(e.commands,n),s&&(s.addItem({command:H.createNewCSV,args:{isPalette:!0},category:L}),s.addItem({command:H.createNewTSV,args:{isPalette:!0},category:L})),o&&B(o),l&&S(l,c)}}},760:(e,t,n)=>{"use strict";n.d(t,{Z:()=>h});var s=n(645),o=n.n(s),l=n(311),i=n(479),a=o()((function(e){return e[1]}));a.i(l.Z),a.i(i.Z),a.push([e.id,"table.jexcel {\n  border-top: 0;\n  border-left: 0;\n}\n\n.jexcel_container {\n  overflow: visible;\n  padding: 0;\n}\n\n.jexcel_content {\n  padding: 0;\n}\n\n.se-area-container {\n  overflow: auto;\n  width: 100%;\n  height: 100%;\n}\n\n.se-column-types {\n  width: max-content;\n  height: var(--jp-private-toolbar-height);\n}\n\n.se-column-types select {\n  display: inline-block;\n}\n\n.se-hidden {\n  display: none;\n}\n\nsvg[data-icon='spreadsheet:column-types'] {\n  transform: rotate(90deg);\n}\n\n/**\nDark theme\n */\nbody[data-jp-theme-light='false'] .jexcel_container {\n  /* use https://bossanova.uk/jexcel/v4/cases/themes tool to adjust */\n  --jexcel_header_color: #ccc;\n  --jexcel_header_color_highlighted: #ddd;\n  --jexcel_header_background: #313131;\n  --jexcel_header_background_highlighted: #777;\n  --jexcel_content_color: #fff;\n  --jexcel_content_color_highlighted: #333;\n  --jexcel_content_background: #111;\n  --jexcel_content_background_highlighted: #333;\n  --jexcel_menu_background: #7e7e7e;\n  --jexcel_menu_background_highlighted: #ebebeb;\n  --jexcel_menu_color: #ddd;\n  --jexcel_menu_color_highlighted: #222;\n  --jexcel_menu_box_shadow: unset;\n  --jexcel_border_color: #5f5f5f;\n  --jexcel_border_color_highlighted: #999;\n  --active_color: #eee;\n}\n\nbody[data-jp-theme-light='false'] .se-backlight {\n  background: rgba(85, 45, 0, 0.75);\n}\n\n/**\nLight theme\n */\nbody[data-jp-theme-light='true'] .jexcel_container {\n  --jexcel_header_color: #000;\n  --jexcel_header_color_highlighted: #000;\n  --jexcel_header_background: #f3f3f3;\n  --jexcel_header_background_highlighted: #dcdcdc;\n  --jexcel_content_color: #000;\n  --jexcel_content_color_highlighted: #000;\n  --jexcel_content_background: #fff;\n  --jexcel_content_background_highlighted: rgba(0, 0, 0, 0.05);\n  --jexcel_menu_background: #fff;\n  --jexcel_menu_background_highlighted: #ebebeb;\n  --jexcel_menu_color: #555;\n  --jexcel_menu_color_highlighted: #555;\n  --jexcel_menu_box_shadow: 2px 2px 2px 0px rgba(143, 144, 145, 1);\n  --jexcel_border_color: #ccc;\n  --jexcel_border_color_highlighted: #000;\n  --active_color: #007aff;\n}\n\nbody[data-jp-theme-light='true'] .se-backlight {\n  background: rgba(255, 255, 0, 0.75);\n}\n",""]);const h=a}}]);