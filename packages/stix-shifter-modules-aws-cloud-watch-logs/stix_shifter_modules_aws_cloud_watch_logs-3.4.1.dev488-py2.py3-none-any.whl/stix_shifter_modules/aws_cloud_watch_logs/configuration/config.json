{
    "connection": {
        "type": {
            "displayName": "Amazon CloudWatch Logs",
            "type": "connectorType"
        },
        "help": {
            "type": "link",
            "default": "https://www.ibm.com/support/knowledgecenter/SSTDPP_1.1.0/docs/scp-core/data-sources-aws.html"
        },
        "region": {
            "type": "text",
            "previous": "connection.options.region"
        },
        "log_group_names": {
            "type": "text",
            "optional": true,
            "previous": "connection.options.log_group_names"
        },
        "options": {
            "type": "fields",
            "result_limit": {
                "default": 10000,
                "min": 1,
                "max": 60000,
                "type": "number",
                "previous": "connection.resultSizeLimit"
            },
            "time_range": {
                "default": 5,
                "min": 1,
                "max": 10000,
                "type": "number",
                "previous": "connection.timerange",
                "nullable": true
            },
            "timeout": {
                "default": 10,
                "min": 1,
                "max": 60,
                "hidden": true,
                "type": "number",
                "previous": "connection.timeoutLimit"
            },
            "dialects": {
                "type": "array",
                "hidden": true,
                "optional": true
            },
            "language": {
                "type": "string",
                "default": "stix",
                "optional": true,
                "hidden": true
            },
            "validate_pattern": {
                "type": "boolean",
                "optional": true,
                "hidden": true,
                "previous": "connection.validate_pattern"
            },
            "stix_validator": {
                "type": "boolean",
                "default": false,
                "optional": true,
                "hidden": true,
                "previous": "connection.stix_validator"
            },
            "mapping": {
                "type": "json",
                "optional": true,
                "hidden": true,
                "previous": "connection.mapping",
                "default": {
                    "common_attributes": {
                        "guardduty": [
                            "account",
                            "source",
                            "detail_region",
                            "detail_id",
                            "detail_service_resourceRole",
                            "detail_severity",
                            "detail_type",
                            "detail_createdAt",
                            "detail_updatedAt",
                            "detail_resource_resourceType",
                            "detail_title",
                            "detail_service_action_actionType",
                            "detail_service_eventFirstSeen",
                            "detail_service_eventLastSeen",
                            "detail_service_archived",
                            "detail_service_count",
                            "detail_description",
                            "detail_resource",
                            "detail_service_eventFirstSeen",
                            "detail_service_eventLastSeen"
                        ]
                    },
                    "guardduty_from_stix_map": {
                        "ipv4-addr": {
                            "fields": {
                                "value": [
                                    "eth0_private_ip",
                                    "eth1_private_ip",
                                    "public_ip",
                                    "remote_ip"
                                ],
                                "x_aws_interface_id": [
                                    "interface_id"
                                ],
                                "x_aws_remote_city_name": [
                                    "city_name"
                                ],
                                "x_aws_remote_country_name": [
                                    "country_name"
                                ]
                            }
                        },
                        "ipv6-addr": {
                            "fields": {
                                "value": [
                                    "ipv6_address"
                                ],
                                "x_aws_interface_id": [
                                    "interface_id"
                                ]
                            }
                        },
                        "network-traffic": {
                            "fields": {
                                "src_port": [
                                    "local_port"
                                ],
                                "dst_port": [
                                    "remote_port"
                                ],
                                "src_ref.value": [
                                    "eth0_private_ip"
                                ],
                                "dst_ref.value": [
                                    "remote_ip"
                                ],
                                "protocols[*]": [
                                    "protocol"
                                ]
                            }
                        },
                        "domain-name": {
                            "fields": {
                                "value": [
                                    "eth0_private_dns_name",
                                    "eth1_private_dns_name",
                                    "public_dns_name",
                                    "dns_domain"
                                ]
                            }
                        },
                        "user-account": {
                            "fields": {
                                "user_id": [
                                    "principal_id"
                                ],
                                "account_login": [
                                    "user_name"
                                ]
                            }
                        },
                        "x-aws": {
                            "fields": {
                                "account_id": [
                                    "account_id"
                                ],
                                "region": [
                                    "aws_region"
                                ]
                            }
                        },
                        "x-aws-instance": {
                            "fields": {
                                "instance_id": [
                                    "instance_id"
                                ],
                                "image_id": [
                                    "image_id"
                                ],
                                "availability_zone": [
                                    "availability_zone"
                                ]
                            }
                        },
                        "x-aws-vpc": {
                            "fields": {
                                "vpc_id": [
                                    "vpc_id"
                                ],
                                "subnet_id": [
                                    "subnet_id"
                                ],
                                "security_group_name": [
                                    "security_group_name"
                                ],
                                "security_group_id": [
                                    "security_group_id"
                                ]
                            }
                        },
                        "x-aws-api": {
                            "fields": {
                                "access_key_id": [
                                    "access_key_id"
                                ],
                                "api": [
                                    "api"
                                ],
                                "api_service_name": [
                                    "api_service_name"
                                ]
                            }
                        },
                        "x-aws-guardduty-finding": {
                            "fields": {
                                "finding_id": [
                                    "finding_id"
                                ],
                                "finding_type": [
                                    "finding_type"
                                ]
                            }
                        }
                    },
                    "master_config": {
                        "vpcflow": {
                            "display_fields": [
                                "@timestamp",
                                "srcAddr",
                                "dstAddr",
                                "srcPort",
                                "dstPort",
                                "protocol",
                                "start",
                                "end",
                                "accountId",
                                "interfaceId"
                            ],
                            "logtype_filter": "strlen(srcAddr) > 0 or strlen(dstAddr) > 0 or strlen(protocol) > 0"
                        },
                        "guardduty": {
                            "display_fields": [
                                "@timestamp",
                                "source",
                                "@message"
                            ],
                            "parse_attributes": {
                                "account_id": {
                                    "parse_string": "account \"\""
                                },
                                "aws_region": {
                                    "parse_string": "region \"\""
                                },
                                "image_id": {
                                    "parse_string": "detail.resource.instanceDetails.imageId \"\""
                                },
                                "instance_id": {
                                    "parse_string": "detail.resource.instanceDetails.instanceId \"\""
                                },
                                "availability_zone": {
                                    "parse_string": "detail.resource.instanceDetails.availabilityZone \"\""
                                },
                                "security_group_name": {
                                    "parse_string": "detail.resource.instanceDetails.networkInterfaces.0 '\"groupName\":\"*\"'"
                                },
                                "security_group_id": {
                                    "parse_string": "detail.resource.instanceDetails.networkInterfaces.0 '\"groupId\":\"*\"'"
                                },
                                "subnet_id": {
                                    "parse_string": "detail.resource.instanceDetails.networkInterfaces.0 '\"subnetId\":\"*\"'"
                                },
                                "vpc_id": {
                                    "parse_string": "detail.resource.instanceDetails.networkInterfaces.0 '\"vpcId\":\"*\"'"
                                },
                                "access_key_id": {
                                    "parse_string": "detail.resource.accessKeyDetails.accessKeyId \"\""
                                },
                                "principal_id": {
                                    "parse_string": "detail.resource.accessKeyDetails.principalId \"\""
                                },
                                "user_name": {
                                    "parse_string": "detail.resource.accessKeyDetails.userName \"\""
                                },
                                "api": {
                                    "parse_string": "detail.service.action.awsApiCallAction.api \"\""
                                },
                                "api_service_name": {
                                    "parse_string": "detail.service.action.awsApiCallAction.serviceName \"\""
                                },
                                "eth0_private_ip": {
                                    "parse_string": "detail.resource.instanceDetails.networkInterfaces.0 '\"privateIpAddress\":\"*\"'"
                                },
                                "eth0_private_dns_name": {
                                    "parse_string": "detail.resource.instanceDetails.networkInterfaces.0 '\"privateDnsName\":\"*\"'"
                                },
                                "public_dns_name": {
                                    "parse_string": "detail.resource.instanceDetails.networkInterfaces.0 '\"publicDnsName\":\"*\"'"
                                },
                                "public_ip": {
                                    "parse_string": "detail.resource.instanceDetails.networkInterfaces.0 '\"publicIp\":\"*\"'"
                                },
                                "ipv6_address": {
                                    "parse_string": "detail.resource.instanceDetails.networkInterfaces.0 '\"ipv6Addresses\":[\"*\"'"
                                },
                                "eth1_private_ip": {
                                    "parse_string": "detail.resource.instanceDetails.networkInterfaces.1 '\"privateIpAddress\":\"*\"'"
                                },
                                "eth1_private_dns_name": {
                                    "parse_string": "detail.resource.instanceDetails.networkInterfaces.1 '\"privateDnsName\":\"*\"'"
                                },
                                "remote_ip": {
                                    "parse_string": "@message /(?:\"ipAddressV4\"\\:\")(?<remote_ip>((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?))(?:\")/"
                                },
                                "local_port": {
                                    "parse_string": "@message '\"localPortDetails\":{\"port\":*,'"
                                },
                                "remote_port": {
                                    "parse_string": "@message '\"remotePortDetails\":{\"port\":*,'"
                                },
                                "protocol": {
                                    "parse_string": "detail.service.action.networkConnectionAction.protocol \"\""
                                },
                                "interface_id": {
                                    "parse_string": "detail.resource.instanceDetails.networkInterfaces.0 '\"networkInterfaceId\":\"*\"'"
                                },
                                "city_name": {
                                    "parse_string": "@message '\"cityName\":\"*\"'"
                                },
                                "country_name": {
                                    "parse_string": "@message '\"countryName\":\"*\"'"
                                },
                                "dns_domain": {
                                    "parse_string": "detail.service.action.dnsRequestAction.domain \"\""
                                },
                                "finding_id": {
                                    "parse_string": "detail.id \"\""
                                },
                                "finding_type": {
                                    "parse_string": "detail.type \"\""
                                },
                                "action_type": {
                                    "parse_string": "detail.service.action.actionType \"\""
                                }
                            }
                        }
                    },
                    "network_protocol_map": {
                        "hopopt": "0",
                        "icmp": "1",
                        "igmp": "2",
                        "ggp": "3",
                        "ip-in-ip": "4",
                        "st": "5",
                        "tcp": "6",
                        "cbt": "7",
                        "egp": "8",
                        "igp": "9",
                        "bbn-rcc-mon": "10",
                        "nvp-ii": "11",
                        "pup": "12",
                        "argus": "13",
                        "emcon": "14",
                        "xnet": "15",
                        "chaos": "16",
                        "udp": "17",
                        "mux": "18",
                        "dcn-meas": "19",
                        "hmp": "20",
                        "prm": "21",
                        "xns-idp": "22",
                        "trunk-1": "23",
                        "trunk-2": "24",
                        "leaf-1": "25",
                        "leaf-2": "26",
                        "rdp": "27",
                        "irtp": "28",
                        "iso-tp4": "29",
                        "netblt": "30",
                        "mfe-nsp": "31",
                        "merit-inp": "32",
                        "dccp": "33",
                        "3pc": "34",
                        "idpr": "35",
                        "xtp": "36",
                        "ddp": "37",
                        "idpr-cmtp": "38",
                        "tp++": "39",
                        "il": "40",
                        "ipv6": "41",
                        "sdrp": "42",
                        "ipv6-route": "43",
                        "ipv6-frag": "44",
                        "idrp": "45",
                        "rsvp": "46",
                        "gre": "47",
                        "dsr": "48",
                        "bna": "49",
                        "esp": "50",
                        "ah": "51",
                        "i-nlsp": "52",
                        "swipe": "53",
                        "narp": "54",
                        "mobile": "55",
                        "tlsp": "56",
                        "skip": "57",
                        "ipv6-icmp": "58",
                        "ipv6-nonxt": "59",
                        "ipv6-opts": "60",
                        "cftp": "62",
                        "sat-expak": "64",
                        "kryptolan": "65",
                        "rvd": "66",
                        "ippc": "67",
                        "sat-mon": "69",
                        "visa": "70",
                        "ipcu": "71",
                        "cpnx": "72",
                        "cphb": "73",
                        "wsn": "74",
                        "pvp": "75",
                        "br-sat-mon": "76",
                        "sun-nd": "77",
                        "wb-mon": "78",
                        "wb-expak": "79",
                        "iso-ip": "80",
                        "vmtp": "81",
                        "secure-vmtp": "82",
                        "vines": "83",
                        "ttp": "84",
                        "iptm": "84",
                        "nsfnet-igp": "85",
                        "dgp": "86",
                        "tcf": "87",
                        "eigrp": "88",
                        "ospfigp": "89",
                        "sprite-rpc": "90",
                        "larp": "91",
                        "mtp": "92",
                        "ax.25": "93",
                        "ipip": "94",
                        "micp": "95",
                        "scc-sp": "96",
                        "etherip": "97",
                        "encap": "98",
                        "gmtp": "100",
                        "ifmp": "101",
                        "pnni": "102",
                        "pim": "103",
                        "aris": "104",
                        "scps": "105",
                        "qnx": "106",
                        "a/n": "107",
                        "ipcomp": "108",
                        "snp": "109",
                        "compaq-peer": "110",
                        "ipx-in-ip": "111",
                        "vrrp": "112",
                        "pgm": "113",
                        "l2tp": "115",
                        "ddx": "116",
                        "iatp": "117",
                        "stp": "118",
                        "srp": "119",
                        "uti": "120",
                        "smp": "121",
                        "sm": "122",
                        "ptp": "123",
                        "isis over ipv4": "124",
                        "fire": "125",
                        "crtp": "126",
                        "crudp": "127",
                        "sscopmce": "128",
                        "iplt": "129",
                        "sps": "130",
                        "pipe": "131",
                        "sctp": "132",
                        "fc": "133",
                        "rsvp-e2e-ignore": "134",
                        "mobility header": "135",
                        "udplite": "136",
                        "mpls-in-ip": "137",
                        "manet": "138",
                        "hip": "139",
                        "shim6": "140",
                        "wesp": "141",
                        "rohc": "142",
                        "reserved": "255"
                    },
                    "to_stix_map": {
                        "vpcflow": {
                            "srcAddr": [
                                {
                                    "key": "ipv4-addr.value",
                                    "object": "src_ip"
                                },
                                {
                                    "key": "ipv6-addr.value",
                                    "object": "src_ip"
                                },
                                {
                                    "key": "network-traffic.src_ref",
                                    "object": "nt",
                                    "references": "src_ip"
                                },
                                {
                                    "key": "ipv4-addr.x_aws_interface_id",
                                    "object": "src_ip",
                                    "ds_key": "interfaceId",
                                    "cybox": false
                                },
                                {
                                    "key": "ipv6-addr.x_aws_interface_id",
                                    "object": "src_ip",
                                    "ds_key": "interfaceId",
                                    "cybox": false
                                }
                            ],
                            "dstAddr": [
                                {
                                    "key": "ipv4-addr.value",
                                    "object": "dst_ip"
                                },
                                {
                                    "key": "ipv6-addr.value",
                                    "object": "dst_ip"
                                },
                                {
                                    "key": "network-traffic.dst_ref",
                                    "object": "nt",
                                    "references": "dst_ip"
                                }
                            ],
                            "srcPort": [
                                {
                                    "key": "network-traffic.src_port",
                                    "object": "nt",
                                    "transformer": "ToInteger"
                                }
                            ],
                            "dstPort": [
                                {
                                    "key": "network-traffic.dst_port",
                                    "object": "nt",
                                    "transformer": "ToInteger"
                                }
                            ],
                            "protocol": [
                                {
                                    "key": "network-traffic.protocols",
                                    "object": "nt",
                                    "transformer": "ToLowercaseArray"
                                }
                            ],
                            "start": [
                                {
                                    "key": "network-traffic.start",
                                    "object": "nt",
                                    "transformer": "EpochSecondsToTimestamp"
                                }
                            ],
                            "end": [
                                {
                                    "key": "network-traffic.end",
                                    "object": "nt",
                                    "transformer": "EpochSecondsToTimestamp"
                                }
                            ],
                            "accountId": [
                                {
                                    "key": "x_aws.account_id",
                                    "cybox": false
                                }
                            ],
                            "@timestamp": [
                                {
                                    "key": "first_observed",
                                    "cybox": false,
                                    "transformer": "AwsToTimestamp"
                                },
                                {
                                    "key": "last_observed",
                                    "cybox": false,
                                    "transformer": "AwsToTimestamp"
                                }
                            ],
                            "event_count": [
                                {
                                    "key": "number_observed",
                                    "cybox": false,
                                    "transformer": "ToInteger"
                                }
                            ]
                        },
                        "guardduty": {
                            "NETWORK_CONNECTION": {
                                "detail_resource_instanceDetails_networkInterfaces_0_privateIpAddress": [
                                    {
                                        "key": "ipv4-addr.value",
                                        "object": "nc_private_ip1"
                                    },
                                    {
                                        "key": "network-traffic.src_ref",
                                        "object": "nc_nt",
                                        "references": "nc_private_ip1"
                                    },
                                    {
                                        "key": "domain-name.resolves_to_refs",
                                        "object": "nc_private_name1",
                                        "references": [
                                            "nc_private_ip1"
                                        ]
                                    },
                                    {
                                        "key": "ipv4-addr.x_aws_interface_id",
                                        "object": "nc_private_ip1",
                                        "ds_key": "detail_resource_instanceDetails_networkInterfaces_0_networkInterfaceId",
                                        "cybox": false
                                    },
                                    {
                                        "key": "ipv4-addr.x_aws_ip_type",
                                        "object": "nc_private_ip1",
                                        "value": "private",
                                        "cybox": false
                                    }
                                ],
                                "detail_resource_instanceDetails_networkInterfaces_0_ipv6Addresses_0": [
                                    {
                                        "key": "ipv6-addr.value",
                                        "object": "nc_ipv6_ip"
                                    },
                                    {
                                        "key": "ipv6-addr.x_aws_interface_id",
                                        "object": "nc_ipv6_ip",
                                        "ds_key": "detail_resource_instanceDetails_networkInterfaces_0_networkInterfaceId",
                                        "cybox": false
                                    }
                                ],
                                "detail_resource_instanceDetails_networkInterfaces_0_publicIp": [
                                    {
                                        "key": "ipv4-addr.value",
                                        "object": "nc_public_ip"
                                    },
                                    {
                                        "key": "domain-name.resolves_to_refs",
                                        "object": "nc_public_name",
                                        "references": [
                                            "nc_public_ip"
                                        ]
                                    },
                                    {
                                        "key": "ipv4-addr.x_aws_interface_id",
                                        "object": "nc_public_ip",
                                        "ds_key": "detail_resource_instanceDetails_networkInterfaces_0_networkInterfaceId",
                                        "cybox": false
                                    },
                                    {
                                        "key": "ipv4-addr.x_aws_ip_type",
                                        "object": "nc_public_ip",
                                        "value": "public",
                                        "cybox": false
                                    }
                                ],
                                "detail_resource_instanceDetails_networkInterfaces_0_privateDnsName": [
                                    {
                                        "key": "domain-name.value",
                                        "object": "nc_private_name1"
                                    }
                                ],
                                "detail_resource_instanceDetails_networkInterfaces_0_publicDnsName": [
                                    {
                                        "key": "domain-name.value",
                                        "object": "nc_public_name"
                                    }
                                ],
                                "detail_resource_instanceDetails_networkInterfaces_1_privateIpAddress": [
                                    {
                                        "key": "ipv4-addr.value",
                                        "object": "nc_private_ip2"
                                    },
                                    {
                                        "key": "domain-name.resolves_to_refs",
                                        "object": "nc_private_name2",
                                        "references": [
                                            "nc_private_ip2"
                                        ]
                                    },
                                    {
                                        "key": "ipv4-addr.x_aws_interface_id",
                                        "object": "nc_private_ip2",
                                        "ds_key": "detail_resource_instanceDetails_networkInterfaces_1_networkInterfaceId",
                                        "cybox": false
                                    },
                                    {
                                        "key": "ipv4-addr.x_aws_ip_type",
                                        "object": "nc_private_ip2",
                                        "value": "private",
                                        "cybox": false
                                    }
                                ],
                                "detail_resource_instanceDetails_networkInterfaces_1_privateDnsName": [
                                    {
                                        "key": "domain-name.value",
                                        "object": "nc_private_name2"
                                    }
                                ],
                                "detail_service_action_networkConnectionAction_remoteIpDetails_ipAddressV4": [
                                    {
                                        "key": "ipv4-addr.value",
                                        "object": "nc_remote_ip"
                                    },
                                    {
                                        "key": "network-traffic.dst_ref",
                                        "object": "nc_nt",
                                        "references": "nc_remote_ip"
                                    },
                                    {
                                        "key": "ipv4-addr.x_aws_remote_city_name",
                                        "object": "nc_remote_ip",
                                        "ds_key": "detail_service_action_networkConnectionAction_remoteIpDetails_city_cityName",
                                        "cybox": false
                                    },
                                    {
                                        "key": "ipv4-addr.x_aws_remote_country_name",
                                        "object": "nc_remote_ip",
                                        "ds_key": "detail_service_action_networkConnectionAction_remoteIpDetails_country_countryName",
                                        "cybox": false
                                    }
                                ],
                                "detail_service_action_networkConnectionAction_localPortDetails_port": [
                                    {
                                        "key": "network-traffic.src_port",
                                        "object": "nc_nt",
                                        "transformer": "ToInteger"
                                    }
                                ],
                                "detail_service_action_networkConnectionAction_remotePortDetails_port": [
                                    {
                                        "key": "network-traffic.dst_port",
                                        "object": "nc_nt",
                                        "transformer": "ToInteger"
                                    }
                                ],
                                "detail_service_action_networkConnectionAction_protocol": [
                                    {
                                        "key": "network-traffic.protocols",
                                        "object": "nc_nt",
                                        "transformer": "ToLowercaseArray"
                                    }
                                ],
                                "detail_resource_instanceDetails_networkInterfaces_0_subnetId": {
                                    "key": "x_aws_vpc.subnet_id",
                                    "cybox": false
                                },
                                "detail_resource_instanceDetails_networkInterfaces_0_vpcId": {
                                    "key": "x_aws_vpc.vpc_id",
                                    "cybox": false
                                },
                                "detail_resource_instanceDetails_networkInterfaces_0_securityGroups_0_groupId": {
                                    "key": "x_aws_vpc.security_group_id",
                                    "cybox": false
                                },
                                "detail_resource_instanceDetails_networkInterfaces_0_securityGroups_0_groupName": {
                                    "key": "x_aws_vpc.security_group_name",
                                    "cybox": false
                                },
                                "detail_resource_instanceDetails_imageId": {
                                    "key": "x_aws_instance.image_id",
                                    "cybox": false
                                },
                                "detail_resource_instanceDetails_instanceId": {
                                    "key": "x_aws_instance.instance_id",
                                    "cybox": false
                                },
                                "detail_resource_instanceDetails_availabilityZone": {
                                    "key": "x_aws_instance.availability_zone",
                                    "cybox": false
                                }
                            },
                            "PORT_PROBE": {
                                "detail_resource_instanceDetails_networkInterfaces_0_privateIpAddress": [
                                    {
                                        "key": "ipv4-addr.value",
                                        "object": "pp_private_ip1"
                                    },
                                    {
                                        "key": "domain-name.resolves_to_refs",
                                        "object": "pp_private_name1",
                                        "references": [
                                            "pp_private_ip1"
                                        ]
                                    },
                                    {
                                        "key": "ipv4-addr.x_aws_interface_id",
                                        "object": "pp_private_ip1",
                                        "ds_key": "detail_resource_instanceDetails_networkInterfaces_0_networkInterfaceId",
                                        "cybox": false
                                    },
                                    {
                                        "key": "ipv4-addr.x_aws_ip_type",
                                        "object": "pp_private_ip1",
                                        "value": "private",
                                        "cybox": false
                                    }
                                ],
                                "detail_resource_instanceDetails_networkInterfaces_0_ipv6Addresses_0": [
                                    {
                                        "key": "ipv6-addr.value",
                                        "object": "pp_ipv6_ip"
                                    },
                                    {
                                        "key": "ipv6-addr.x_aws_interface_id",
                                        "object": "pp_ipv6_ip",
                                        "ds_key": "detail_resource_instanceDetails_networkInterfaces_0_networkInterfaceId",
                                        "cybox": false
                                    }
                                ],
                                "detail_resource_instanceDetails_networkInterfaces_0_privateDnsName": [
                                    {
                                        "key": "domain-name.value",
                                        "object": "pp_private_name1"
                                    }
                                ],
                                "detail_resource_instanceDetails_networkInterfaces_0_publicDnsName": [
                                    {
                                        "key": "domain-name.value",
                                        "object": "pp_public_name"
                                    }
                                ],
                                "detail_resource_instanceDetails_networkInterfaces_0_publicIp": [
                                    {
                                        "key": "ipv4-addr.value",
                                        "object": "pp_public_ip"
                                    },
                                    {
                                        "key": "domain-name.resolves_to_refs",
                                        "object": "pp_public_name",
                                        "references": [
                                            "pp_public_ip"
                                        ]
                                    },
                                    {
                                        "key": "ipv4-addr.x_aws_interface_id",
                                        "object": "pp_public_ip",
                                        "ds_key": "detail_resource_instanceDetails_networkInterfaces_0_networkInterfaceId",
                                        "cybox": false
                                    },
                                    {
                                        "key": "ipv4-addr.x_aws_ip_type",
                                        "object": "pp_public_ip",
                                        "value": "public",
                                        "cybox": false
                                    }
                                ],
                                "detail_resource_instanceDetails_networkInterfaces_1_privateIpAddress": [
                                    {
                                        "key": "ipv4-addr.value",
                                        "object": "pp_private_ip2"
                                    },
                                    {
                                        "key": "domain-name.resolves_to_refs",
                                        "object": "pp_private_name2",
                                        "references": [
                                            "pp_private_ip2"
                                        ]
                                    },
                                    {
                                        "key": "ipv4-addr.x_aws_interface_id",
                                        "object": "pp_private_ip2",
                                        "ds_key": "detail_resource_instanceDetails_networkInterfaces_1_networkInterfaceId",
                                        "cybox": false
                                    },
                                    {
                                        "key": "ipv4-addr.x_aws_ip_type",
                                        "object": "pp_private_ip2",
                                        "value": "private",
                                        "cybox": false
                                    }
                                ],
                                "detail_resource_instanceDetails_networkInterfaces_1_privateDnsName": [
                                    {
                                        "key": "domain-name.value",
                                        "object": "pp_private_name2"
                                    }
                                ],
                                "detail_service_action_portProbeAction_portProbeDetails_0_remoteIpDetails_ipAddressV4": [
                                    {
                                        "key": "ipv4-addr.value",
                                        "object": "pp_remote_ip"
                                    },
                                    {
                                        "key": "ipv4-addr.x_aws_remote_city_name",
                                        "object": "pp_remote_ip",
                                        "ds_key": "detail_service_action_portProbeAction_portProbeDetails_0_remoteIpDetails_city_cityName",
                                        "cybox": false
                                    },
                                    {
                                        "key": "ipv4-addr.x_aws_remote_country_name",
                                        "object": "pp_remote_ip",
                                        "ds_key": "detail_service_action_portProbeAction_portProbeDetails_0_remoteIpDetails_country_countryName",
                                        "cybox": false
                                    }
                                ],
                                "detail_service_action_portProbeAction_portProbeDetails_0_localPortDetails_port": [
                                    {
                                        "key": "x_aws_guardduty_finding.probe_port",
                                        "cybox": false
                                    }
                                ],
                                "detail_resource_instanceDetails_networkInterfaces_0_subnetId": {
                                    "key": "x_aws_vpc.subnet_id",
                                    "cybox": false
                                },
                                "detail_resource_instanceDetails_networkInterfaces_0_vpcId": {
                                    "key": "x_aws_vpc.vpc_id",
                                    "cybox": false
                                },
                                "detail_resource_instanceDetails_networkInterfaces_0_securityGroups_0_groupId": {
                                    "key": "x_aws_vpc.security_group_id",
                                    "cybox": false
                                },
                                "detail_resource_instanceDetails_networkInterfaces_0_securityGroups_0_groupName": {
                                    "key": "x_aws_vpc.security_group_name",
                                    "cybox": false
                                },
                                "detail_resource_instanceDetails_imageId": {
                                    "key": "x_aws_instance.image_id",
                                    "cybox": false
                                },
                                "detail_resource_instanceDetails_instanceId": {
                                    "key": "x_aws_instance.instance_id",
                                    "cybox": false
                                },
                                "detail_resource_instanceDetails_availabilityZone": {
                                    "key": "x_aws_instance.availability_zone",
                                    "cybox": false
                                }
                            },
                            "AWS_API_CALL": {
                                "detail_service_action_awsApiCallAction_remoteIpDetails_ipAddressV4": [
                                    {
                                        "key": "ipv4-addr.value",
                                        "object": "api_remote_ip"
                                    },
                                    {
                                        "key": "ipv4-addr.x_aws_remote_city_name",
                                        "object": "api_remote_ip",
                                        "ds_key": "detail_service_action_awsApiCallAction_remoteIpDetails_city_cityName",
                                        "cybox": false
                                    },
                                    {
                                        "key": "ipv4-addr.x_aws_remote_country_name",
                                        "object": "api_remote_ip",
                                        "ds_key": "detail_service_action_awsApiCallAction_remoteIpDetails_country_countryName",
                                        "cybox": false
                                    }
                                ],
                                "detail_resource_accessKeyDetails_principalId": {
                                    "key": "user-account.user_id",
                                    "object": "api_user"
                                },
                                "detail_resource_accessKeyDetails_userName": {
                                    "key": "user-account.account_login",
                                    "object": "api_user"
                                },
                                "detail_resource_accessKeyDetails_accessKeyId": {
                                    "key": "x_aws_api.access_key_id",
                                    "cybox": false
                                },
                                "detail_service_action_awsApiCallAction_api": {
                                    "key": "x_aws_api.api",
                                    "cybox": false
                                },
                                "detail_service_action_awsApiCallAction_serviceName": {
                                    "key": "x_aws_api.service_name",
                                    "cybox": false
                                }
                            },
                            "DNS_REQUEST": {
                                "detail_resource_instanceDetails_networkInterfaces_0_privateIpAddress": [
                                    {
                                        "key": "ipv4-addr.value",
                                        "object": "dns_private_ip1"
                                    },
                                    {
                                        "key": "domain-name.resolves_to_refs",
                                        "object": "dns_private_name1",
                                        "references": [
                                            "dns_private_ip1"
                                        ]
                                    },
                                    {
                                        "key": "ipv4-addr.x_aws_interface_id",
                                        "object": "dns_private_ip1",
                                        "ds_key": "detail_resource_instanceDetails_networkInterfaces_0_networkInterfaceId",
                                        "cybox": false
                                    },
                                    {
                                        "key": "ipv4-addr.x_aws_ip_type",
                                        "object": "dns_private_ip1",
                                        "value": "private",
                                        "cybox": false
                                    }
                                ],
                                "detail_resource_instanceDetails_networkInterfaces_0_ipv6Addresses_0": [
                                    {
                                        "key": "ipv6-addr.value",
                                        "object": "dns_ipv6_ip"
                                    },
                                    {
                                        "key": "ipv6-addr.x_aws_interface_id",
                                        "object": "dns_ipv6_ip",
                                        "ds_key": "detail_resource_instanceDetails_networkInterfaces_0_networkInterfaceId",
                                        "cybox": false
                                    }
                                ],
                                "detail_resource_instanceDetails_networkInterfaces_0_publicIp": [
                                    {
                                        "key": "ipv4-addr.value",
                                        "object": "dns_public_ip"
                                    },
                                    {
                                        "key": "domain-name.resolves_to_refs",
                                        "object": "dns_public_name",
                                        "references": [
                                            "dns_public_ip"
                                        ]
                                    },
                                    {
                                        "key": "ipv4-addr.x_aws_interface_id",
                                        "object": "dns_public_ip",
                                        "ds_key": "detail_resource_instanceDetails_networkInterfaces_0_networkInterfaceId",
                                        "cybox": false
                                    },
                                    {
                                        "key": "ipv4-addr.x_aws_ip_type",
                                        "object": "dns_public_ip",
                                        "value": "public",
                                        "cybox": false
                                    }
                                ],
                                "detail_resource_instanceDetails_networkInterfaces_0_privateDnsName": [
                                    {
                                        "key": "domain-name.value",
                                        "object": "dns_private_name1"
                                    }
                                ],
                                "detail_resource_instanceDetails_networkInterfaces_0_publicDnsName": [
                                    {
                                        "key": "domain-name.value",
                                        "object": "dns_public_name"
                                    }
                                ],
                                "detail_resource_instanceDetails_networkInterfaces_1_privateIpAddress": [
                                    {
                                        "key": "ipv4-addr.value",
                                        "object": "dns_private_ip2"
                                    },
                                    {
                                        "key": "domain-name.resolves_to_refs",
                                        "object": "dns_private_name2",
                                        "references": [
                                            "dns_private_ip2"
                                        ]
                                    },
                                    {
                                        "key": "ipv4-addr.x_aws_interface_id",
                                        "object": "dns_private_ip2",
                                        "ds_key": "detail_resource_instanceDetails_networkInterfaces_1_networkInterfaceId",
                                        "cybox": false
                                    },
                                    {
                                        "key": "ipv4-addr.x_aws_ip_type",
                                        "object": "dns_private_ip2",
                                        "value": "private",
                                        "cybox": false
                                    }
                                ],
                                "detail_resource_instanceDetails_networkInterfaces_1_privateDnsName": [
                                    {
                                        "key": "domain-name.value",
                                        "object": "dns_private_name2"
                                    }
                                ],
                                "detail_resource_instanceDetails_networkInterfaces_0_subnetId": {
                                    "key": "x_aws_vpc.subnet_id",
                                    "cybox": false
                                },
                                "detail_resource_instanceDetails_networkInterfaces_0_vpcId": {
                                    "key": "x_aws_vpc.vpc_id",
                                    "cybox": false
                                },
                                "detail_resource_instanceDetails_networkInterfaces_0_securityGroups_0_groupId": {
                                    "key": "x_aws_vpc.security_group_id",
                                    "cybox": false
                                },
                                "detail_resource_instanceDetails_networkInterfaces_0_securityGroups_0_groupName": {
                                    "key": "x_aws_vpc.security_group_name",
                                    "cybox": false
                                },
                                "detail_service_action_dnsRequestAction_domain": [
                                    {
                                        "key": "domain-name.value",
                                        "object": "dns_domain_name"
                                    }
                                ],
                                "detail_resource_instanceDetails_imageId": {
                                    "key": "x_aws_instance.image_id",
                                    "cybox": false
                                },
                                "detail_resource_instanceDetails_instanceId": {
                                    "key": "x_aws_instance.instance_id",
                                    "cybox": false
                                },
                                "detail_resource_instanceDetails_availabilityZone": {
                                    "key": "x_aws_instance.availability_zone",
                                    "cybox": false
                                }
                            },
                            "@timestamp": {
                                "key": "x_aws_guardduty_finding.timestamp",
                                "cybox": false,
                                "transformer": "AwsToTimestamp"
                            },
                            "account": {
                                "key": "x_aws.account_id",
                                "cybox": false
                            },
                            "detail_region": {
                                "key": "x_aws.region",
                                "cybox": false
                            },
                            "detail_id": {
                                "key": "x_aws_guardduty_finding.id",
                                "cybox": false
                            },
                            "detail_severity": {
                                "key": "x_aws_guardduty_finding.severity",
                                "cybox": false
                            },
                            "detail_type": {
                                "key": "x_aws_guardduty_finding.type",
                                "cybox": false
                            },
                            "detail_title": {
                                "key": "x_aws_guardduty_finding.title",
                                "cybox": false
                            },
                            "detail_service_eventFirstSeen": {
                                "key": "first_observed",
                                "cybox": false
                            },
                            "detail_service_eventLastSeen": {
                                "key": "last_observed",
                                "cybox": false
                            },
                            "event_count": [
                                {
                                    "key": "number_observed",
                                    "cybox": false,
                                    "transformer": "ToInteger"
                                }
                            ]
                        }
                    },
                    "vpcflow_from_stix_map": {
                        "ipv4-addr": {
                            "fields": {
                                "value": [
                                    "srcAddr",
                                    "dstAddr"
                                ],
                                "x_aws_interface_id": [
                                    "interfaceId"
                                ]
                            }
                        },
                        "ipv6-addr": {
                            "fields": {
                                "value": [
                                    "srcAddr",
                                    "dstAddr"
                                ],
                                "x_aws_interface_id": [
                                    "interfaceId"
                                ]
                            }
                        },
                        "network-traffic": {
                            "fields": {
                                "src_port": [
                                    "srcPort"
                                ],
                                "dst_port": [
                                    "dstPort"
                                ],
                                "src_ref.value": [
                                    "srcAddr"
                                ],
                                "dst_ref.value": [
                                    "dstAddr"
                                ],
                                "protocols[*]": [
                                    "protocol"
                                ],
                                "start": [
                                    "start"
                                ],
                                "end": [
                                    "end"
                                ]
                            }
                        },
                        "x-aws": {
                            "fields": {
                                "account_id": [
                                    "accountId"
                                ]
                            }
                        }
                    }
                }
            },
            "unmapped_fallback": {
                "type": "boolean",
                "default": false,
                "optional": true,
                "hidden": true
            }
        }
    },
    "configuration": {
        "auth": {
            "type": "fields",
            "aws_access_key_id": {
                "type": "password"
            },
            "aws_iam_role": {
                "type": "password",
                "optional": true
            },
            "aws_secret_access_key": {
                "type": "password"
            }
        }
    }
}