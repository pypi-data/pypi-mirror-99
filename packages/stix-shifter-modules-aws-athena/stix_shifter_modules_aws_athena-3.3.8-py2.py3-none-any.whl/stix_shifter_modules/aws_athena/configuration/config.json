{
    "connection": {
        "type": {
            "displayName": "Amazon Athena",
            "type": "connectorType"
        },
        "help": {
            "type": "link",
            "default": "https://www.ibm.com/support/knowledgecenter/SSTDPP_1.6.0/platform/docs/scp-core/data-sources.html"
        },
        "region": {
            "type": "text"
        },
        "s3_bucket_location": {
            "type": "text"
        },
        "vpcflow_database_name": {
            "type": "text",
            "optional": true
        },
        "vpcflow_table_name": {
            "type": "text",
            "optional": true
        },
        "guardduty_database_name": {
            "type": "text",
            "optional": true
        },
        "guardduty_table_name": {
            "type": "text",
            "optional": true
        },
        "options": {
            "unmapped_fallback": {
                "type": "boolean",
                "default": false,
                "optional": true,
                "hidden": true
            },
            "type": "fields",
            "result_limit": {
                "default": 10000,
                "min": 1,
                "type": "number",
                "previous": "connection.resultSizeLimit"
            },
            "time_range": {
                "default": 5,
                "min": 1,
                "type": "number",
                "previous": "connection.timerange",
                "nullable": true
            },
            "timeout": {
                "default": 10,
                "min": 1,
                "max": 60,
                "hidden": true,
                "type": "number",
                "previous": "connection.timeoutLimit"
            },
            "dialects": {
                "type": "array",
                "hidden": true,
                "optional": true
            },
            "language": {
                "type": "string",
                "default": "stix",
                "optional": true,
                "hidden": true
            },
            "validate_pattern": {
                "type": "boolean",
                "optional": true,
                "hidden": true,
                "previous": "connection.validate_pattern"
            },
            "stix_validator": {
                "type": "boolean",
                "default": false,
                "optional": true,
                "hidden": true,
                "previous": "connection.stix_validator"
            },
            "mapping": {
                "type": "json",
                "optional": true,
                "hidden": true,
                "previous": "connection.mapping",
                "default": {
                    "guardduty_config": {
                        "guardduty": {
                            "extract_fields": {
                                "principal_id": {
                                    "json_extract_query": "resource,'$.accesskeydetails.principalid'"
                                },
                                "user_name": {
                                    "json_extract_query": "resource,'$.accesskeydetails.username'"
                                },
                                "instance_id": {
                                    "json_extract_query": "resource,'$.instancedetails.instanceid'"
                                },
                                "image_id": {
                                    "json_extract_query": "resource,'$.instancedetails.imageid'"
                                },
                                "availability_zone": {
                                    "json_extract_query": "resource,'$.instancedetails.availabilityzone'"
                                },
                                "security_group_name": {
                                    "json_extract_query": "resource,'$.instancedetails.networkinterfaces.0.securitygroups.0.groupname'"
                                },
                                "security_group_id": {
                                    "json_extract_query": "resource,'$.instancedetails.networkinterfaces.0.securitygroups.0.groupid'"
                                },
                                "access_key_id": {
                                    "json_extract_query": "resource,'$.accesskeydetails.accesskeyid'"
                                },
                                "api": {
                                    "json_extract_query": "service,'$.action.accesawsapicallactionskeyid.api'"
                                },
                                "api_service_name": {
                                    "json_extract_query": "service,'$.action.accesawsapicallactionskeyid.servicename'"
                                },
                                "remote_ip": {
                                    "json_extract_query": [
                                        "service,'$.action.networkconnectionaction.remoteipdetails.ipaddressv4'",
                                        "service,'$.action.portprobeaction.remoteipdetails.ipaddressv4'",
                                        "service,'$.action.awsapicallaction.remoteipdetails.ipaddressv4'"
                                    ]
                                },
                                "remote_port": {
                                    "json_extract_query": "service,'$.action.networkconnectionaction.remoteportdetails.port'"
                                },
                                "eth0_private_ip": {
                                    "json_extract_query": "resource,'$.instancedetails.networkinterfaces.0.privateipaddress'"
                                },
                                "eth0_private_dns_name": {
                                    "json_extract_query": "resource,'$.instancedetails.networkinterfaces.0.privatednsname'"
                                },
                                "eth1_private_ip": {
                                    "json_extract_query": "resource,'$.instancedetails.networkinterfaces.1.privateipaddress'"
                                },
                                "eth1_private_dns_name": {
                                    "json_extract_query": "resource,'$.instancedetails.networkinterfaces.1.privatednsname'"
                                },
                                "local_port": {
                                    "json_extract_query": [
                                        "service,'$.action.networkconnectionaction.localportdetails.port'",
                                        "service,'$.action.portprobeaction.localportdetails.port'"
                                    ]
                                },
                                "public_ip": {
                                    "json_extract_query": "resource,'$.instancedetails.networkinterfaces.0.publicip'"
                                },
                                "ipv6_address": {
                                    "json_extract_query": "resource,'$.instancedetails.networkinterfaces.0.ipv6addresses.0'"
                                },
                                "protocol": {
                                    "json_extract_query": "service,'$.action.networkconnectionaction.protocol'"
                                },
                                "public_dns_name": {
                                    "json_extract_query": "resource,'$.instancedetails.networkinterfaces.0.publicdnsname'"
                                },
                                "dns_domain": {
                                    "json_extract_query": "service,'$.action.dnsrequestaction.domain'"
                                },
                                "interface_id": {
                                    "json_extract_query": "resource,'$.instancedetails.networkinterfaces.0.networkinterfaceid'"
                                },
                                "subnet_id": {
                                    "json_extract_query": "resource,'$.instancedetails.networkinterfaces.0.subnetid'"
                                },
                                "vpc_id": {
                                    "json_extract_query": "resource,'$.instancedetails.networkinterfaces.0.vpcid'"
                                },
                                "city_name": {
                                    "json_extract_query": [
                                        "service,'$.action.networkconnectionaction.remoteipdetails.city.cityname'",
                                        "service,'$.action.portprobeaction.remoteipdetails.city.cityname'",
                                        "service,'$.action.awsapicallaction.remoteipdetails.city.cityname'"
                                    ]
                                },
                                "country_name": {
                                    "json_extract_query": [
                                        "service,'$.action.networkconnectionaction.remoteipdetails.country.countryname'",
                                        "service,'$.action.portprobeaction.remoteipdetails.country.countryname'",
                                        "service,'$.action.awsapicallaction.remoteipdetails.country.countryname'"
                                    ]
                                },
                                "event_firstseen": {
                                    "json_extract_query": "service,'$.eventfirstseen'"
                                },
                                "event_lastseen": {
                                    "json_extract_query": "service,'$.eventlastseen'"
                                },
                                "platform": {
                                    "json_extract_query": "resource,'$.instancedetails.platform'"
                                }
                            }
                        }
                    },
                    "guardduty_from_stix_map": {
                        "ipv4-addr": {
                            "fields": {
                                "value": [
                                    "eth0_private_ip",
                                    "eth1_private_ip",
                                    "public_ip",
                                    "remote_ip"
                                ],
                                "x_aws_interface_id": [
                                    "interface_id"
                                ],
                                "x_aws_remote_city_name": [
                                    "city_name"
                                ],
                                "x_aws_remote_country_name": [
                                    "country_name"
                                ]
                            }
                        },
                        "ipv6-addr": {
                            "fields": {
                                "value": [
                                    "ipv6_address"
                                ],
                                "x_aws_interface_id": [
                                    "interface_id"
                                ]
                            }
                        },
                        "network-traffic": {
                            "fields": {
                                "src_port": [
                                    "local_port"
                                ],
                                "dst_port": [
                                    "remote_port"
                                ],
                                "src_ref.value": [
                                    "eth0_private_ip"
                                ],
                                "dst_ref.value": [
                                    "remote_ip"
                                ],
                                "protocols[*]": [
                                    "protocol"
                                ]
                            }
                        },
                        "domain-name": {
                            "fields": {
                                "value": [
                                    "eth0_private_dns_name",
                                    "eth1_private_dns_name",
                                    "public_dns_name",
                                    "dns_domain"
                                ]
                            }
                        },
                        "user-account": {
                            "fields": {
                                "user_id": [
                                    "principal_id"
                                ],
                                "account_login": [
                                    "user_name"
                                ]
                            }
                        },
                        "x-aws-details": {
                            "fields": {
                                "account_id": [
                                    "accountid"
                                ],
                                "region": [
                                    "region"
                                ]
                            }
                        },
                        "x-aws-instance": {
                            "fields": {
                                "instance_id": [
                                    "instance_id"
                                ],
                                "image_id": [
                                    "image_id"
                                ],
                                "availability_zone": [
                                    "availability_zone"
                                ]
                            }
                        },
                        "x-aws-vpc": {
                            "fields": {
                                "vpc_id": [
                                    "vpc_id"
                                ],
                                "subnet_id": [
                                    "subnet_id"
                                ],
                                "security_group_name": [
                                    "security_group_name"
                                ],
                                "security_group_id": [
                                    "security_group_id"
                                ]
                            }
                        },
                        "x-aws-api": {
                            "fields": {
                                "access_key_id": [
                                    "access_key_id"
                                ],
                                "api": [
                                    "api"
                                ],
                                "api_service_name": [
                                    "api_service_name"
                                ]
                            }
                        },
                        "x-ibm-finding": {
                            "fields": {
                                "name": [
                                    "title"
                                ],
                                "finding_type": [
                                    "type"
                                ],
                                "description": [
                                    "description"
                                ],
                                "src_ip_ref.value": [
                                    "eth0_private_ip"
                                ],
                                "dst_ip_ref.value": [
                                    "remote_ip"
                                ],
                                "start": [
                                    "event_firstseen"
                                ],
                                "end": [
                                    "event_lastseen"
                                ],
                                "src_os_ref.value": [
                                    "platform"
                                ],
                                "dst_geolocation": [
                                    "country_name"
                                ]
                            }
                        },
                        "startstopattr": "updatedat"
                    },
                    "network_protocol_map": {
                        "hopopt": "0",
                        "icmp": "1",
                        "igmp": "2",
                        "ggp": "3",
                        "ip-in-ip": "4",
                        "st": "5",
                        "tcp": "6",
                        "cbt": "7",
                        "egp": "8",
                        "igp": "9",
                        "bbn-rcc-mon": "10",
                        "nvp-ii": "11",
                        "pup": "12",
                        "argus": "13",
                        "emcon": "14",
                        "xnet": "15",
                        "chaos": "16",
                        "udp": "17",
                        "mux": "18",
                        "dcn-meas": "19",
                        "hmp": "20",
                        "prm": "21",
                        "xns-idp": "22",
                        "trunk-1": "23",
                        "trunk-2": "24",
                        "leaf-1": "25",
                        "leaf-2": "26",
                        "rdp": "27",
                        "irtp": "28",
                        "iso-tp4": "29",
                        "netblt": "30",
                        "mfe-nsp": "31",
                        "merit-inp": "32",
                        "dccp": "33",
                        "3pc": "34",
                        "idpr": "35",
                        "xtp": "36",
                        "ddp": "37",
                        "idpr-cmtp": "38",
                        "tp++": "39",
                        "il": "40",
                        "ipv6": "41",
                        "sdrp": "42",
                        "ipv6-route": "43",
                        "ipv6-frag": "44",
                        "idrp": "45",
                        "rsvp": "46",
                        "gre": "47",
                        "dsr": "48",
                        "bna": "49",
                        "esp": "50",
                        "ah": "51",
                        "i-nlsp": "52",
                        "swipe": "53",
                        "narp": "54",
                        "mobile": "55",
                        "tlsp": "56",
                        "skip": "57",
                        "ipv6-icmp": "58",
                        "ipv6-nonxt": "59",
                        "ipv6-opts": "60",
                        "cftp": "62",
                        "sat-expak": "64",
                        "kryptolan": "65",
                        "rvd": "66",
                        "ippc": "67",
                        "sat-mon": "69",
                        "visa": "70",
                        "ipcu": "71",
                        "cpnx": "72",
                        "cphb": "73",
                        "wsn": "74",
                        "pvp": "75",
                        "br-sat-mon": "76",
                        "sun-nd": "77",
                        "wb-mon": "78",
                        "wb-expak": "79",
                        "iso-ip": "80",
                        "vmtp": "81",
                        "secure-vmtp": "82",
                        "vines": "83",
                        "ttp": "84",
                        "iptm": "84",
                        "nsfnet-igp": "85",
                        "dgp": "86",
                        "tcf": "87",
                        "eigrp": "88",
                        "ospfigp": "89",
                        "sprite-rpc": "90",
                        "larp": "91",
                        "mtp": "92",
                        "ax.25": "93",
                        "ipip": "94",
                        "micp": "95",
                        "scc-sp": "96",
                        "etherip": "97",
                        "encap": "98",
                        "gmtp": "100",
                        "ifmp": "101",
                        "pnni": "102",
                        "pim": "103",
                        "aris": "104",
                        "scps": "105",
                        "qnx": "106",
                        "a/n": "107",
                        "ipcomp": "108",
                        "snp": "109",
                        "compaq-peer": "110",
                        "ipx-in-ip": "111",
                        "vrrp": "112",
                        "pgm": "113",
                        "l2tp": "115",
                        "ddx": "116",
                        "iatp": "117",
                        "stp": "118",
                        "srp": "119",
                        "uti": "120",
                        "smp": "121",
                        "sm": "122",
                        "ptp": "123",
                        "isis over ipv4": "124",
                        "fire": "125",
                        "crtp": "126",
                        "crudp": "127",
                        "sscopmce": "128",
                        "iplt": "129",
                        "sps": "130",
                        "pipe": "131",
                        "sctp": "132",
                        "fc": "133",
                        "rsvp-e2e-ignore": "134",
                        "mobility header": "135",
                        "udplite": "136",
                        "mpls-in-ip": "137",
                        "manet": "138",
                        "hip": "139",
                        "shim6": "140",
                        "wesp": "141",
                        "rohc": "142",
                        "reserved": "255"
                    },
                    "to_stix_map": {
                        "vpcflow": {
                            "sourceaddress": [
                                {
                                    "key": "ipv4-addr.value",
                                    "object": "src_ip"
                                },
                                {
                                    "key": "ipv6-addr.value",
                                    "object": "src_ip"
                                },
                                {
                                    "key": "network-traffic.src_ref",
                                    "object": "nt",
                                    "references": "src_ip"
                                },
                                {
                                    "key": "x-ibm-finding.src_ip_ref",
                                    "object": "ibm_finding",
                                    "references": "src_ip"
                                },
                                {
                                    "key": "ipv4-addr.x_aws_interface_id",
                                    "object": "src_ip",
                                    "ds_key": "interfaceid",
                                    "cybox": false
                                },
                                {
                                    "key": "ipv6-addr.x_aws_interface_id",
                                    "object": "src_ip",
                                    "ds_key": "interfaceid",
                                    "cybox": false
                                }
                            ],
                            "destinationaddress": [
                                {
                                    "key": "ipv4-addr.value",
                                    "object": "dst_ip"
                                },
                                {
                                    "key": "ipv6-addr.value",
                                    "object": "dst_ip"
                                },
                                {
                                    "key": "x-ibm-finding.dst_ip_ref",
                                    "object": "ibm_finding",
                                    "references": "dst_ip"
                                },
                                {
                                    "key": "network-traffic.dst_ref",
                                    "object": "nt",
                                    "references": "dst_ip"
                                }
                            ],
                            "sourceport": [
                                {
                                    "key": "network-traffic.src_port",
                                    "object": "nt",
                                    "transformer": "ToInteger"
                                }
                            ],
                            "destinationport": [
                                {
                                    "key": "network-traffic.dst_port",
                                    "object": "nt",
                                    "transformer": "ToInteger"
                                }
                            ],
                            "protocol": [
                                {
                                    "key": "network-traffic.protocols",
                                    "object": "nt",
                                    "transformer": "ToLowercaseArray"
                                }
                            ],
                            "starttime": [
                                {
                                    "key": "network-traffic.start",
                                    "object": "nt",
                                    "transformer": "EpochSecondsToTimestamp"
                                },
                                {
                                    "key": "x-ibm-finding.start",
                                    "object": "ibm_finding",
                                    "transformer": "EpochSecondsToTimestamp"
                                },
                                {
                                    "key": "first_observed",
                                    "cybox": false,
                                    "transformer": "EpochSecondsToTimestamp"
                                }
                            ],
                            "endtime": [
                                {
                                    "key": "network-traffic.end",
                                    "object": "nt",
                                    "transformer": "EpochSecondsToTimestamp"
                                },
                                {
                                    "key": "x-ibm-finding.end",
                                    "object": "ibm_finding",
                                    "transformer": "EpochSecondsToTimestamp"
                                },
                                {
                                    "key": "last_observed",
                                    "cybox": false,
                                    "transformer": "EpochSecondsToTimestamp"
                                }
                            ],
                            "account": [
                                {
                                    "key": "x-aws-details.account_id",
                                    "object": "accountid"
                                }
                            ],
                            "action": {
                                "key": "x-ibm-finding.finding_type",
                                "object": "ibm_finding"
                            },
                            "name": {
                                "key": "x-ibm-finding.name",
                                "object": "ibm_finding"
                            }
                        },
                        "guardduty": {
                            "resource_instancedetails_networkinterfaces_0_privateipaddress": [
                                {
                                    "key": "ipv4-addr.value",
                                    "object": "nc_private_ip1"
                                },
                                {
                                    "key": "network-traffic.src_ref",
                                    "object": "nc_nt",
                                    "references": "nc_private_ip1"
                                },
                                {
                                    "key": "domain-name.resolves_to_refs",
                                    "object": "private_dns_name",
                                    "references": [
                                        "nc_private_ip1"
                                    ]
                                },
                                {
                                    "key": "x-ibm-finding.src_ip_ref",
                                    "object": "ibm_finding",
                                    "references": "nc_private_ip1"
                                },
                                {
                                    "key": "ipv4-addr.x_aws_interface_id",
                                    "object": "nc_private_ip1",
                                    "ds_key": "resource_instancedetails_networkinterfaces_0_networkinterfaceid",
                                    "cybox": false
                                },
                                {
                                    "key": "ipv4-addr.x_aws_ip_type",
                                    "object": "nc_private_ip1",
                                    "value": "private",
                                    "cybox": false
                                }
                            ],
                            "resource_instancedetails_networkinterfaces_0_ipv6addresses_0": [
                                {
                                    "key": "ipv6-addr.value",
                                    "object": "nc_ipv6_ip"
                                },
                                {
                                    "key": "ipv6-addr.x_aws_interface_id",
                                    "object": "nc_ipv6_ip",
                                    "ds_key": "resource_instancedetails_networkinterfaces_0_networkinterfaceid",
                                    "cybox": false
                                }
                            ],
                            "resource_instancedetails_networkinterfaces_0_publicip": [
                                {
                                    "key": "ipv4-addr.value",
                                    "object": "nc_public_ip"
                                },
                                {
                                    "key": "domain-name.resolves_to_refs",
                                    "object": "nc_public_name",
                                    "references": [
                                        "nc_public_ip"
                                    ]
                                },
                                {
                                    "key": "ipv4-addr.x_aws_interface_id",
                                    "object": "nc_public_ip",
                                    "ds_key": "resource_instancedetails_networkinterfaces_0_networkinterfaceid",
                                    "cybox": false
                                },
                                {
                                    "key": "ipv4-addr.x_aws_ip_type",
                                    "object": "nc_public_ip",
                                    "value": "public",
                                    "cybox": false
                                }
                            ],
                            "resource_instancedetails_networkinterfaces_0_privatednsname": [
                                {
                                    "key": "domain-name.value",
                                    "object": "private_dns_name"
                                }
                            ],
                            "resource_instancedetails_networkinterfaces_0_publicdnsname": [
                                {
                                    "key": "domain-name.value",
                                    "object": "nc_public_name"
                                }
                            ],
                            "resource_instancedetails_networkinterfaces_1_privateipaddress": [
                                {
                                    "key": "ipv4-addr.value",
                                    "object": "nc_private_ip2"
                                },
                                {
                                    "key": "domain-name.resolves_to_refs",
                                    "object": "nc_private_name2",
                                    "references": [
                                        "nc_private_ip2"
                                    ]
                                },
                                {
                                    "key": "ipv4-addr.x_aws_interface_id",
                                    "object": "nc_private_ip2",
                                    "ds_key": "resource_instancedetails_networkinterfaces_1_networkinterfaceid",
                                    "cybox": false
                                },
                                {
                                    "key": "ipv4-addr.x_aws_ip_type",
                                    "object": "nc_private_ip2",
                                    "value": "private",
                                    "cybox": false
                                }
                            ],
                            "resource_instancedetails_networkinterfaces_1_privatednsname": [
                                {
                                    "key": "domain-name.value",
                                    "object": "nc_private_name2"
                                }
                            ],
                            "service_action_networkconnectionaction_remoteipdetails_ipaddressv4": [
                                {
                                    "key": "ipv4-addr.value",
                                    "object": "nc_remote_ip"
                                },
                                {
                                    "key": "network-traffic.dst_ref",
                                    "object": "nc_nt",
                                    "references": "nc_remote_ip"
                                },
                                {
                                    "key": "x-ibm-finding.dst_ip_ref",
                                    "object": "ibm_finding",
                                    "references": "nc_remote_ip"
                                },
                                {
                                    "key": "x-ibm-finding.dst_geolocation",
                                    "object": "ibm_finding",
                                    "ds_key": "service_action_networkconnectionaction_remoteipdetails_country_countryname",
                                    "cybox": false
                                },
                                {
                                    "key": "ipv4-addr.x_aws_remote_city_name",
                                    "object": "nc_remote_ip",
                                    "ds_key": "service_action_networkconnectionaction_remoteipdetails_city_cityname",
                                    "cybox": false
                                },
                                {
                                    "key": "ipv4-addr.x_aws_remote_country_name",
                                    "object": "nc_remote_ip",
                                    "ds_key": "service_action_networkconnectionaction_remoteipdetails_country_countryname",
                                    "cybox": false
                                }
                            ],
                            "service_action_networkconnectionaction_localportdetails_port": [
                                {
                                    "key": "network-traffic.src_port",
                                    "object": "nc_nt",
                                    "transformer": "ToInteger"
                                }
                            ],
                            "service_action_networkconnectionaction_remoteportdetails_port": [
                                {
                                    "key": "network-traffic.dst_port",
                                    "object": "nc_nt",
                                    "transformer": "ToInteger"
                                }
                            ],
                            "service_action_networkconnectionaction_protocol": [
                                {
                                    "key": "network-traffic.protocols",
                                    "object": "nc_nt",
                                    "transformer": "ToLowercaseArray"
                                }
                            ],
                            "resource_instancedetails_networkinterfaces_0_subnetid": {
                                "key": "x-aws-vpc.subnet_id",
                                "object": "vpc"
                            },
                            "resource_instancedetails_networkinterfaces_0_vpcid": {
                                "key": "x-aws-vpc.vpc_id",
                                "object": "vpc"
                            },
                            "resource_instancedetails_networkinterfaces_0_securitygroups_0_groupid": {
                                "key": "x-aws-vpc.security_group_id",
                                "object": "vpc"
                            },
                            "resource_instancedetails_networkinterfaces_0_securitygroups_0_groupname": {
                                "key": "x-aws-vpc.security_group_name",
                                "object": "vpc"
                            },
                            "resource_instancedetails_imageid": {
                                "key": "x-aws-instance.image_id",
                                "object": "instance"
                            },
                            "resource_instancedetails_instanceid": {
                                "key": "x-aws-instance.instance_id",
                                "object": "instance"
                            },
                            "resource_instancedetails_availabilityzone": {
                                "key": "x-aws-instance.availability_zone",
                                "object": "instance"
                            },
                            "portprobe_resource_instancedetails_networkinterfaces_0_privateipaddress": [
                                {
                                    "key": "ipv4-addr.value",
                                    "object": "pp_private_ip1"
                                },
                                {
                                    "key": "domain-name.resolves_to_refs",
                                    "object": "private_dns_name",
                                    "references": [
                                        "pp_private_ip1"
                                    ]
                                },
                                {
                                    "key": "x-ibm-finding.src_ip_ref",
                                    "object": "ibm_finding",
                                    "references": "pp_private_ip1"
                                },
                                {
                                    "key": "ipv4-addr.x_aws_interface_id",
                                    "object": "pp_private_ip1",
                                    "ds_key": "resource_instancedetails_networkinterfaces_0_networkinterfaceid",
                                    "cybox": false
                                },
                                {
                                    "key": "ipv4-addr.x_aws_ip_type",
                                    "object": "pp_private_ip1",
                                    "value": "private",
                                    "cybox": false
                                }
                            ],
                            "service_action_portprobeaction_portprobedetails_0_remoteipdetails_ipaddressv4": [
                                {
                                    "key": "ipv4-addr.value",
                                    "object": "pp_remote_ip"
                                },
                                {
                                    "key": "x-ibm-finding.dst_ip_ref",
                                    "object": "ibm_finding",
                                    "references": "pp_remote_ip"
                                },
                                {
                                    "key": "x-ibm-finding.dst_geolocation",
                                    "object": "ibm_finding",
                                    "ds_key": "service_action_portprobeaction_portprobedetails_0_remoteipdetails_country_countryname",
                                    "cybox": false
                                },
                                {
                                    "key": "ipv4-addr.x_aws_remote_city_name",
                                    "object": "pp_remote_ip",
                                    "ds_key": "service_action_portprobeaction_portprobedetails_0_remoteipdetails_city_cityname",
                                    "cybox": false
                                },
                                {
                                    "key": "ipv4-addr.x_aws_remote_country_name",
                                    "object": "pp_remote_ip",
                                    "ds_key": "service_action_portprobeaction_portprobedetails_0_remoteipdetails_country_countryname",
                                    "cybox": false
                                }
                            ],
                            "service_action_portprobeaction_portprobedetails_0_localportdetails_port": [
                                {
                                    "key": "x-ibm-finding.probe_port",
                                    "object": "ibm_finding"
                                }
                            ],
                            "service_action_awsapicallaction_remoteipdetails_ipaddressv4": [
                                {
                                    "key": "ipv4-addr.value",
                                    "object": "api_remote_ip"
                                },
                                {
                                    "key": "x-ibm-finding.dst_ip_ref",
                                    "object": "ibm_finding",
                                    "references": "api_remote_ip"
                                },
                                {
                                    "key": "x-ibm-finding.dst_geolocation",
                                    "object": "ibm_finding",
                                    "ds_key": "service_action_awsapicallaction_remoteipdetails_country_countryname",
                                    "cybox": false
                                },
                                {
                                    "key": "ipv4-addr.x_aws_remote_city_name",
                                    "object": "api_remote_ip",
                                    "ds_key": "service_action_awsapicallaction_remoteipdetails_city_cityname",
                                    "cybox": false
                                },
                                {
                                    "key": "ipv4-addr.x_aws_remote_country_name",
                                    "object": "api_remote_ip",
                                    "ds_key": "service_action_awsapicallaction_remoteipdetails_country_countryname",
                                    "cybox": false
                                }
                            ],
                            "resource_accesskeydetails_principalid": {
                                "key": "user-account.user_id",
                                "object": "api_user"
                            },
                            "resource_accesskeydetails_username": {
                                "key": "user-account.account_login",
                                "object": "api_user"
                            },
                            "resource_accesskeydetails_accesskeyid": {
                                "key": "x-aws-api.access_key_id",
                                "object": "api_details"
                            },
                            "service_action_awsapicallaction_api": {
                                "key": "x-aws-api.api",
                                "object": "api_details"
                            },
                            "service_action_awsapicallaction_servicename": {
                                "key": "x-aws-api.service_name",
                                "object": "api_details"
                            },
                            "dnsrequest_resource_instancedetails_networkinterfaces_0_privateipaddress": [
                                {
                                    "key": "ipv4-addr.value",
                                    "object": "dns_private_ip1"
                                },
                                {
                                    "key": "domain-name.resolves_to_refs",
                                    "object": "private_dns_name",
                                    "references": [
                                        "dns_private_ip1"
                                    ]
                                },
                                {
                                    "key": "x-ibm-finding.src_ip_ref",
                                    "object": "ibm_finding",
                                    "references": "dns_private_ip1"
                                },
                                {
                                    "key": "ipv4-addr.x_aws_interface_id",
                                    "object": "dns_private_ip1",
                                    "ds_key": "resource_instancedetails_networkinterfaces_0_networkinterfaceid",
                                    "cybox": false
                                },
                                {
                                    "key": "ipv4-addr.x_aws_ip_type",
                                    "object": "dns_private_ip1",
                                    "value": "private",
                                    "cybox": false
                                }
                            ],
                            "service_action_dnsrequestaction_domain": [
                                {
                                    "key": "domain-name.value",
                                    "object": "dns_domain_name"
                                }
                            ],
                            "accountid": {
                                "key": "x-aws-details.account_id",
                                "object": "aws_details"
                            },
                            "region": {
                                "key": "x-aws-details.region",
                                "object": "aws_details"
                            },
                            "severity": {
                                "key": "x-ibm-finding.severity",
                                "object": "ibm_finding"
                            },
                            "title": {
                                "key": "x-ibm-finding.name",
                                "object": "ibm_finding"
                            },
                            "type": {
                                "key": "x-ibm-finding.finding_type",
                                "object": "ibm_finding"
                            },
                            "description": {
                                "key": "x-ibm-finding.description",
                                "object": "ibm_finding"
                            },
                            "resource_instancedetails_platform": [
                                {
                                    "key": "software.name",
                                    "object": "software"
                                },
                                {
                                    "key": "x-ibm-finding.src_os_ref",
                                    "object": "ibm_finding",
                                    "references": "software"
                                }
                            ],
                            "service_eventfirstseen": [
                                {
                                    "key": "first_observed",
                                    "cybox": false
                                },
                                {
                                    "key": "x-ibm-finding.start",
                                    "object": "ibm_finding"
                                }
                            ],
                            "service_eventlastseen": [
                                {
                                    "key": "last_observed",
                                    "cybox": false
                                },
                                {
                                    "key": "x-ibm-finding.end",
                                    "object": "ibm_finding"
                                }
                            ]
                        }
                    },
                    "vpcflow_from_stix_map": {
                        "ipv4-addr": {
                            "fields": {
                                "value": [
                                    "sourceaddress",
                                    "destinationaddress"
                                ],
                                "x_aws_interface_id": [
                                    "interfaceId"
                                ]
                            }
                        },
                        "ipv6-addr": {
                            "fields": {
                                "value": [
                                    "sourceaddress",
                                    "destinationaddress"
                                ],
                                "x_aws_interface_id": [
                                    "interfaceid"
                                ]
                            }
                        },
                        "network-traffic": {
                            "fields": {
                                "src_port": [
                                    "sourceport"
                                ],
                                "dst_port": [
                                    "destinationport"
                                ],
                                "src_ref.value": [
                                    "sourceaddress"
                                ],
                                "dst_ref.value": [
                                    "destinationaddress"
                                ],
                                "protocols[*]": [
                                    "protocol"
                                ],
                                "start": [
                                    "starttime"
                                ],
                                "end": [
                                    "endtime"
                                ]
                            }
                        },
                        "x-aws-details": {
                            "fields": {
                                "account_id": [
                                    "account"
                                ]
                            }
                        },
                        "x-ibm-finding": {
                            "fields": {
                                "finding_type": [
                                    "action"
                                ],
                                "src_ip_ref.value": [
                                    "sourceaddress"
                                ],
                                "dst_ip_ref.value": [
                                    "destinationaddress"
                                ],
                                "start": [
                                    "starttime"
                                ],
                                "end": [
                                    "endtime"
                                ]
                            }
                        },
                        "startstopattr": "starttime"
                    }
                }
            }
        }
    },
    "configuration": {
        "auth": {
            "type": "fields",
            "aws_access_key_id": {
                "type": "password"
            },
            "aws_iam_role": {
                "type": "password",
                "optional": true
            },
            "aws_secret_access_key": {
                "type": "password"
            }
        }
    }
}