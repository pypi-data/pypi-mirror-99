(self.webpackChunk=self.webpackChunk||[]).push([[3688],{63688:function(t,e,r){"use strict";r.r(e),r.d(e,{default:function(){return y}}),r(23938),r(5769),r(63238),r(61418),r(17460),r(14078);var i=r(6594),a=r(1115),n=r(83094),o=r(53754),l=(r(17734),r(30983),r(21865),r(1892)),s=r.n(l),c=r(19936),u=(s()(c.Z,{insert:"head",singleton:!1}),c.Z.locals,r(16589),r(78066),r(61642));function d(){i.ZP.hide()}function h(t,e,r,a){if(e&&"string"!=typeof e)throw new Error("invalid path");i.ZP.show();var n=[];"Network"===e?n.push(ApiClient.getNetworkDevices()):e?(n.push(ApiClient.getDirectoryContents(e,r)),n.push(ApiClient.getParentPath(e))):n.push(ApiClient.getDrives()),Promise.all(n).then((function(r){var a=r[0],n=r[1]||"",l="";t.querySelector(".results").scrollTop=0,t.querySelector("#txtDirectoryPickerPath").value=e||"",e&&(l+=p("lnkPath lnkDirectory","",n,"..."));for(var s=0,c=a.length;s<c;s++){var u=a[s];l+=p("File"===u.Type?"lnkPath lnkFile":"lnkPath lnkDirectory",u.Type,u.Path,u.Name)}e||(l+=p("lnkPath lnkDirectory","","Network",o.ZP.translate("ButtonNetwork"))),t.querySelector(".results").innerHTML=l,i.ZP.hide()}),(function(){a&&(t.querySelector("#txtDirectoryPickerPath").value="",t.querySelector(".results").innerHTML="",i.ZP.hide())}))}function p(t,e,r,i){var a="";return a+='<div class="listItem listItem-border '.concat(t,'" data-type="').concat(e,'" data-path="').concat(r,'">'),a+='<div class="listItemBody" style="padding-left:0;padding-top:.5em;padding-bottom:.5em;">',a+='<div class="listItemBodyText">',a+=i,a+="</div>",a+="</div>",(a+='<span class="material-icons arrow_forward" style="font-size:inherit;"></span>')+"</div>"}function v(t){!function(t){(0,u.Z)(t)}({text:t})}function P(t){return t.path?Promise.resolve(t.path):ApiClient.getJSON(ApiClient.getUrl("Environment/DefaultDirectoryBrowser")).then((function(t){return t.Path||""}),(function(){return""}))}var f,y=function t(){var e;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.show=function(t){var r={includeDirectories:!0};null!=(t=t||{}).includeDirectories&&(r.includeDirectories=t.includeDirectories),null!=t.includeFiles&&(r.includeFiles=t.includeFiles),Promise.all([f?Promise.resolve(f):ApiClient.getPublicSystemInfo().then((function(t){return f=t,t})),P(t)]).then((function(i){var l=i[0],s=i[1],c=a.default.createDialog({size:"small",removeOnClose:!0,scrollY:!1});c.classList.add("ui-body-a"),c.classList.add("background-theme-a"),c.classList.add("directoryPicker"),c.classList.add("formDialog");var u="";u+='<div class="formDialogHeader">',u+='<button is="paper-icon-button-light" class="btnCloseDialog autoSize" tabindex="-1"><span class="material-icons arrow_back"></span></button>',u+='<h3 class="formDialogHeaderTitle">',u+=t.header||o.ZP.translate("HeaderSelectPath"),u+="</h3>",u+="</div>",u+=function(t,e){var r,i="";i+='<div class="formDialogContent scrollY">',i+='<div class="dialogContentInner dialog-content-centered" style="padding-top:2em;">',t.pathReadOnly||(i+='<div class="infoBanner" style="margin-bottom:1.5em;">',i+=t.instruction?"".concat(t.instruction,"<br/><br/>"):"","bsd"===e.OperatingSystem.toLowerCase()?(i+="<br/>",i+="<br/>",i+=o.ZP.translate("MessageDirectoryPickerBSDInstruction"),i+="<br/>"):"linux"===e.OperatingSystem.toLowerCase()&&(i+="<br/>",i+="<br/>",i+=o.ZP.translate("MessageDirectoryPickerLinuxInstruction"),i+="<br/>"),i+="</div>"),i+='<form style="margin:auto;">',i+='<div class="inputContainer" style="display: flex; align-items: center;">',i+='<div style="flex-grow:1;">',r=!0!==t.includeFiles?"LabelFolder":"LabelPath";var a=t.pathReadOnly?" readonly":"";return i+='<input is="emby-input" id="txtDirectoryPickerPath" type="text" required="required" '.concat(a,' label="').concat(o.ZP.translate(r),'"/>'),i+="</div>",a||(i+='<button type="button" is="paper-icon-button-light" class="btnRefreshDirectories emby-input-iconbutton" title="'.concat(o.ZP.translate("Refresh"),'"><span class="material-icons search"></span></button>')),i+="</div>",a||(i+='<div class="results paperList" style="max-height: 200px; overflow-y: auto;"></div>'),t.enableNetworkSharePath&&(i+='<div class="inputContainer" style="margin-top:2em;">',i+='<input is="emby-input" id="txtNetworkPath" type="text" label="'.concat(o.ZP.translate("LabelOptionalNetworkPath"),'"/>'),i+='<div class="fieldDescription">',i+=o.ZP.translate("LabelOptionalNetworkPathHelp","<b>\\\\server</b>","<b>\\\\192.168.1.101</b>"),i+="</div>",i+="</div>"),i+='<div class="formDialogFooter">',i+='<button is="emby-button" type="submit" class="raised button-submit block formDialogFooterItem">'.concat(o.ZP.translate("ButtonOk"),"</button>"),i+="</div>",i+="</form>",i+="</div>",(i+="</div>")+"</div>"}(t,l),c.innerHTML=u,function(t,e,r){t.addEventListener("click",(function(e){var i=n.ZP.parentWithClass(e.target,"lnkPath");if(i){var a=i.getAttribute("data-path");i.classList.contains("lnkFile")?t.querySelector("#txtDirectoryPickerPath").value=a:h(t,a,r,!0)}})),t.addEventListener("click",(function(e){if(n.ZP.parentWithClass(e.target,"btnRefreshDirectories")){var i=t.querySelector("#txtDirectoryPickerPath").value;h(t,i,r)}})),t.addEventListener("change",(function(e){var i=n.ZP.parentWithTag(e.target,"INPUT");i&&"txtDirectoryPickerPath"===i.id&&h(t,i.value,r)})),t.querySelector("form").addEventListener("submit",(function(t){if(e.callback){var r=this.querySelector("#txtNetworkPath");r=r?r.value:null;var i=this.querySelector("#txtDirectoryPickerPath").value;(function(t,e,r){return r.ajax({type:"POST",url:r.getUrl("Environment/ValidatePath"),data:JSON.stringify({ValidateWriteable:e,Path:t}),contentType:"application/json"}).catch((function(t){if(t){if(404===t.status)return v(o.ZP.translate("PathNotFound")),Promise.reject();if(500===t.status)return v(e?o.ZP.translate("WriteAccessRequired"):o.ZP.translate("PathNotFound")),Promise.reject()}return Promise.resolve()}))})(i,e.validateWriteable,ApiClient).then(e.callback(i,r))}return t.preventDefault(),t.stopPropagation(),!1}))}(c,t,r),c.addEventListener("close",d),a.default.open(c),c.querySelector(".btnCloseDialog").addEventListener("click",(function(){a.default.close(c)})),e=c,c.querySelector("#txtDirectoryPickerPath").value=s;var p=c.querySelector("#txtNetworkPath");p&&(p.value=t.networkSharePath||""),t.pathReadOnly||h(c,s,r,!0)}))},this.close=function(){e&&a.default.close(e)}}},19936:function(t,e,r){"use strict";var i=r(93476),a=r.n(i)()((function(t){return t[1]}));a.push([t.id,"#ulDirectoryPickerList a{padding-top:.4em;padding-bottom:.4em}.lblDirectoryPickerPath{white-space:nowrap}",""]),e.Z=a}}]);