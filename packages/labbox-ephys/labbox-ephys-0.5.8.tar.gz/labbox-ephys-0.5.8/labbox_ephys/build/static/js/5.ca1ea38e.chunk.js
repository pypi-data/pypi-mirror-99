(this["webpackJsonplabbox-ephys"]=this["webpackJsonplabbox-ephys"]||[]).push([[5],{115:function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return i})),n.d(e,"d",(function(){return a})),n.d(e,"e",(function(){return g})),n.d(e,"a",(function(){return _})),n.d(e,"f",(function(){return y})),n.d(e,"g",(function(){return p}));var r,i,a,o=n(12),c=n(33),s=n(24),u=n(2),l=n.n(u),h=n(38),f=n(8),d=n(9),v=n(0),x=n(127),b=n(116);!function(t){t.Move="MOVE",t.Press="PRESS",t.Release="RELEASE"}(r||(r={})),function(t){t.Press="PRESS",t.Release="RELEASE"}(i||(i={})),function(t){t.Enter="ENTER",t.Leave="LEAVE",t.Out="OUT"}(a||(a={}));var g=function(t,e,n){var r=t.currentTarget,i=[t.clientX-r.getBoundingClientRect().x,t.clientY-r.getBoundingClientRect().y];if(n){var a=Object(b.q)(n,i[0],i[1]);i=[a[0],a[1]]}var o={alt:t.altKey,ctrl:t.ctrlKey||t.metaKey,shift:t.shiftKey};return{point:[i[0],i[1]],mouseButton:t.buttons,modifiers:o,type:e}},_=function(){function t(e,n,r,i){Object(f.a)(this,t),this._onPaint=void 0,this._onPropsChange=void 0,this._runningOnPropsChange=!1,this._props=null,this._state=void 0,this._pixelWidth=null,this._pixelHeight=null,this._canvasElement=null,this._transformMatrix=void 0,this._inverseMatrix=void 0,this._repaintScheduled=!1,this._lastRepaintTimestamp=Number(new Date),this._discreteMouseEventHandlers=[],this._dragHandlers=[],this._keyboardEventHandlers=[],this._mousePresenceEventHandlers=[],this._wheelEventHandlers=[],this._refreshRate=120,this._state=r,this._onPaint=e,this._onPropsChange=n,this._discreteMouseEventHandlers=(null===i||void 0===i?void 0:i.discreteMouseEventHandlers)||[],this._dragHandlers=(null===i||void 0===i?void 0:i.dragHandlers)||[],this._keyboardEventHandlers=(null===i||void 0===i?void 0:i.keyboardEventHandlers)||[],this._mousePresenceEventHandlers=(null===i||void 0===i?void 0:i.mousePresenceEventHandlers)||[],this._wheelEventHandlers=(null===i||void 0===i?void 0:i.wheelEventHandlers)||[],this._transformMatrix=[[1,0,0],[0,1,0],[0,0,1]],this._inverseMatrix=[[1,0,0],[0,1,0],[0,0,1]]}return Object(d.a)(t,[{key:"getProps",value:function(){if(!this._props)throw Error("getProps must not be called before initial props are set");return this._props}},{key:"setProps",value:function(t){if(this._runningOnPropsChange)throw Error("Calling setProps inside onPropsChange is not allowed.");if(null===this._props||!m(this._props,t)){this._props=t,this._pixelWidth=t.width,this._pixelHeight=t.height,this._runningOnPropsChange=!0;try{this._onPropsChange(this,t)}finally{this._runningOnPropsChange=!1}}}},{key:"getState",value:function(){return this._state}},{key:"setState",value:function(t){this._state=t}},{key:"getTransformMatrix",value:function(){return this._transformMatrix}},{key:"setTransformMatrix",value:function(t){this._transformMatrix=t;try{this._inverseMatrix=Object(b.d)(t)}catch(e){console.warn(e),console.warn("WARNING: problem getting inverse transformation matrix"),this._inverseMatrix=t}}},{key:"pixelWidth",value:function(){if(null===this._pixelWidth)throw Error("Cannot get pixelWidth before it is set");return this._pixelWidth}},{key:"pixelHeight",value:function(){if(null===this._pixelHeight)throw Error("Cannot get pixelHeight before it is set");return this._pixelHeight}},{key:"resetCanvasElement",value:function(t){this._canvasElement=t}},{key:"canvasElement",value:function(){return this._canvasElement}},{key:"refreshRate",value:function(){return this._refreshRate}},{key:"setRefreshRate",value:function(t){this._refreshRate=t}},{key:"scheduleRepaint",value:function(){var t=this;if(!this._repaintScheduled){var e=Number(new Date)-this._lastRepaintTimestamp,n=1e3/this._refreshRate;e>2*n?this._doRepaint():(this._repaintScheduled=!0,setTimeout((function(){t._repaintScheduled=!1,t._doRepaint()}),n))}}},{key:"repaintImmediate",value:function(){this._doRepaint()}},{key:"_doRepaint",value:function(){var t=Object(h.a)(l.a.mark((function t(){var e,n,r,i,a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=null!==(e=null===(n=this._canvasElement)||void 0===n?void 0:n.getContext("2d"))&&void 0!==e?e:null){t.next=3;break}return t.abrupt("return");case 3:if(null!==this._pixelWidth&&null!==this._pixelHeight){t.next=5;break}return t.abrupt("return");case 5:if(i=new x.a(r,this._pixelWidth,this._pixelHeight,this._transformMatrix),!(a=this._onPaint(i,this._props,this._state))){t.next=11;break}return this._lastRepaintTimestamp=Number(new Date),t.next=11,a;case 11:this._lastRepaintTimestamp=Number(new Date);case 12:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"handleDiscreteEvent",value:function(t,e){if(0!==this._discreteMouseEventHandlers.length){var n,r=g(t,e,this._inverseMatrix),i=Object(s.a)(this._discreteMouseEventHandlers);try{for(i.s();!(n=i.n()).done;){(0,n.value)(r,this)}}catch(a){i.e(a)}finally{i.f()}}}},{key:"handleDrag",value:function(t,e,n,r,i){if(0!==this._dragHandlers.length){var a,o=Object(b.p)(this._inverseMatrix,t),u=r?Object(b.o)(this._inverseMatrix,[].concat(Object(c.a)(r),[1])):void 0,l=i?Object(b.o)(this._inverseMatrix,[].concat(Object(c.a)(i),[1])):void 0,h=Object(s.a)(this._dragHandlers);try{for(h.s();!(a=h.n()).done;){(0,a.value)(this,{dragRect:o,released:e,shift:n||!1,anchor:u,position:l})}}catch(f){h.e(f)}finally{h.f()}}}},{key:"handleKeyboardEvent",value:function(t,e){if(0===this._keyboardEventHandlers.length)return!0;var n,r=function(t,e){return{type:t,keyCode:e.keyCode}}(t,e),i=!0,a=Object(s.a)(this._keyboardEventHandlers);try{for(a.s();!(n=a.n()).done;){!1===(0,n.value)(r,this)&&(i=!1)}}catch(o){a.e(o)}finally{a.f()}return i}},{key:"handleMousePresenceEvent",value:function(t,e){if(0!==this._mousePresenceEventHandlers.length){var n,r={type:e},i=Object(s.a)(this._mousePresenceEventHandlers);try{for(i.s();!(n=i.n()).done;){(0,n.value)(r,this)}}catch(a){i.e(a)}finally{i.f()}}}},{key:"handleWheelEvent",value:function(t){if(0!==this._wheelEventHandlers.length){var e,n=function(t){return{deltaY:t.deltaY}}(t),r=Object(s.a)(this._wheelEventHandlers);try{for(r.s();!(e=r.n()).done;){(0,e.value)(n,this)}}catch(i){r.e(i)}finally{r.f()}}}}]),t}(),y=function(t,e){var n=Object(v.useState)(null),r=Object(o.a)(n,2),i=r[0],a=r[1];return Object(v.useEffect)((function(){null===i&&a(t())}),[i,a,t]),i&&e&&i.setProps(e),i},p=function(t){var e=Object(v.useState)([]),n=Object(o.a)(e,2),r=n[0],i=n[1];return function(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}(r,t)?r:(i(t),t)},m=function(t,e){for(var n in t)if(t[n]!==e[n])return!1;for(var r in e)if(t[r]!==e[r])return!1;return!0}},116:function(t,e,n){"use strict";n.d(e,"h",(function(){return a})),n.d(e,"i",(function(){return o})),n.d(e,"j",(function(){return c})),n.d(e,"k",(function(){return s})),n.d(e,"e",(function(){return u})),n.d(e,"c",(function(){return l})),n.d(e,"b",(function(){return h})),n.d(e,"l",(function(){return f})),n.d(e,"a",(function(){return d})),n.d(e,"m",(function(){return v})),n.d(e,"d",(function(){return x})),n.d(e,"q",(function(){return b})),n.d(e,"o",(function(){return g})),n.d(e,"p",(function(){return _})),n.d(e,"n",(function(){return y})),n.d(e,"f",(function(){return p})),n.d(e,"g",(function(){return m}));n(23);var r=n(24),i=n(711),a=function(t){if(t&&Array.isArray(t)&&2===t.length){var e,n=Object(r.a)(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;if(!p(i))return!1}}catch(a){n.e(a)}finally{n.f()}return!0}return!1},o=function(t){if(t&&Array.isArray(t)&&3===t.length){var e,n=Object(r.a)(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;if(!p(i))return!1}}catch(a){n.e(a)}finally{n.f()}return!0}return!1},c=function(t){if(t&&Array.isArray(t)&&4===t.length){var e,n=Object(r.a)(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;if(!p(i))return!1}}catch(a){n.e(a)}finally{n.f()}return!0}return!1},s=function(t,e,n,r){return r=r||n,Math.pow((t[0]-e[0])/n,2)+Math.pow((t[1]-e[1])/r,2)<=1},u=function(t){return Object(i.a)(t.xmax-t.xmin)},l=function(t){return Object(i.a)(t.ymax-t.ymin)},h=function(t){return[t.xmin+u(t)/2,Math.min(t.ymin,t.ymax)+l(t)/2]},f=function(t,e){return!(t.xmax<e.xmin||t.xmin>e.xmax)&&!(t.ymax<e.ymin||t.ymin>e.ymax)},d=function(t,e,n){return{xmin:t[0]-e,xmax:t[0]+e,ymin:t[1]-n,ymax:t[1]+n}},v=function(t){if(JSON.stringify(t.size())===JSON.stringify([3,3])){var e=t.toArray();if(JSON.stringify(e[2])===JSON.stringify([0,0,1]))return e}throw Error("Matrix ".concat(JSON.stringify(t)," is invalid as a transform matrix."))},x=function(t){var e=Object(i.c)(t);return Object(i.b)(e).toArray()},b=function(t,e,n){return g(t,[(r=[e,n])[0],r[1],1]);var r},g=function(t,e){2===e.length&&(e=[e[0],e[1],1]);var n=Object(i.c)(t),r=Object(i.c)(e);return Object(i.d)(n,r).toArray()},_=function(t,e){var n=Object(i.c)(t),r=Object(i.c)([[e.xmin,e.xmax],[e.ymin,e.ymax],[1,1]]),a=Object(i.d)(n,r).toArray(),o=a[0][0],c=a[0][1],s=a[1][0],u=a[1][1];return{xmin:Math.min(o,c),xmax:Math.max(o,c),ymin:Math.min(s,u),ymax:Math.max(s,u)}},y=function(t,e){var n=Object(i.c)(t),r=Object(i.c)([e[0],e[1],0]),a=Object(i.d)(n,r),o=Object(i.a)(a).toArray();return[o[0],o[1]]},p=function(t){return null!==t&&void 0!==t&&"number"===typeof t},m=function(t){return null!==t&&void 0!==t&&"string"===typeof t}},119:function(t,e,n){"use strict";n.d(e,"c",(function(){return a}));var r=n(144),i=n(127);n.d(e,"a",(function(){return i.b}));var a=function(t){var e=t([0,0]),n=t([1,0]),r=t([0,1]);return[[n[0]-e[0],r[0]-e[0],e[0]],[n[1]-e[1],r[1]-e[1],e[1]],[0,0,1]]};e.b=r.a},127:function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return u}));var r=n(23),i=n(8),a=n(9),o=n(711),c=n(116),s=function(){function t(e,n,r,a){Object(i.a)(this,t),this._exportingFigure=!1,this._context2D=void 0,this._pixelWidth=void 0,this._pixelHeight=void 0,this._primaryContext2D=void 0,this._offscreenCanvas=null,this._transformMatrix=void 0,this._context2D=e,this._primaryContext2D=e,this._pixelWidth=n,this._pixelHeight=r,this._transformMatrix=a}return Object(a.a)(t,[{key:"transform",value:function(e){try{var n=Object(c.m)(Object(o.d)(Object(o.c)(this._transformMatrix),Object(o.c)(e)));return new t(this._context2D,this._pixelWidth,this._pixelHeight,n)}catch(r){return console.warn("Problem transforming painter:",r),this}}},{key:"useOffscreenCanvas",value:function(t,e){try{var n=new OffscreenCanvas(Math.max(t,10),Math.max(e,10));this._offscreenCanvas=n;var r=n.getContext("2d");if(!r)throw Error("Unexpected");this._context2D=r}catch(i){console.warn("Problem in useOffscreenCanvas",i)}}},{key:"transferOffscreenToPrimary",value:function(){var t=this._offscreenCanvas;if(t){var e=t.transferToImageBitmap();this._context2D=this._primaryContext2D,this._context2D.clearRect(0,0,e.width,e.height),this._context2D.drawImage(e,0,0)}else console.warn("No offscreen canvas")}},{key:"getDefaultPen",value:function(){return{color:"black"}}},{key:"getDefaultFont",value:function(){return{"pixel-size":12,family:"Arial"}}},{key:"getDefaultBrush",value:function(){return{color:"black"}}},{key:"createPainterPath",value:function(){return new u}},{key:"setExportingFigure",value:function(t){this._exportingFigure=t}},{key:"exportingFigure",value:function(){return this._exportingFigure}},{key:"fillWholeCanvas",value:function(t){console.log("Pixel dimensions: 0 to ".concat(this._pixelWidth," and 0 to ").concat(this._pixelHeight)),this._context2D.save(),f(this._context2D,{color:t}),this._context2D.fillRect(0,0,this._pixelWidth,this._pixelHeight),this._context2D.restore()}},{key:"clear",value:function(){this.clearRect({xmin:0,xmax:this._pixelWidth,ymin:0,ymax:this._pixelHeight})}},{key:"clearRect",value:function(t){this.fillRect(t,{color:"transparent"})}},{key:"ctxSave",value:function(){this._context2D.save()}},{key:"ctxRestore",value:function(){this._context2D.restore()}},{key:"wipe",value:function(){this._context2D.clearRect(0,0,this._pixelWidth,this._pixelHeight)}},{key:"ctxTranslate",value:function(t){throw Error("Deprecated method, needs rewrite.")}},{key:"ctxRotate",value:function(t){this._context2D.rotate(t)}},{key:"fillRect",value:function(t,e){var n=Object(c.p)(this._transformMatrix,t);this._context2D.save(),f(this._context2D,e),this._context2D.fillRect(Math.min(n.xmin,n.xmax),Math.min(n.ymin,n.ymax),Object(c.e)(n),Object(c.c)(n)),this._context2D.restore()}},{key:"drawRect",value:function(t,e){var n=Object(c.p)(this._transformMatrix,t);this._context2D.save(),h(this._context2D,e),this._context2D.strokeRect(Math.min(n.xmin,n.xmax),Math.min(n.ymin,n.ymax),Object(c.e)(n),Object(c.c)(n)),this._context2D.restore()}},{key:"getEllipseFromBoundingRect",value:function(t){var e=Object(c.p)(this._transformMatrix,t);return{center:Object(c.b)(e),W:Math.abs(Object(c.e)(e)),H:Math.abs(Object(c.c)(e))}}},{key:"fillEllipse",value:function(t,e){var n=Object(r.a)({},this.getEllipseFromBoundingRect(t)),i=n.center,a=n.W,o=n.H;this._context2D.fillStyle=l(e.color),this._context2D.beginPath(),this._context2D.ellipse(i[0],i[1],a/2,o/2,0,0,2*Math.PI),this._context2D.fill()}},{key:"drawEllipse",value:function(t,e){var n=Object(r.a)({},this.getEllipseFromBoundingRect(t)),i=n.center,a=n.W,o=n.H;this._context2D.save(),h(this._context2D,e),this._context2D.beginPath(),this._context2D.ellipse(i[0],i[1],a/2,o/2,0,0,2*Math.PI),this._context2D.stroke(),this._context2D.restore()}},{key:"drawPath",value:function(t,e){this._context2D.save(),h(this._context2D,e),t._draw(this._context2D,this._transformMatrix),this._context2D.restore()}},{key:"drawLine",value:function(t,e,n,r,i){var a=new u;a.moveTo(t,e),a.lineTo(n,r),this.drawPath(a,i)}},{key:"drawText",value:function(t){var e,n,r=t.text,i=t.rect,a=t.alignment,o=t.font,s=t.pen,u=t.brush,l=t.orientation,x=void 0===l?"Horizontal":l,b=Object(c.p)(this._transformMatrix,i);this._context2D.save(),"Vertical"===x&&(this._context2D.rotate(-Math.PI/2),b={xmin:-(n=b).ymax,xmax:-n.ymin,ymin:n.xmin,ymax:n.xmax},a={Horizontal:"AlignBottom"===(e=a).Vertical?"AlignLeft":"AlignTop"===e.Vertical?"AlignRight":"AlignCenter",Vertical:"AlignRight"===e.Horizontal?"AlignBottom":"AlignLeft"===e.Horizontal?"AlignTop":"AlignCenter"}),d(this._context2D,o);var g=function(t,e){var n,r,i="left",a="bottom";switch(e.Horizontal){case"AlignLeft":n=t.xmin,i="left";break;case"AlignCenter":n=Object(c.b)(t)[0],i="center";break;case"AlignRight":n=t.xmax,i="right";break;default:throw new Error("Missing horizontal alignment in drawText: AlignLeft, AlignCenter, or AlignRight")}switch(e.Vertical){case"AlignBottom":r=t.ymax,a="bottom";break;case"AlignCenter":r=Object(c.b)(t)[1],a="middle";break;case"AlignTop":r=t.ymin,a="top";break;default:throw new Error("Missing vertical alignment in drawText: AlignTop, AlignBottom, or AlignVCenter")}return{x:n,y:r,textAlign:i,textBaseline:a}}(b,a);v(this._context2D,g),h(this._context2D,s),f(this._context2D,u),this._context2D.translate(g.x,g.y),this._context2D.fillText(r,0,0),this._context2D.restore()}},{key:"drawMarker",value:function(t,e){var n=Object(c.o)(this._transformMatrix,t);this._context2D.save(),e.pen&&(h(this._context2D,e.pen),this._context2D.beginPath(),this._context2D.ellipse(n[0],n[1],e.radius,e.radius,0,0,2*Math.PI),this._context2D.stroke()),e.brush&&(f(this._context2D,e.brush),this._context2D.beginPath(),this._context2D.ellipse(n[0],n[1],e.radius,e.radius,0,0,2*Math.PI),this._context2D.fill()),this._context2D.restore()}}]),t}(),u=function(){function t(){Object(i.a)(this,t),this._actions=[]}return Object(a.a)(t,[{key:"moveTo",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(Object(c.h)(t))return this.moveTo(t[0],t[1]);if(!Object(c.f)(e))throw Error("unexpected");this._actions.push({name:"moveTo",x:t,y:e})}},{key:"lineTo",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0;if(Object(c.h)(t))return this.lineTo(t[0],t[1]);if(!Object(c.f)(e))throw Error("unexpected");this._actions.push({name:"lineTo",x:t,y:e})}},{key:"_draw",value:function(t,e){var n=this;t.beginPath(),this._transformPathPoints(e).forEach((function(e){n._applyAction(t,e)})),t.stroke()}},{key:"_applyAction",value:function(t,e){"moveTo"===e.name?void 0!==e.x&&void 0!==e.y&&t.moveTo(e.x,e.y):"lineTo"===e.name&&void 0!==e.x&&void 0!==e.y&&t.lineTo(e.x,e.y)}},{key:"_transformPathPoints",value:function(t){var e=Object(o.c)(t);return this._actions.map((function(t){if(void 0!==t.x&&void 0!==t.y){var n=Object(o.c)([t.x,t.y,1]),i=Object(o.d)(e,n).toArray();return Object(r.a)(Object(r.a)({},t),{},{x:i[0],y:i[1]})}return t}))}}]),t}(),l=function(t){if(Object(c.g)(t))return t;if(Object(c.j)(t))return"rgba(".concat(Math.floor(t[0]),", ").concat(Math.floor(t[1]),", ").concat(Math.floor(t[2]),", ").concat(t[3],")");if(Object(c.i)(t))return"rgb(".concat(Math.floor(t[0]),", ").concat(Math.floor(t[1]),", ").concat(Math.floor(t[2]),")");throw Error("unexpected")},h=function(t,e){var n=e.color||"black",r=Object(c.f)(e.width)?e.width:1;t.strokeStyle=l(n),t.lineWidth=r||1},f=function(t,e){var n="color"in e?e.color:"black";t.fillStyle=l(n)},d=function(t,e){var n=e.pixelSize||"12",r=e.family||"Arial";t.font="".concat(n,"px ").concat(r)},v=function(t,e){t.textAlign=e.textAlign,t.textBaseline=e.textBaseline}},144:function(t,e,n){"use strict";var r=n(10),i=n(24),a=n(12),o=n(0),c=n.n(o),s=n(115),u="COMPUTE_DRAG",l="END_DRAG",h=function(t,e){var n=t.dragging,r=t.dragAnchor,i=e.type,a=e.mouseButton,o=e.point,c=e.shift;switch(i){case l:return{dragging:!1};case u:if(!a)return{dragging:!1};if(!o)throw Error("Unexpected: no point");if(n&&!r)throw Error("Invalid state in computing drag: cannot have drag set with no dragAnchor.");if(!n&&!r)return{dragging:!1,dragAnchor:o,shift:c||!1};if(!n&&r){if(!(n=Math.abs(o[0]-r[0])>4||Math.abs(o[1]-r[1])>4))return{dragging:!1,dragAnchor:r,shift:c||!1}}if(n&&r)return{dragging:!0,dragAnchor:r,dragPosition:o,dragRect:[Math.min(r[0],o[0]),Math.min(r[1],o[1]),Math.abs(r[0]-o[0]),Math.abs(r[1]-o[1])],shift:c||!1};break;default:throw Error("Invalid mode for drag reducer.")}throw Error("Unexpected: unreachable, but keeps ESLint happy")};e.a=function(t){var e=t.layers,n=t.preventDefaultWheel,f=t.width,d=t.height,v=Object(o.useState)(null),x=Object(a.a)(v,2),b=x[0],g=x[1],_=Object(o.useState)(!1),y=Object(a.a)(_,2),p=y[0],m=y[1],O=c.a.useCallback((function(t){g(t)}),[]);Object(o.useEffect)((function(){b&&(b._hasFocus=p)}),[p,b]),Object(o.useEffect)((function(){if(b&&e){var t=function(t){b._hasFocus&&t.preventDefault()};e.forEach((function(e,r){var i=b.children[r];i&&e?(n&&i.addEventListener("wheel",t),e.resetCanvasElement(i),e.scheduleRepaint()):console.warn("Unable to get canvas element for layer",r)}))}}),[b,e,n]);var j=Object(o.useReducer)(h,{dragging:!1}),k=Object(a.a)(j,2),E=k[0],w=k[1],D=Object(o.useRef)(null);Object(o.useEffect)((function(){e.forEach((function(t){t&&t.scheduleRepaint()}))}),[f,d,e]);var M=Object(o.useState)(null),P=Object(a.a)(M,2),R=P[0],A=P[1];Object(o.useEffect)((function(){var t=null;if(t=E.dragging?E:R&&R.dragging?R:null){var n=t.dragRect;if(n){var r,a={xmin:n[0],xmax:n[0]+n[2],ymin:n[1]+n[3],ymax:n[1]},o=Object(i.a)(e);try{for(o.s();!(r=o.n()).done;){var c=r.value;c&&c.handleDrag(a,!E.dragging,t.shift,t.dragAnchor,t.dragPosition)}}catch(s){o.e(s)}finally{o.f()}}}A(E)}),[E,R,A,e]);var C,H=Object(o.useCallback)((function(t,n){if(!E.dragging){var r,a=Object(i.a)(e);try{for(a.s();!(r=a.n()).done;){var o=r.value;o&&o.handleDiscreteEvent(t,n)}}catch(c){a.e(c)}finally{a.f()}}}),[e,E]),T=Object(o.useCallback)((function(t,n){if(e){var r,a=Object(i.a)(e);try{for(a.s();!(r=a.n()).done;){var o=r.value;o&&o.handleMousePresenceEvent(t,n)}}catch(c){a.e(c)}finally{a.f()}}}),[e]),S=Object(o.useCallback)((function(t){var e,n=Object(s.e)(t,s.b.Move),r=n.point,i=n.mouseButton,a=n.modifiers;e={type:u,mouseButton:1===i,point:r,shift:a.shift||!1},D.current?D.current=e:(D.current=e,setTimeout((function(){var t=D.current;D.current=null,t&&w(t)}),30)),H(t,s.b.Move)}),[H]),W=Object(o.useCallback)((function(t){var e=Object(s.e)(t,s.b.Press),n=e.point,r=e.modifiers;H(t,s.b.Press),w({type:u,mouseButton:!0,point:n,shift:r.shift||!1})}),[H]),B=Object(o.useCallback)((function(t){m(!0);var e=Object(s.e)(t,s.b.Move),n=e.point,r=e.mouseButton,i=e.modifiers;H(t,s.b.Release),w({type:u,mouseButton:1===r,point:n,shift:i.shift||!1}),w({type:l})}),[H,w]),I=Object(o.useCallback)((function(t){T(t,s.d.Enter)}),[T]),N=Object(o.useCallback)((function(t){m(!1),T(t,s.d.Leave)}),[T]),L=Object(o.useCallback)((function(t){var n,r=Object(i.a)(e);try{for(r.s();!(n=r.n()).done;){var a=n.value;a&&a.handleWheelEvent(t)}}catch(o){r.e(o)}finally{r.f()}}),[e]),F=Object(o.useCallback)((function(t){var n,r=Object(i.a)(e);try{for(r.s();!(n=r.n()).done;){var a=n.value;a&&!1===a.handleKeyboardEvent(s.c.Press,t)&&t.preventDefault()}}catch(o){r.e(o)}finally{r.f()}}),[e]),z=Object(i.a)(e);try{for(z.s();!(C=z.n()).done;){var J=C.value;if(J){var V=J.getProps(),K=V.width,U=V.height;if(K!==f||U!==d)throw console.warn(K,U,f,d),Error("Inconsistent width or height between canvas widget and layer")}}}catch(G){z.e(G)}finally{z.f()}return Object(r.jsx)("div",{ref:O,style:{position:"relative",width:f,height:d,left:0,top:0},onKeyDown:F,tabIndex:0,children:(e||[]).map((function(t,e){return Object(r.jsx)("canvas",{style:{position:"absolute",left:0,top:0},width:f,height:d,onMouseMove:S,onMouseDown:W,onMouseUp:B,onMouseEnter:I,onMouseLeave:N,onWheel:L},"canvas-"+e)}))})}},147:function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return i}));var r=function(t){return t.reduce((function(t,e){return t<=e?t:e}),1/0)},i=function(t){return t.reduce((function(t,e){return t>=e?t:e}),-1/0)}},151:function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return c}));var r=n(12),i=(n(2),n(38),n(17)),a=n(0),o=function(t){return Object(i.f)(t?"createjob_get_recording_info":"",{recording_object:t},{useClientCache:!0}).result},c=function(t){var e=Object(a.useContext)(i.a),n=Object(a.useRef)({}),o=Object(a.useState)(0),c=Object(r.a)(o,2)[1],s={};return t.forEach((function(t){var r=t.recordingId;if(!n.current[r]){var i=e.createHitherJob("createjob_get_recording_info",{recording_object:t.recordingObject},{useClientCache:!0});n.current[r]=i,i.wait().then((function(){c((function(t){return t+1}))})).catch((function(){c((function(t){return t+1}))}))}n.current[r].result&&(s[r]=n.current[r].result)})),s}}}]);
//# sourceMappingURL=5.ca1ea38e.chunk.js.map