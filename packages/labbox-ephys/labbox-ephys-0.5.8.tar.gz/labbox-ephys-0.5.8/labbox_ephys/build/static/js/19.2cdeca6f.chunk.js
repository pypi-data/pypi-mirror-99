(this["webpackJsonplabbox-ephys"]=this["webpackJsonplabbox-ephys"]||[]).push([[19],{114:function(e,t,n){"use strict";function r(e){return e&&e.ownerDocument||document}n.d(t,"a",(function(){return r}))},120:function(e,t,n){"use strict";function r(e){return function(){return null}}n.d(t,"a",(function(){return r}))},122:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(114);function c(e){return Object(r.a)(e).defaultView||window}},123:function(e,t,n){"use strict";function r(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((function(e,t){return null==t?e:function(){for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];e.apply(this,r),t.apply(this,r)}}),(function(){}))}n.d(t,"a",(function(){return r}))},124:function(e,t,n){"use strict";function r(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:166;function r(){for(var r=arguments.length,c=new Array(r),o=0;o<r;o++)c[o]=arguments[o];var i=this,u=function(){e.apply(i,c)};clearTimeout(t),t=setTimeout(u,n)}return r.clear=function(){clearTimeout(t)},r}n.d(t,"a",(function(){return r}))},125:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0);function c(e){var t=e.controlled,n=e.default,c=(e.name,e.state,r.useRef(void 0!==t).current),o=r.useState(n),i=o[0],u=o[1];return[c?t:i,r.useCallback((function(e){c||u(e)}),[])]}},128:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0);function c(e,t){return r.isValidElement(e)&&-1!==t.indexOf(e.type.muiName)}},129:function(e,t,n){"use strict";function r(e,t,n,r,c){return null}n.d(t,"a",(function(){return r}))},135:function(e,t){e.exports=function(e){return e&&e.__esModule?e:{default:e}}},136:function(e,t,n){var r=n(145);function c(){if("function"!==typeof WeakMap)return null;var e=new WeakMap;return c=function(){return e},e}e.exports=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!==typeof e)return{default:e};var t=c();if(t&&t.has(e))return t.get(e);var n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var u=o?Object.getOwnPropertyDescriptor(e,i):null;u&&(u.get||u.set)?Object.defineProperty(n,i,u):n[i]=e[i]}return n.default=e,t&&t.set(e,n),n}},137:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return r.createSvgIcon}});var r=n(140)},140:function(e,t,n){"use strict";n.r(t),n.d(t,"capitalize",(function(){return r.a})),n.d(t,"createChainedFunction",(function(){return c.a})),n.d(t,"createSvgIcon",(function(){return o.a})),n.d(t,"debounce",(function(){return i.a})),n.d(t,"deprecatedPropType",(function(){return u})),n.d(t,"isMuiElement",(function(){return a.a})),n.d(t,"ownerDocument",(function(){return d.a})),n.d(t,"ownerWindow",(function(){return l.a})),n.d(t,"requirePropFactory",(function(){return s.a})),n.d(t,"setRef",(function(){return f.a})),n.d(t,"unsupportedProp",(function(){return b.a})),n.d(t,"useControlled",(function(){return m.a})),n.d(t,"useEventCallback",(function(){return p.a})),n.d(t,"useForkRef",(function(){return g.a})),n.d(t,"unstable_useId",(function(){return v})),n.d(t,"useIsFocusVisible",(function(){return x.a}));var r=n(112),c=n(123),o=n(117),i=n(124);function u(e,t){return function(){return null}}var a=n(128),d=n(114),l=n(122),s=n(120),f=n(133),b=n(129),m=n(125),p=n(132),g=n(121),h=n(0);function v(e){var t=h.useState(e),n=t[0],r=t[1],c=e||n;return h.useEffect((function(){null==n&&r("mui-".concat(Math.round(1e5*Math.random())))}),[n]),c}var x=n(139)},145:function(e,t){function n(t){return"function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?e.exports=n=function(e){return typeof e}:e.exports=n=function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(t)}e.exports=n},153:function(e,t,n){"use strict";n.d(t,"b",(function(){return l}));var r=n(711),c=n(119),o=n(116),i=n(147),u=new Map,a=function(e){var t=JSON.stringify(e),n=u.get(t);if(void 0!==n)return n;var c=Number.MAX_VALUE;e.forEach((function(t){e.forEach((function(e){var n=Object(r.e)([t[0]-e[0],t[1]-e[1]]);0!==n&&(c=Math.min(c,n))}))}));var o=.45*c;return u.set(t,o),o},d=function(e,t){return{xmin:Object(i.b)(e.map((function(e){return e[0]})))-t,xmax:Object(i.a)(e.map((function(e){return e[0]})))+t,ymin:Object(i.b)(e.map((function(e){return e[1]})))-t,ymax:Object(i.a)(e.map((function(e){return e[1]})))+t}},l=function(e){var t=a(e),n=d(e,t);return Object(o.e)(n)/Object(o.c)(n)};t.a=function(e){var t=e.width,n=e.height,r=e.electrodeLocations,u=e.electrodeIds;if("vertical"===e.layoutMode)return function(e){var t=e.width,n=e.height,r=e.electrodeIds,o=r.length,i=Object(c.c)((function(e){return[10+e[0]*(t-20),10+e[1]*(n-20)]}));return{electrodeBoxes:r.map((function(e,t){var n=(.5+t)/(o+1),r={xmin:0,xmax:1,ymin:n-.5/(o+1),ymax:n+.5/(o+1)},i=Object(c.c)((function(e){return[r.xmin+e[0]*(r.xmax-r.xmin),r.ymin+e[1]*(r.ymax-r.ymin)]}));return{label:e+"",id:e,x:.5,y:n,rect:r,transform:i}})),transform:i,radius:1/(o+1),pixelRadius:(n-20)/(o+1)}}({width:t,height:n,electrodeIds:u});var l,s=function(e){var t=Object(i.b)(e.map((function(e){return e[0]}))),n=Object(i.a)(e.map((function(e){return e[0]}))),r=Object(i.b)(e.map((function(e){return e[1]}))),c=Object(i.a)(e.map((function(e){return e[1]})));return t===n&&r===c?e.map((function(e,t){return[t,0]})):e}(r),f=t-20,b=n-20,m=f/b,p=a(s),g=d(s,p),h=Object(o.e)(g)/Object(o.c)(g),v=s;h>1!==m>1&&(v=s.map((function(e){return[e[1],-e[0]]})),g={xmin:g.ymin,xmax:g.ymax,ymin:-g.xmax,ymax:-g.xmin},h=Object(o.e)(g)/Object(o.c)(g)),l=h>m?f/Object(o.e)(g):b/Object(o.c)(g),e.maxElectrodePixelRadius&&p*l>e.maxElectrodePixelRadius&&(l/=p*l/e.maxElectrodePixelRadius);var x=(t-Object(o.e)(g)*l)/2,y=(n-Object(o.c)(g)*l)/2,O=Object(c.c)((function(e){return[x+(e[0]-g.xmin)*l,y+(e[1]-g.ymin)*l]})),j=v.map((function(e,t){var n=e[0],r=e[1],i=Object(o.a)([n,r],p,p),a=Object(c.c)((function(e){return[i.xmin+e[0]*(i.xmax-i.xmin),i.ymin+e[1]*(i.ymax-i.ymin)]}));return{label:u[t]+"",id:u[t],x:n,y:r,rect:i,transform:a}})),w=Object(o.n)(O,[p,0])[0];return{electrodeBoxes:j,transform:O,radius:p,pixelRadius:w}}},168:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n(24),c=n(23),o=n(33),i=n(115),u=n(116),a=n(153),d={electrodeBoxes:[],radius:0,pixelRadius:0,dragRegion:null,draggedElectrodeIds:[],hoveredElectrodeId:null},l={border:"rgb(30, 30, 30)",base:"rgb(0, 0, 255)",selected:"rgb(196, 196, 128)",hover:"rgb(128, 128, 255)",selectedHover:"rgb(200, 200, 196)",dragged:"rgb(0, 0, 196)",draggedSelected:"rgb(180, 180, 150)",dragRect:"rgba(196, 196, 196, 0.5)",textLight:"rgb(228, 228, 228)",textDark:"rgb(32, 32, 32)"},s=function(e,t){if(e.type===i.b.Release){var n=t.getProps(),r=n.selectionDispatch;if(!n.electrodeOpts.disableSelection){var c=t.getState();if(null!==c){var a=c.electrodeBoxes.filter((function(t){return Object(u.k)(e.point,[t.x,t.y],c.radius)})).map((function(e){return e.id}));if(0!==a.length){var d=a[0],l=t.getProps().selection.selectedElectrodeIds||[];r({type:"SetSelectedElectrodeIds",selectedElectrodeIds:e.modifiers.ctrl?l.includes(d)?l.filter((function(e){return e!==d})):[].concat(Object(o.a)(l),[d]):e.modifiers.shift?[].concat(Object(o.a)(l),[d]):[d]}),t.scheduleRepaint()}else e.modifiers.ctrl||e.modifiers.shift||c.dragRegion||r({type:"SetSelectedElectrodeIds",selectedElectrodeIds:[]})}}}},f=function(e,t){if(e.type===i.b.Move){var n=t.getState();if(null!==n){var r=n.electrodeBoxes.filter((function(t){return Object(u.k)(e.point,[t.x,t.y],n.radius)})).map((function(e){return e.id}));t.setState(Object(c.a)(Object(c.a)({},n),{},{hoveredElectrodeId:0===r.length?null:r[0]})),t.scheduleRepaint()}}},b=function(e,t){var n,r=e.getState(),i=e.getProps(),a=i.selectionDispatch;if(!i.electrodeOpts.disableSelection&&null!==r){var d=null!==(n=r.electrodeBoxes.filter((function(e){return Object(u.l)(e.rect,t.dragRect)})))&&void 0!==n?n:[];if(t.released){var l,s,f=t.shift&&null!==(l=null===(s=e.getProps())||void 0===s?void 0:s.selection.selectedElectrodeIds)&&void 0!==l?l:[];a({type:"SetSelectedElectrodeIds",selectedElectrodeIds:[].concat(Object(o.a)(f),Object(o.a)(d.map((function(e){return e.id}))))}),e.setState(Object(c.a)(Object(c.a)({},r),{},{dragRegion:null,draggedElectrodeIds:[]}))}else e.setState(Object(c.a)(Object(c.a)({},r),{},{dragRegion:t.dragRect,draggedElectrodeIds:d.map((function(e){return e.id}))}));e.scheduleRepaint()}},m=function(){return new i.a((function(e,t,n){var c=t.electrodeOpts,o=c.colors||l,i=c.showLabels;e.wipe();var u,a=n.pixelRadius>5,d=Object(r.a)(n.electrodeBoxes);try{for(d.s();!(u=d.n()).done;){var s,f,b=u.value,m=!c.disableSelection&&((null===(s=t.selection.selectedElectrodeIds)||void 0===s?void 0:s.includes(b.id))||!1),p=!c.disableSelection&&n.hoveredElectrodeId===b.id,g=!c.disableSelection&&((null===(f=n.draggedElectrodeIds)||void 0===f?void 0:f.includes(b.id))||!1),h=m?g?o.draggedSelected:o.selectedHover:g?o.dragged:p?o.hover:o.base,v=t.layoutMode;if("geom"===v?(e.fillEllipse(b.rect,{color:h}),e.drawEllipse(b.rect,{color:o.border})):"vertical"===v&&e.drawLine(b.rect.xmin,(b.rect.ymin+b.rect.ymax)/2,b.rect.xmax,(b.rect.ymin+b.rect.ymax)/2,{color:o.border}),a){var x=[o.selected,o.draggedSelected,o.hover,o.selectedHover].includes(h)?o.textDark:o.textLight;i&&e.drawText({rect:b.rect,alignment:{Horizontal:"AlignCenter",Vertical:"AlignCenter"},font:{pixelSize:n.pixelRadius,family:"Arial"},pen:{color:x},brush:{color:x},text:b.label})}}}catch(y){d.e(y)}finally{d.f()}n.dragRegion&&e.fillRect(n.dragRegion,{color:o.dragRect})}),(function(e,t){var n=e.getState(),r=t.width,o=t.height,i=t.electrodeLocations,u=t.electrodeIds,d=t.layoutMode,l=Object(a.a)({width:r,height:o,electrodeLocations:i,electrodeIds:u,layoutMode:d,maxElectrodePixelRadius:t.electrodeOpts.maxElectrodePixelRadius}),s=l.electrodeBoxes,f=l.transform,b=l.radius,m=l.pixelRadius;e.setTransformMatrix(f),e.setState(Object(c.a)(Object(c.a)({},n),{},{electrodeBoxes:s,radius:b,pixelRadius:m})),e.scheduleRepaint()}),d,{discreteMouseEventHandlers:[s,f],dragHandlers:[b]})}},185:function(e,t,n){"use strict";var r=n(135),c=n(136);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=c(n(0)),i=(0,r(n(137)).default)(o.createElement("path",{d:"M10 12c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zM6 8c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm0 8c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12-8c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm-4 8c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm4-4c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-4-4c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-4-4c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"Grain");t.default=i},227:function(e,t,n){"use strict";var r=n(23),c=n(10),o=n(0),i=n(168),u=n(119),a=n(115);t.a=function(e){var t=Object(o.useMemo)((function(){return{layoutMode:"geom",electrodeIds:e.electrodes.map((function(e){return e.id})),electrodeLocations:e.electrodes.map((function(e){return[e.x,e.y]})),width:e.width,height:e.height,selection:e.selection,selectionDispatch:e.selectionDispatch,electrodeOpts:{showLabels:!0,maxElectrodePixelRadius:25},noiseLevel:0,samplingFrequency:0}}),[e]),n=Object(a.f)(i.a,t),d=Object(a.g)([n]);return Object(c.jsx)(u.b,Object(r.a)({layers:d},{width:e.width,height:e.height}),"electrodeGeometryCanvas")}},708:function(e,t,n){"use strict";n.r(t),n.d(t,"activate",(function(){return f}));var r=n(23),c=n(10),o=n(185),i=n.n(o),u=n(0),a=n(151),d=n(227),l=function(e){var t=e.recording,n=e.width,r=e.height,o=e.selection,i=e.selectionDispatch,l=Object(a.a)(t.recordingObject),s=o.visibleElectrodeIds,f=Object(u.useMemo)((function(){return(l?function(e,t){if(e&&t&&t.length!==e.length)throw Error("Electrode ID count does not match location count.");return t.map((function(t,n){var r=e[n];return{label:t+"",id:t,x:r[0],y:r[1]}}))}(l.geom,l.channel_ids):[]).filter((function(e){return!s||s.includes(e.id)}))}),[l,s]);return l?Object(c.jsx)(d.a,{electrodes:f,selection:o,selectionDispatch:i,width:n||350,height:r||150}):Object(c.jsx)("div",{children:"No recording info found for recording."})},s=function(e){var t=e.recording,n=e.recordingInfo,o=e.calculationPool,i=e.width,u=e.height,a=e.selection,d=e.selectionDispatch;return Object(c.jsx)(l,Object(r.a)({},{recording:t,recordingInfo:n,calculationPool:o,width:i,height:u,selection:a,selectionDispatch:d}))};function f(e){e.registerPlugin({type:"RecordingView",name:"ElectrodeGeometryRecordingView",label:"Electrode geometry",priority:50,defaultExpanded:!1,component:l,singleton:!0,icon:Object(c.jsx)(i.a,{})}),e.registerPlugin({type:"SortingView",name:"ElectrodeGeometrySortingView",label:"Electrode geometry",priority:50,component:s,singleton:!0,icon:Object(c.jsx)(i.a,{})})}}}]);
//# sourceMappingURL=19.2cdeca6f.chunk.js.map