{"version":3,"sources":["python/labbox_ephys/extensions/pluginInterface/WorkspaceRoute.ts","python/labbox_ephys/extensions/theme.ts","App.tsx","registerExtensions.ts","reportWebVitals.ts","index.tsx"],"names":["queryString","params","keys","Object","length","map","key","encodeURIComponent","join","themeOptions","palette","primary","deepPurple","secondary","indigo","overrides","MuiAccordionSummary","root","minHeight","maxHeight","paddingTop","MuiToolbar","regular","MuiTabs","MuiTab","padding","theme","createMuiTheme","App","version","mainWindowPlugin","usePlugins","filter","p","name","serverInfo","useContext","LabboxProviderContext","location","useLocation","history","useHistory","workspaceUri","useMemo","workspace","QueryString","parse","search","slice","defaultFeedId","startsWith","undefined","workspaceRoute","pathList","pathname","split","page","includes","Error","recordingId","sortingId","routeFromLocation","workspaceRouteDispatch","useCallback","a","newLocation","route","queryParams","locationFromRoute","s","newRoute","type","workspaceRouteReducer","push","className","component","registerExtensions","context","activate_mainwindow","activate","activate_workspaceview","activate_mountainview","activate_averagewaveforms","activate_clusters","activate_correlograms","activate_electrodegeometry","activate_firetrack","activate_pythonsnippets","activate_snippets","activate_spikeamplitudes","activate_timeseries","activate_unitstable","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","apiConfig","webSocketUrl","window","hostname","config","webSocketPort","baseSha1Url","httpPort","baseFeedUrl","extensionContext","createExtensionContext","ReactDOM","render","document","getElementById"],"mappings":"kVAuGIA,G,MAAc,SAACC,GACf,IAAMC,EAAOC,OAAOD,KAAKD,GACzB,OAAoB,IAAhBC,EAAKE,OAAqB,GACvB,IACHF,EAAKG,KAAI,SAACC,GACN,OAAOC,mBAAmBD,GAAO,IAAMC,mBAAmBN,EAAOK,OAClEE,KAAK,O,0BCxGVC,EAA6B,CAC/BC,QAAS,CACLC,QAASC,IACTC,UAAWC,KAEfC,UAAW,CACPC,oBAAqB,CACjBC,KAAM,CACF,aAAc,CACVC,UAAW,EACXC,UAAW,GACXC,WAAY,IAEhBF,UAAW,IAGnBG,WAAY,CACRC,QAAS,CACLJ,UAAW,GACX,0BAA4B,CACxBA,UAAW,MAIvBK,QAAS,CACLN,KAAM,CACFC,UAAW,GACXC,UAAW,KAGnBK,OAAQ,CACJP,KAAM,CACFC,UAAW,GACXC,UAAW,GACXM,QAAS,cAeVC,EAFDC,YAAelB,GCQdmB,MAlDf,YAA4C,IAA9BC,EAA6B,EAA7BA,QAENC,EADUC,cACiBC,QAAO,SAAAC,GAAC,MAAgB,eAAXA,EAAEC,QAAwB,GAEhEC,EAAeC,qBAAWC,KAA1BF,WAEFG,EAAWC,cACXC,EAAUC,cACVC,EAAeC,mBAAQ,WAC3B,IACMC,EADQC,IAAYC,MAAMR,EAASS,OAAOC,MAAM,IAC7BJ,WAAwB,UAC3CK,EAAa,OAAGd,QAAH,IAAGA,OAAH,EAAGA,EAAYc,cAElC,OADqBL,EAAUM,WAAW,gBAAkBN,EAAaK,EAAa,sBAAkBA,EAAlB,YAAmCL,QAAcO,IAEtI,CAACb,EAASS,OAAQZ,IAEfiB,EAAiCT,mBAAQ,WAC7C,OFsB6B,SAACL,EAA6BH,GAC3D,IAAMkB,EAAWf,EAASgB,SAASC,MAAM,KAGnCX,EADQC,IAAYC,MAAMR,EAASS,OAAOC,MAAM,IAC7BJ,WAAwB,UAC3CK,EAAa,OAAGd,QAAH,IAAGA,OAAH,EAAGA,EAAYc,cAC5BP,EAAeE,EAAUM,WAAW,gBAAkBN,EAAaK,EAAa,sBAAkBA,EAAlB,YAAmCL,QAAcO,EAEjIK,EAAOH,EAAS,IAAM,aAC5B,IArDO,CAAC,aAAc,YAAa,WAAWI,SAqDzBD,GAAO,MAAME,MAAM,iBAAD,OAAkBF,IACzD,OAAQA,GACJ,IAAK,aAAc,MAAO,CACtBd,eACAc,QAEJ,IAAK,YAAa,MAAO,CACrBd,eACAc,OACAG,YAAaN,EAAS,IAE1B,IAAK,UAAW,MAAO,CACnBX,eACAc,OACAG,YAAaN,EAAS,IAAM,GAC5BO,UAAWP,EAAS,IAAM,IAE9B,QAAS,MAAO,CACZX,eACAc,KAAM,eElDPK,CAAkBvB,EAAUH,KAClC,CAACG,EAAUH,IAIR2B,EAAyBC,uBAC7B,SAACC,GACC,IACMC,EF+CqB,SAACC,GAC9B,IAAMC,EAAyC,GAI/C,OAHID,EAAMxB,eACNyB,EAAW,UAAgBD,EAAMxB,cAE7BwB,EAAMV,MACV,IAAK,aAAc,MAAO,CACtBF,SAAS,IACTP,OAAQ/C,EAAYmE,IAExB,IAAK,YAAa,MAAO,CACrBb,SAAS,cAAD,OAAgBY,EAAMP,aAC9BZ,OAAQ/C,EAAYmE,IAExB,IAAK,UAAW,MAAO,CACnBb,SAAS,YAAD,OAAcY,EAAMP,YAApB,YAAmCO,EAAMN,WACjDb,OAAQ/C,EAAYmE,KE/DNC,CF8EW,SAACC,EAAmBL,GACrD,IAAIM,EAA2BD,EAC/B,OAAQL,EAAEO,MACN,IAAK,qBAAsBD,EAAW,CAClCd,KAAM,aACNd,aAAc2B,EAAE3B,cACjB,MACH,IAAK,oBAAqB4B,EAAW,CACjCd,KAAM,YACNG,YAAaK,EAAEL,YACfjB,aAAc2B,EAAE3B,cACjB,MACH,IAAK,kBAAmB4B,EAAW,CAC/Bd,KAAM,UACNG,YAAaK,EAAEL,YACfC,UAAWI,EAAEJ,UACblB,aAAc2B,EAAE3B,cAGxB,OAAO4B,EElG4BE,CAAsBpB,EAAgBY,IAElE1B,EAASgB,WAAaW,EAAYX,UAAchB,EAASS,SAAWkB,EAAYlB,QACnFP,EAAQiC,KAAR,2BAAiBnC,GAAa2B,MAGlC,CAACb,EAAgBZ,EAASF,IAG5B,OACE,cAAC,IAAD,CAAkBZ,MAAOA,EAAzB,SACE,qBAAKgD,UAAU,MAAf,SACE,wBAAQA,UAAU,aAAlB,SAEI5C,EACE,cAACA,EAAiB6C,UAAlB,eACM,CAACjC,eAAcU,iBAAgBU,yBAAwBjC,aAE1D,+D,wCCnBF+C,EA7BS,uCAAG,WAAOC,GAAP,uCAAAb,EAAA,sEACuB,oEADvB,wBACNc,EADM,EAChBC,UACaF,GAFG,SAG0B,yEAH1B,wBAGNG,EAHM,EAGhBD,UACgBF,GAJA,UAKyB,0EALzB,yBAKNI,EALM,EAKhBF,UACeF,GANC,UAO6B,0EAP7B,yBAONK,EAPM,EAOhBH,UACmBF,GARH,UASqB,2EATrB,yBASNM,EATM,EAShBJ,UACWF,GAVK,UAWyB,0EAXzB,yBAWNO,EAXM,EAWhBL,UACeF,GAZC,UAa8B,mEAb9B,yBAaNQ,EAbM,EAahBN,UACoBF,GAdJ,UAesB,0EAftB,yBAeNS,EAfM,EAehBP,UACYF,GAhBI,UAiB2B,4DAjB3B,yBAiBNU,EAjBM,EAiBhBR,UACiBF,GAlBD,UAmBqB,0EAnBrB,yBAmBNW,EAnBM,EAmBhBT,UACWF,GApBK,UAqB4B,0EArB5B,yBAqBNY,EArBM,EAqBhBV,UACkBF,GAtBF,UAuBuB,0EAvBvB,yBAuBNa,EAvBM,EAuBhBX,UACaF,GAxBG,UAyBuB,2EAzBvB,kBAyBNc,EAzBM,EAyBhBZ,UACaF,GA1BG,4CAAH,sDCUTe,EAZS,SAACC,GACnBA,GAAeA,aAAuBC,UACxC,+BAAqBC,MAAK,YAAkD,IAA/CC,EAA8C,EAA9CA,OAAQC,EAAsC,EAAtCA,OAAQC,EAA8B,EAA9BA,OAAQC,EAAsB,EAAtBA,OAAQC,EAAc,EAAdA,QAC3DJ,EAAOH,GACPI,EAAOJ,GACPK,EAAOL,GACPM,EAAON,GACPO,EAAQP,OCGRQ,EAAY,CAChBC,aAAa,QAAD,OAAUC,OAAOjE,SAASkE,SAA1B,YAAsCC,EAAOC,eACzDC,YAAY,UAAD,OAAYJ,OAAOjE,SAASkE,SAA5B,YAAwCC,EAAOG,SAA/C,SACXC,YAAY,UAAD,OAAYN,OAAOjE,SAASkE,SAA5B,YAAwCC,EAAOG,SAA/C,UAGPE,EAAmBC,cACzBnC,EAAmBkC,GAAkBf,MAAK,WACxCiB,IAASC,OAEL,cAAC,IAAD,CACEH,iBAAkBA,EAClBT,UAAWA,EAFb,SAIE,cAAC,IAAD,UAAe,cAAC,EAAD,CAAKxE,QAAQ,cAGhCqF,SAASC,eAAe,YAO5BvB,M","file":"static/js/main.9c029ad6.chunk.js","sourcesContent":["import { ServerInfo } from 'labbox/lib/LabboxProvider'\nimport QueryString from 'querystring'\n\ntype Page = 'recordings' | 'recording' | 'sorting'\nexport const isWorkspacePage = (x: string): x is Page => {\n    return ['recordings', 'recording', 'sorting'].includes(x)\n}\n\ntype WorkspaceRecordingsRoute = {\n    page: 'recordings',\n    workspaceUri?: string\n}\ntype WorspaceRecordingRoute = {\n    page: 'recording',\n    recordingId: string,\n    workspaceUri?: string\n}\ntype WorspaceSortingRoute = {\n    page: 'sorting',\n    recordingId: string,\n    sortingId: string,\n    workspaceUri?: string\n}\nexport type WorkspaceRoute = WorkspaceRecordingsRoute | WorspaceRecordingRoute | WorspaceSortingRoute\ntype GotoRecordingsPageAction = {\n    type: 'gotoRecordingsPage'\n}\ntype GotoRecordingPageAction = {\n    type: 'gotoRecordingPage',\n    recordingId: string\n}\ntype GotoSortingPageAction = {\n    type: 'gotoSortingPage',\n    recordingId: string,\n    sortingId: string\n}\nexport type WorkspaceRouteAction = GotoRecordingsPageAction | GotoRecordingPageAction | GotoSortingPageAction\nexport type WorkspaceRouteDispatch = (a: WorkspaceRouteAction) => void\n\nexport interface LocationInterface {\n    pathname: string\n    search: string\n}\n\nexport interface HistoryInterface {\n    location: LocationInterface\n    push: (x: LocationInterface) => void\n}\n\nexport const routeFromLocation = (location: LocationInterface, serverInfo: ServerInfo | null): WorkspaceRoute => {\n    const pathList = location.pathname.split('/')\n\n    const query = QueryString.parse(location.search.slice(1));\n    const workspace = (query.workspace as string) || 'default'\n    const defaultFeedId = serverInfo?.defaultFeedId\n    const workspaceUri = workspace.startsWith('workspace://') ? workspace : (defaultFeedId ? `workspace://${defaultFeedId}/${workspace}` : undefined)\n\n    const page = pathList[1] || 'recordings'\n    if (!isWorkspacePage(page)) throw Error(`Invalid page: ${page}`)\n    switch (page) {\n        case 'recordings': return {\n            workspaceUri,\n            page\n        }\n        case 'recording': return {\n            workspaceUri,\n            page,\n            recordingId: pathList[2]\n        }\n        case 'sorting': return {\n            workspaceUri,\n            page,\n            recordingId: pathList[2] || '',\n            sortingId: pathList[3] || ''\n        }\n        default: return {\n            workspaceUri,\n            page: 'recordings'\n        }\n    }\n}\n\nexport const locationFromRoute = (route: WorkspaceRoute) => {\n    const queryParams: { [key: string]: string } = {}\n    if (route.workspaceUri) {\n        queryParams['workspace'] = route.workspaceUri\n    }\n    switch (route.page) {\n        case 'recordings': return {\n            pathname: `/`,\n            search: queryString(queryParams)\n        }\n        case 'recording': return {\n            pathname: `/recording/${route.recordingId}`,\n            search: queryString(queryParams)\n        }\n        case 'sorting': return {\n            pathname: `/sorting/${route.recordingId}/${route.sortingId}`,\n            search: queryString(queryParams)\n        }\n    }\n}\n\nvar queryString = (params: { [key: string]: string }) => {\n    const keys = Object.keys(params)\n    if (keys.length === 0) return ''\n    return '?' + (\n        keys.map((key) => {\n            return encodeURIComponent(key) + '=' + encodeURIComponent(params[key])\n        }).join('&')\n    )\n}\n\nexport const workspaceRouteReducer = (s: WorkspaceRoute, a: WorkspaceRouteAction): WorkspaceRoute => {\n    let newRoute: WorkspaceRoute = s\n    switch (a.type) {\n        case 'gotoRecordingsPage': newRoute = {\n            page: 'recordings',\n            workspaceUri: s.workspaceUri\n        }; break;\n        case 'gotoRecordingPage': newRoute = {\n            page: 'recording',\n            recordingId: a.recordingId,\n            workspaceUri: s.workspaceUri\n        }; break;\n        case 'gotoSortingPage': newRoute = {\n            page: 'sorting',\n            recordingId: a.recordingId,\n            sortingId: a.sortingId,\n            workspaceUri: s.workspaceUri\n        }; break\n    }\n    return newRoute\n}","// LABBOX-CUSTOM ////////////////\nimport { deepPurple, indigo } from '@material-ui/core/colors';\nimport { createMuiTheme, ThemeOptions } from '@material-ui/core/styles';\n\n\nconst themeOptions: ThemeOptions = {\n    palette: {\n        primary: deepPurple,\n        secondary: indigo,\n    },\n    overrides: {\n        MuiAccordionSummary: {\n            root: {\n                '&$expanded': {\n                    minHeight: 0,\n                    maxHeight: 30,\n                    paddingTop: 10\n                },\n                minHeight: 0\n            }\n        },\n        MuiToolbar: {\n            regular: {\n                minHeight: 48,\n                '@media(min-width:600px)' : {\n                    minHeight: 48\n                }\n            }\n        },\n        MuiTabs: {\n            root: {\n                minHeight: 30,\n                maxHeight: 30\n            }\n        },\n        MuiTab: {\n            root: {\n                minHeight: 30,\n                maxHeight: 30,\n                padding: '6px 0px'\n            }\n        }\n        // MuiTableCell: {\n        //     root: {  //This can be referred from Material UI API documentation. \n        //         padding: '4px 8px',\n        //         backgroundColor: \"#fafafa\",\n        //     }\n        // },\n    },\n}\n/////////////////////////////////\n\nconst theme = createMuiTheme(themeOptions);\n\nexport default theme;","import { MuiThemeProvider } from '@material-ui/core';\nimport { LabboxProviderContext, usePlugins } from 'labbox';\nimport QueryString from 'querystring';\nimport React, { useCallback, useContext, useMemo } from 'react';\nimport { useHistory, useLocation } from 'react-router-dom';\nimport './App.css';\nimport { LabboxPlugin, MainWindowPlugin, WorkspaceRoute } from './python/labbox_ephys/extensions/pluginInterface';\nimport { locationFromRoute, routeFromLocation, WorkspaceRouteAction, workspaceRouteReducer } from './python/labbox_ephys/extensions/pluginInterface/WorkspaceRoute';\nimport theme from './python/labbox_ephys/extensions/theme';\n\nfunction App({version}: {version: string}) {\n  const plugins = usePlugins<LabboxPlugin>()\n  const mainWindowPlugin = plugins.filter(p => (p.name === 'MainWindow'))[0] as any as MainWindowPlugin\n\n  const { serverInfo } = useContext(LabboxProviderContext)\n\n  const location = useLocation()\n  const history = useHistory()\n  const workspaceUri = useMemo(() => {\n    const query = QueryString.parse(location.search.slice(1));\n    const workspace = (query.workspace as string) || 'default'\n    const defaultFeedId = serverInfo?.defaultFeedId\n    const workspaceUri = workspace.startsWith('workspace://') ? workspace : (defaultFeedId ? `workspace://${defaultFeedId}/${workspace}` : undefined)\n    return workspaceUri\n  }, [location.search, serverInfo])\n\n  const workspaceRoute: WorkspaceRoute = useMemo(() => {\n    return routeFromLocation(location, serverInfo)\n  }, [location, serverInfo])\n  \n  // const [workspaceRoute, workspaceRouteDispatch] = useReducer(workspaceRouteReducer, {page: 'main'})\n\n  const workspaceRouteDispatch = useCallback(\n    (a: WorkspaceRouteAction) => {\n      const newRoute: WorkspaceRoute = workspaceRouteReducer(workspaceRoute, a)\n      const newLocation = locationFromRoute(newRoute)\n      if ((location.pathname !== newLocation.pathname) || (location.search !== newLocation.search)) {\n        history.push({...location, ...newLocation})\n      }\n    },\n    [workspaceRoute, history, location]\n  )\n\n  return (\n    <MuiThemeProvider theme={theme}>\n      <div className=\"App\">\n        <header className=\"App-header\">\n          {\n            mainWindowPlugin ? (\n              <mainWindowPlugin.component\n                {...{workspaceUri, workspaceRoute, workspaceRouteDispatch, version}}\n              />\n            ) : (<div>No main window plugin</div>)\n          }\n        </header>\n      </div>\n    </MuiThemeProvider>\n  );\n}\n\nexport default App;\n","// This file was automatically generated by jinjaroot. Do not edit directly. See the .jinjaroot dir.\n\nimport { LabboxExtensionContext } from './python/labbox_ephys/extensions/pluginInterface'\n\nconst registerExtensions = async (context: LabboxExtensionContext) => {\n    const {activate: activate_mainwindow} = await import('./python/labbox_ephys/extensions/mainwindow/mainwindow')\n    activate_mainwindow(context)\n    const {activate: activate_workspaceview} = await import('./python/labbox_ephys/extensions/workspaceview/workspaceview')\n    activate_workspaceview(context)\n    const {activate: activate_mountainview} = await import('./python/labbox_ephys/extensions/mountainview/mountainview')\n    activate_mountainview(context)\n    const {activate: activate_averagewaveforms} = await import('./python/labbox_ephys/extensions/averagewaveforms/averagewaveforms')\n    activate_averagewaveforms(context)\n    const {activate: activate_clusters} = await import('./python/labbox_ephys/extensions/clusters/clusters')\n    activate_clusters(context)\n    const {activate: activate_correlograms} = await import('./python/labbox_ephys/extensions/correlograms/correlograms')\n    activate_correlograms(context)\n    const {activate: activate_electrodegeometry} = await import('./python/labbox_ephys/extensions/electrodegeometry/electrodegeometry')\n    activate_electrodegeometry(context)\n    const {activate: activate_firetrack} = await import('./python/labbox_ephys/extensions/firetrack/firetrack')\n    activate_firetrack(context)\n    const {activate: activate_pythonsnippets} = await import('./python/labbox_ephys/extensions/pythonsnippets/pythonsnippets')\n    activate_pythonsnippets(context)\n    const {activate: activate_snippets} = await import('./python/labbox_ephys/extensions/snippets/snippets')\n    activate_snippets(context)\n    const {activate: activate_spikeamplitudes} = await import('./python/labbox_ephys/extensions/spikeamplitudes/spikeamplitudes')\n    activate_spikeamplitudes(context)\n    const {activate: activate_timeseries} = await import('./python/labbox_ephys/extensions/timeseries/timeseries')\n    activate_timeseries(context)\n    const {activate: activate_unitstable} = await import('./python/labbox_ephys/extensions/unitstable/unitstable')\n    activate_unitstable(context)\n    }\n\nexport default registerExtensions","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","// This file was automatically generated by jinjaroot. Do not edit directly. See the .jinjaroot dir.\nimport { createExtensionContext, LabboxProvider } from 'labbox';\nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport { BrowserRouter } from 'react-router-dom';\nimport App from './App';\nimport config from './config.json';\nimport './index.css';\nimport { LabboxPlugin } from './python/labbox_ephys/extensions/pluginInterface';\nimport registerExtensions from './registerExtensions';\nimport reportWebVitals from './reportWebVitals';\n\nconst apiConfig = {\n  webSocketUrl: `ws://${window.location.hostname}:${config.webSocketPort}`,\n  baseSha1Url: `http://${window.location.hostname}:${config.httpPort}/sha1`,\n  baseFeedUrl: `http://${window.location.hostname}:${config.httpPort}/feed`\n}\n\nconst extensionContext = createExtensionContext<LabboxPlugin>()\nregisterExtensions(extensionContext).then(() => {\n  ReactDOM.render(\n    // <React.StrictMode>\n      <LabboxProvider\n        extensionContext={extensionContext}\n        apiConfig={apiConfig}\n      >\n        <BrowserRouter><App version=\"0.5.8\" /></BrowserRouter>\n      </LabboxProvider>,\n    // </React.StrictMode>,\n    document.getElementById('root')\n  );  \n})\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n\n\n"],"sourceRoot":""}