---
- name: upgrade to Debian GNU/Linux buster
  hosts: all
  become: true


  tasks:
    - name: Set Debian GNU/Linux buster repositories
      copy:
        dest: /etc/apt/sources.list
        content: |
          deb http://deb.debian.org/debian/ buster main
          deb http://deb.debian.org/debian/ stretch main
          deb-src http://deb.debian.org/debian/ buster main

          deb http://security.debian.org/debian-security buster/updates main
          deb http://security.debian.org/debian-security stretch/updates main
          deb-src http://security.debian.org/debian-security buster/updates main

          deb http://deb.debian.org/debian buster-backports main
          deb-src http://deb.debian.org/debian buster-backports main
      when: '"debian" == ansible_user'

    - name: Debian/Ubuntu | Installing repository key
      apt_key: url=https://packages.wazuh.com/key/GPG-KEY-WAZUH

    - name: Run the equivalent of "apt-get update"
      apt:
        update_cache: yes

    - name: Update all packages to the latest version
      apt:
        upgrade: dist
