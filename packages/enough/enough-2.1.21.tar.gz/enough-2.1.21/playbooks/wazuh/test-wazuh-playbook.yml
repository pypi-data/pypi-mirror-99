---

- name: prepare wazuh-host for tests
  hosts: wazuh-service-group
  become: true

  pre_tasks:

    - name: hold all mails /etc/postfix/hold.regexp
      copy:
        content: |
          /^/   HOLD
        dest: /etc/postfix/hold.regexp

    - name: systemtcl restart postfix
      service:
        name: postfix
        state: restarted

- name: open port 55000 on firewall for tests
  hosts: localhost
  gather_facts: false

  roles:
    - role: firewall
      vars:
        firewall_server: wazuh-host
        firewall_clients: [ 0.0.0.0/0 ]
        firewall_protocols: [ tcp ]
        firewall_ports: [ 55000 ]
