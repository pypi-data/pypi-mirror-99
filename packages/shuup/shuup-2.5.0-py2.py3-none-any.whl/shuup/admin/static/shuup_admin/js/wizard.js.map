{"version":3,"sources":["wizard.js"],"names":["$","fn","wizard","config","$navItems","find","$panes","$activeNavItem","$activeWizardPane","filter","isLastPane","index","length","getButton","text","name","disable","classes","tooltip","switchToPane","removeClass","eq","addClass","addActionBarToActivePane","remove","disablePrevious","disableNext","redirectOnLastPane","append","gettext","hidePrevious","data","skip","skipTooltip","next","previous","submit","$form","window","clearErrors","ajax","method","traditional","serializeForm","pubFuncs","isNumeric","on","prepend","done","location","fail","err","renderFormErrors","responseJSON","jQuery"],"mappings":";CAQC,SAASA,GACNA,EAAEC,GAAGC,OAAS,WAAoB,IAAA,EAAA,KAAXC,EAAO,UAAA,OAAA,QAAA,IAAA,UAAA,GAAA,UAAA,GAAA,GACtBC,EAAY,KAAKC,KAAK,kBACtBC,EAAS,KAAKD,KAAK,gBACnBE,EAAiBH,EAAUC,KAAK,WAChCG,EAAoBF,EAAOG,OAAO,WAE7BC,SAAAA,IACEJ,OAAAA,EAAOK,MAAMH,IAAsBF,EAAOM,OAAS,EAGrDC,SAAAA,EAAUC,EAAMC,EAAMC,EAASC,EAASC,GAEzC,MAAA,iBAAmBH,EAAO,sBACME,EAAU,MAAQD,EAAS,WAAW,KAC5DE,EAAS,wDAA0DA,EAAU,IAAK,IACnF,IACLJ,EACJ,YA8BCK,SAAAA,EAAaR,GAClBP,EAAUgB,YAAY,UACtBd,EAAOc,YAAY,UACnBb,EAAiBH,EAAUiB,GAAGV,GAC9BH,EAAoBF,EAAOe,GAAGV,GAC9BJ,EAAee,SAAS,UACxBd,EAAkBc,SAAS,UAhCtBC,WACLjB,EAAOD,KAAK,eAAemB,SACvBC,IAAAA,GAAkB,EAClBC,GAAc,EACqB,IAApCpB,EAAOK,MAAMH,KACZiB,GAAkB,GAEnBf,MAAiBP,EAAOwB,qBACvBD,GAAc,GAGlBlB,EAAkBoB,OACd,iDAEQf,EAAUgB,QAAQ,YAAa,WAAYJ,EAAiB,0BAA4BtB,EAAO2B,aAAc,SAAS,KACtHjB,EAAUH,IAAemB,QAAQ,UAAYA,QAAQ,QAAS,OAAQH,EAAa,2BAEvC,SAAvClB,EAAkBuB,KAAK,aAA0B5B,EAAO6B,KACzDnB,EAAUgB,QAAQ,QAAS,QAAQ,EAAO,yCAA0C1B,EAAO8B,aAAe,IAElH,gBAGRzB,EAAkBH,KAAK,2BAA2Ba,UAWlDK,GAGKW,SAAAA,IACLf,EAAab,EAAOK,MAAMH,GAAqB,GAG1C2B,SAAAA,IACLhB,EAAab,EAAOK,MAAMH,GAAqB,GAG1C4B,SAAAA,IACDC,IAAAA,EAAQ7B,EAAkBH,KAAK,QAE5BL,OADPsC,OAAOC,YAAYF,GACZrC,EAAEwC,KAAK,CAACC,OAAQ,OAAQC,aAAa,EAAMX,KAAMO,OAAOK,cAAcN,KAG7EO,IAAAA,EAAW,CAACV,KAAAA,EAAMC,SAAAA,EAAUC,OAAAA,GAE7BjC,OAAAA,KAAUyC,EACFA,EAASzC,MACVH,EAAE6C,UAAU1C,GAClBgB,EAAahB,IAER2C,KAAAA,GAAG,QAAS,sBAAuB,WACpC,EAAKzC,KAAK,uBAAuB0C,QAAQ,gDACtC5C,EAAO+B,KACN/B,EAAO+B,KAAK1B,GAEZ4B,IAASY,KAAK,WACP7C,EAAOwB,oBAAsBjB,IAC5B4B,OAAOW,SAAW9C,EAAOwB,mBAEzBO,MAELgB,KAAK,SAACC,GACLb,OAAOC,YAAY/B,EAAkBH,KAAK,SAC1C,EAAKA,KAAK,mBAAmBmB,SAC7B4B,iBAAiB5C,EAAkBH,KAAK,QAAS8C,EAAIE,kBAK5DP,KAAAA,GAAG,QAAS,0BAA2B,WACxC,EAAKzC,KAAK,2BAA2B0C,QAAQ,gDAC1C5C,EAAOgC,SACNhC,EAAOgC,SAAS3B,GAEhB2B,MAIHW,KAAAA,GAAG,QAAS,sBAAuB,WACjC3C,EAAOwB,oBAAsBjB,IAC5B4B,OAAOW,SAAW9C,EAAOwB,mBAEzBO,MAGRf,EAAa,IAEV,OArHd,CAuHCmC","file":"wizard.js","sourceRoot":"../../../static_src/wizard/js","sourcesContent":["/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2021, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n(function($) {\n    $.fn.wizard = function(config={}) {\n        let $navItems = this.find(\".wizard-nav li\");\n        let $panes = this.find(\".wizard-pane\");\n        let $activeNavItem = $navItems.find(\".active\");\n        let $activeWizardPane = $panes.filter(\".active\");\n\n        function isLastPane(){\n            return $panes.index($activeWizardPane) == $panes.length - 1;\n        }\n\n        function getButton(text, name, disable, classes, tooltip) {\n            return (\n                '<button name=\"' + name + '\"' +\n                         'class=\"btn btn-lg ' + classes + '\" ' + (disable? \"disabled\":\"\") +\n                         (tooltip? \"data-toggle='tooltip' data-placement='bottom' title='\" + tooltip + \"'\": \"\") +\n                         '>' +\n                    text +\n                '</button>'\n            );\n        }\n\n        function addActionBarToActivePane() {\n            $panes.find(\".action-bar\").remove();\n            let disablePrevious = false;\n            let disableNext = false;\n            if($panes.index($activeWizardPane) === 0) {\n                disablePrevious = true;\n            }\n            if(isLastPane() && !config.redirectOnLastPane) {\n                disableNext = true;\n            }\n\n            $activeWizardPane.append(\n                '<div class=\"action-bar\">' +\n                    '<div class=\"clearfix\">' +\n                        getButton(gettext(\"Previous\"), \"previous\", disablePrevious, \"btn-primary pull-left \" + (config.hidePrevious? \"hidden\":\"\")) +\n                        getButton(isLastPane() ? gettext(\"Finish\") : gettext(\"Next\"), \"next\", disableNext, \"btn-primary pull-right\") +\n                        (\n                            ($activeWizardPane.data(\"can_skip\") === \"True\" || config.skip) ?\n                            getButton(gettext(\"Skip\"), \"skip\", false, \"btn-default pull-right btn-wizard-skip\", config.skipTooltip) : ''\n                        ) +\n                    '</div>' +\n                '</div>'\n            );\n            $activeWizardPane.find('[data-toggle=\"tooltip\"]').tooltip();\n        }\n\n        function switchToPane(index) {\n            $navItems.removeClass(\"active\");\n            $panes.removeClass(\"active\");\n            $activeNavItem = $navItems.eq(index);\n            $activeWizardPane = $panes.eq(index);\n            $activeNavItem.addClass(\"active\");\n            $activeWizardPane.addClass(\"active\");\n\n            addActionBarToActivePane();\n        }\n\n        function next() {\n            switchToPane($panes.index($activeWizardPane) + 1);\n        }\n\n        function previous() {\n            switchToPane($panes.index($activeWizardPane) - 1);\n        }\n\n        function submit() {\n            let $form = $activeWizardPane.find(\"form\");\n            window.clearErrors($form);\n            return $.ajax({method: \"POST\", traditional: true, data: window.serializeForm($form)});\n        }\n\n        var pubFuncs = {next, previous, submit};\n\n        if(config in pubFuncs){\n            return pubFuncs[config]();\n        } else if($.isNumeric(config)){\n            switchToPane(config);\n        } else {\n            this.on(\"click\", \"button[name='next']\", () => {\n                this.find(\"button[name='next']\").prepend('<i class=\"fa fa-spinner fa-pulse fa-fw\"></i>');\n                if(config.next) {\n                    config.next($activeWizardPane);\n                } else {\n                    submit().done(() => {\n                        if(config.redirectOnLastPane && isLastPane()){\n                            window.location = config.redirectOnLastPane;\n                        } else {\n                            next();\n                        }\n                    }).fail((err) => {\n                        window.clearErrors($activeWizardPane.find(\"form\")); // Remove previous form errors\n                        this.find(\"i.fa.fa-spinner\").remove();\n                        renderFormErrors($activeWizardPane.find(\"form\"), err.responseJSON);\n                    });\n                }\n            });\n\n            this.on(\"click\", \"button[name='previous']\", () => {\n                this.find(\"button[name='previous']\").prepend('<i class=\"fa fa-spinner fa-pulse fa-fw\"></i>');\n                if(config.previous) {\n                    config.previous($activeWizardPane);\n                } else {\n                    previous();\n                }\n            });\n\n            this.on(\"click\", \"button[name='skip']\", () => {\n                if(config.redirectOnLastPane && isLastPane()){\n                    window.location = config.redirectOnLastPane;\n                } else {\n                    next();\n                }\n            });\n            switchToPane(0);\n        }\n        return this;\n    };\n}(jQuery));\n"]}