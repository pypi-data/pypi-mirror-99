{"version":3,"sources":["gdpr.js","index.js"],"names":["jQuery","document","getElementsByClassName","hidden","init","saveConsent","$","hide","data","serialize","ajax","url","attr","type","success","remove","removeClass","error","jqXHR","textStatus","errorThrown","show","window","alert","gettext","ready","navigator","userAgent","match","addClass","click","e","target"],"mappings":";;;CASA,WAyD0B,oBAAXA,QACPC,SAASC,uBAAuB,yBAAyB,GAAGC,QAAS,EACrEF,SAASC,uBAAuB,4BAA4B,GAAGC,QAAS,GA1DnEC,WA0BAC,SAAAA,IACLC,EAAE,0BAA0BC,OAC5BD,EAAE,6BAA6BC,OAC/BC,KAAOF,EAAE,iBAAiBG,YACZH,EAAEI,KAAK,CACjBC,IAAKL,EAAE,iBAAiBM,KAAK,UAC7BC,KAAM,OACNL,KAAMA,KACNM,QAAS,WAELR,EAAE,0BAA0BS,SAC5BT,EAAE,6BAA6BS,SAC/BT,EAAE,QAAQU,YAAY,kBAE1BC,MAAO,SAAUC,EAAOC,EAAYC,GAChCd,EAAE,0BAA0Be,OAC5Bf,EAAE,6BAA6Be,OAC/BC,OAAOC,MAAMC,QAAQ,2DA1CjClB,EAAEL,UAAUwB,MAAM,WACXC,UAAUC,UAAUC,MAAM,mBACzBtB,EAAE,8BAA8BuB,SAAS,mBAKjDvB,EAAE,4BAA4BwB,MAAM,WAChCxB,EAAE,6BAA6BuB,SAAS,WACxCvB,EAAE,QAAQuB,SAAS,mBAGvBvB,EAAE,wCAAwCwB,MAAM,WAC5CxB,EAAE,6BAA6BU,YAAY,WAC3CV,EAAE,QAAQU,YAAY,mBAG1BV,EAAE,wBAAwBwB,MAAM,SAACC,GAC7BzB,EAAE,kCAAkCU,YAAY,UAChDV,EAAE,wBAAwBU,YAAY,UACtCV,EAAEyB,EAAEC,QAAQH,SAAS,UACfrB,IAAAA,EAAOF,EAAEyB,EAAEC,QAAQxB,OACzBF,EAAE,YAAcE,EAAKwB,QAAQH,SAAS,YAyB1CvB,EAAE,yBAAyBwB,MAAM,WAC7BzB,MAGJC,EAAE,cAAcwB,MAAM,WAClBzB,MAOAD,GA7DR;;ACIA,aAHA,QAAA,eAGA,QAAA","file":"shuup-gdpr.js","sourceRoot":"../static_src","sourcesContent":["/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2021, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n(() => {\n    function init() {\n    $(document).ready(function() {\n        if(navigator.userAgent.match(/Windows Phone/i)){\n            $(\".gdpr-consent-warn-content\").addClass(\"windows-phone\");\n        }\n\n    });\n\n    $(\"#privacy-preferences-btn\").click(() => {\n        $(\".gdpr-consent-preferences\").addClass(\"visible\");\n        $(\"body\").addClass(\"body-noscroll\");\n    });\n\n    $(\".gdpr-consent-preferences .btn-close\").click(() => {\n        $(\".gdpr-consent-preferences\").removeClass(\"visible\");\n        $(\"body\").removeClass(\"body-noscroll\");\n    });\n\n    $(\".consent-option-item\").click((e) => {\n        $(\".gdpr-consent-preference-panel\").removeClass(\"active\");\n        $(\".consent-option-item\").removeClass(\"active\");\n        $(e.target).addClass(\"active\");\n        const data = $(e.target).data();\n        $(\"#consent_\" + data.target).addClass(\"active\");\n    });\n\n    function saveConsent() {\n        $(\".gdpr-consent-warn-bar\").hide();\n        $(\".gdpr-consent-preferences\").hide();\n        data = $(\"#consent-form\").serialize();\n        var request = $.ajax({\n            url: $(\"#consent-form\").attr(\"action\"),\n            type: 'POST',\n            data: data,\n            success: function() {\n                // Remove GDPR divs and their content upon successful completion\n                $(\".gdpr-consent-warn-bar\").remove();\n                $(\".gdpr-consent-preferences\").remove();\n                $(\"body\").removeClass(\"body-noscroll\");\n            },\n            error: function (jqXHR, textStatus, errorThrown) {\n                $(\".gdpr-consent-warn-bar\").show();\n                $(\".gdpr-consent-preferences\").show();\n                window.alert(gettext(\"Error! Saving the consent failed, please try again.\"));\n            }\n        });\n    }\n\n    $(\"#btn-save-preferences\").click(() => {\n        saveConsent();\n    });\n\n    $(\"#agree-btn\").click(() => {\n        saveConsent();\n    });\n    }\n    if (typeof jQuery === \"undefined\") {\n        document.getElementsByClassName(\"gdpr-consent-warn-bar\")[0].hidden = true;\n        document.getElementsByClassName(\"gdpr-consent-preferences\")[0].hidden = true;\n    } else {\n        init();\n    }\n\n})();\n","/**\n * This file is part of Shuup.\n *\n * Copyright (c) 2012-2021, Shoop Commerce Ltd. All rights reserved.\n *\n * This source code is licensed under the OSL-3.0 license found in the\n * LICENSE file in the root directory of this source tree.\n */\n\n// styles\nimport \"./gdpr.less\";\n\n// scripts\nimport \"./gdpr.js\";\n"]}