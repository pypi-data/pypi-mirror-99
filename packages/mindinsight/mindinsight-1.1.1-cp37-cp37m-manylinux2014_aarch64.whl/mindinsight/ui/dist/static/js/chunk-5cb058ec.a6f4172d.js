(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5cb058ec"],{1148:function(t,e,a){"use strict";var i=a("a691"),r=a("1d80");t.exports="".repeat||function(t){var e=String(r(this)),a="",s=i(t);if(s<0||s==1/0)throw RangeError("Wrong number of repetitions");for(;s>0;(s>>>=1)&&(e+=e))1&s&&(a+=e);return a}},"1b54":function(t,e,a){t.exports=a.p+"static/img/queue.9041b2bc.svg"},"2a4b":function(t,e,a){"use strict";a("a263")},"3ca3":function(t,e,a){"use strict";var i=a("6547").charAt,r=a("69f3"),s=a("7dd0"),n="String Iterator",o=r.set,u=r.getterFor(n);s(String,"String",(function(t){o(this,{type:n,string:String(t),index:0})}),(function(){var t,e=u(this),a=e.string,r=e.index;return r>=a.length?{value:void 0,done:!0}:(t=i(a,r),e.index+=t.length,{value:t,done:!1})}))},"408a":function(t,e,a){var i=a("c6b6");t.exports=function(t){if("number"!=typeof t&&"Number"!=i(t))throw TypeError("Incorrect invocation");return+t}},"4de4":function(t,e,a){"use strict";var i=a("23e7"),r=a("b727").filter,s=a("1dde"),n=a("ae40"),o=s("filter"),u=n("filter");i({target:"Array",proto:!0,forced:!o||!u},{filter:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}})},"4df4":function(t,e,a){"use strict";var i=a("0366"),r=a("7b0b"),s=a("9bdd"),n=a("e95a"),o=a("50c4"),u=a("8418"),c=a("35a1");t.exports=function(t){var e,a,l,d,p,m,h=r(t),v="function"==typeof this?this:Array,_=arguments.length,g=_>1?arguments[1]:void 0,f=void 0!==g,y=c(h),C=0;if(f&&(g=i(g,_>2?arguments[2]:void 0,2)),void 0==y||v==Array&&n(y))for(e=o(h.length),a=new v(e);e>C;C++)m=f?g(h[C],C):h[C],u(a,C,m);else for(d=y.call(h),p=d.next,a=new v;!(l=p.call(d)).done;C++)m=f?s(d,g,[l.value,C],!0):l.value,u(a,C,m);return a.length=C,a}},7012:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFkAAAAOCAYAAABEgLDgAAAAAXNSR0IArs4c6QAAAKtJREFUWAnt1FEKwyAQhOFYerBex1v0Fl7HnKyR4g8VxMwmj51AmJfZDX4Qt82PLFBKqe19yQO9mKID/9xvwJ9+/r3lO+dcFQ8jK0q984PMlIRtZLiEnCAztcQ2MkxCLpCZnmIbGR4hBWS2DNgpMMgCpy7wxX7ofTevCvi6CMgF/vrhungGvuHqucCAS93ISNzLKS4rjYzEtVzistLISMRSwmWlkZHQMoTLygPMOjzZRkfJYgAAAABJRU5ErkJggg=="},9485:function(t,e,a){t.exports=a.p+"static/img/nodata.8290bed9.png"},"99b4":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"data-process-wrap"},[i("div",{staticClass:"title"},[t._v(t._s(t.$t("profiling.minddataTitle")))]),i("el-tabs",{on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(e){t.activeName=e},expression:"activeName"}},[i("el-tab-pane",{attrs:{label:t.$t("profiling.queueInfo"),name:"queueInfo"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:!t.processSummary.noData,expression:"!processSummary.noData"}],staticClass:"data-process-top"},[i("div",{staticClass:"cell-container data-process"},[i("div",{staticClass:"title"},[t._v(" "+t._s(t.$t("profiling.pipeline"))+" ")])]),i("div",{staticClass:"queue-container"},[i("div",{staticClass:"img"},[i("div",{staticClass:"edge"},[i("img",{attrs:{src:a("7012")}})]),i("div",{staticClass:"icon"},[i("img",{attrs:{src:a("1b54"),clickKey:"connector_queue"},on:{click:function(e){return t.highlight("connector_queue")}}})]),i("div",{staticClass:"edge"},[i("img",{attrs:{src:a("7012")}})])]),i("div",{staticClass:"title"},[t._v(t._s(t.connectorQuene))]),i("div",{staticClass:"description"},[t.processSummary.device.empty||0===t.processSummary.device.empty?i("div",{staticClass:"item"},[t._v(" "+t._s(t.$t("profiling.queueTip2"))+" "),i("span",{staticClass:"num"},[t._v(" "+t._s(t.processSummary.device.empty)+"/"+t._s(t.processSummary.device.total)+" ")])]):t._e(),t.processSummary.device.full||0===t.processSummary.device.full?i("div",{staticClass:"item"},[t._v(" "+t._s(t.$t("profiling.queueTip1"))+" "),i("span",{staticClass:"num"},[t._v(" "+t._s(t.processSummary.device.full)+"/"+t._s(t.processSummary.device.total)+" ")])]):t._e()])]),i("div",{staticClass:"cell-container device_queue_op",style:{cursor:t.processSummary.count!==t.processSummary.maxCount?"default":"pointer"},attrs:{clickKey:"device_queue_op"},on:{click:function(e){return t.highlight("device_queue_op")}}},[i("div",{staticClass:"title"},[t._v(" "+t._s(t.$t("profiling.deviceQueueOp"))+" ")])]),i("div",{directives:[{name:"show",rawName:"v-show",value:t.processSummary.count===t.processSummary.maxCount,expression:"processSummary.count === processSummary.maxCount"}],staticClass:"queue-container"},[i("div",{staticClass:"img"},[i("div",{staticClass:"edge"},[i("img",{attrs:{src:a("7012")}})]),i("div",{staticClass:"icon"},[i("img",{attrs:{src:a("1b54"),clickKey:"data_queue"},on:{click:function(e){return t.highlight("data_queue")}}})]),i("div",{staticClass:"edge"},[i("img",{attrs:{src:a("7012")}})])]),i("div",{staticClass:"title"},[t._v(t._s(t.$t("profiling.dataQueue")))]),i("div",{staticClass:"description"},[t.processSummary.get_next.empty||0===t.processSummary.get_next.empty?i("div",{staticClass:"item"},[t._v(" "+t._s(t.$t("profiling.queueTip2"))+" "),i("span",{staticClass:"num"},[t._v(" "+t._s(t.processSummary.get_next.empty)+"/"+t._s(t.processSummary.get_next.total)+" ")])]):t._e(),t.processSummary.get_next.full||0===t.processSummary.get_next.full?i("div",{staticClass:"item"},[t._v(" "+t._s(t.$t("profiling.queueTip1"))+" "),i("span",{staticClass:"num"},[t._v(" "+t._s(t.processSummary.get_next.full)+"/"+t._s(t.processSummary.get_next.total)+" ")])]):t._e()])]),t.processSummary.count===t.processSummary.maxCount?i("div",{staticClass:"cell-container get-next",attrs:{clickKey:"get_next"},on:{click:function(e){return t.highlight("get_next")}}},[i("div",{staticClass:"title"},[t._v(" "+t._s(t.$t("profiling.getData"))+" ")])]):t._e()]),i("div",{directives:[{name:"show",rawName:"v-show",value:!t.processSummary.noData,expression:"!processSummary.noData"}],staticClass:"data-process-bottom"},[t.processSummary.count===t.processSummary.maxCount?i("div",{staticClass:"queue-step-wrap"},[i("div",{staticClass:"title"},[t._v(t._s(t.$t("profiling.queueStep")))]),i("div",{staticClass:"chart-content"},[i("div",{staticClass:"chart-wrap",class:{highlight:"connector_queue"===t.selected}},[i("div",{staticClass:"title"},[t._v(t._s(t.connectorQuene))]),t.connectQueueChart.noData?i("div",{staticClass:"image-noData"},[i("div",[i("img",{attrs:{src:a("9485")}})]),i("p",[t._v(t._s(t.connectQueueChart.initOver?t.$t("public.noData"):t.$t("public.dataLoading")))])]):[i("div",{staticClass:"data-tips"},[void 0!==t.connectQueueChart.queueSummary.empty_queue?i("div",[t._v(" "+t._s(t.$t("profiling.queueTip2"))+t._s(t.connectQueueChart.queueSummary.empty_queue)+" /"+t._s(t.connectQueueChart.size))]):t._e(),void 0!==t.connectQueueChart.queueSummary.full_queue?i("div",[t._v(" "+t._s(t.$t("profiling.queueTip1"))+t._s(t.connectQueueChart.queueSummary.full_queue)+" /"+t._s(t.connectQueueChart.size))]):t._e()]),i("div",{staticClass:"chart",attrs:{id:"connect-queue"}})]],2),i("div",{staticClass:"chart-wrap",class:{highlight:"data_queue"===t.selected}},[i("div",{staticClass:"title"},[t._v(t._s(t.$t("profiling.dataQueue")))]),t.dataQueueChart.noData?i("div",{staticClass:"image-noData"},[i("div",[i("img",{attrs:{src:a("9485")}})]),i("p",[t._v(t._s(t.dataQueueChart.initOver?t.$t("public.noData"):t.$t("public.dataLoading")))])]):[i("div",{staticClass:"data-tips"},[void 0!==t.dataQueueChart.queueSummary.empty_queue?i("div",[t._v(" "+t._s(t.$t("profiling.queueTip2"))+t._s(t.dataQueueChart.queueSummary.empty_queue)+" /"+t._s(t.dataQueueChart.size))]):t._e(),void 0!==t.dataQueueChart.queueSummary.full_queue?i("div",[t._v(" "+t._s(t.$t("profiling.queueTip1"))+t._s(t.dataQueueChart.queueSummary.full_queue)+" /"+t._s(t.dataQueueChart.size))]):t._e()]),i("div",{staticClass:"chart",attrs:{id:"data-queue"}})]],2)])]):t._e(),t.processSummary.count===t.processSummary.maxCount?i("div",{staticClass:"queue-step-wrap"},[i("div",{staticClass:"title"},[t._v(t._s(t.$t("profiling.operatorTimeConAnalysis")))]),i("div",{staticClass:"chart-content second"},[i("div",{staticClass:"chart-wrap analysis",class:{highlight:"device_queue_op"===t.selected}},[i("div",{staticClass:"title"},[t._v(t._s(t.$t("profiling.deviceQueueOp")))]),t.deviceQueueOpChart.noData?i("div",{staticClass:"image-noData"},[i("div",[i("img",{attrs:{src:a("9485")}})]),i("p",[t._v(t._s(t.deviceQueueOpChart.initOver?t.$t("public.noData"):t.$t("public.dataLoading")))])]):[i("div",{staticClass:"data-tips"},[void 0!==t.deviceQueueOpChart.timeSummary.avg_cost?i("div",[t._v(" "+t._s(t.$t("profiling.avgCost"))+t._s(t.deviceQueueOpChart.timeSummary.avg_cost)+"ms")]):t._e(),void 0!==t.deviceQueueOpChart.timeSummary.get_cost?i("div",[t._v(" "+t._s(t.$t("profiling.getCost"))+t._s(t.deviceQueueOpChart.timeSummary.get_cost)+"ms")]):t._e(),void 0!==t.deviceQueueOpChart.timeSummary.push_cost?i("div",[t._v(" "+t._s(t.$t("profiling.pushCost"))+t._s(t.deviceQueueOpChart.timeSummary.push_cost)+"ms")]):t._e()]),i("div",{staticClass:"chart",attrs:{id:"device_queue_op"}})]],2),i("div",{staticClass:"chart-wrap analysis",class:{highlight:"get_next"===t.selected}},[i("div",{staticClass:"title"},[t._v(t._s(t.$t("profiling.getNext")))]),t.getNextChart.noData?i("div",{staticClass:"image-noData"},[i("div",[i("img",{attrs:{src:a("9485")}})]),i("p",[t._v(t._s(t.getNextChart.initOver?t.$t("public.noData"):t.$t("public.dataLoading")))])]):[i("div",{staticClass:"data-tips"},[void 0!==t.getNextChart.timeSummary.avg_cost?i("div",[t._v(" "+t._s(t.$t("profiling.avgCost"))+t._s(t.getNextChart.timeSummary.avg_cost)+"ms")]):t._e(),void 0!==t.getNextChart.timeSummary.get_cost?i("div",[t._v(" "+t._s(t.$t("profiling.getCost"))+t._s(t.getNextChart.timeSummary.get_cost)+"ms")]):t._e(),void 0!==t.getNextChart.timeSummary.push_cost?i("div",[t._v(" "+t._s(t.$t("profiling.pushCost"))+t._s(t.getNextChart.timeSummary.push_cost)+"ms")]):t._e()]),i("div",{staticClass:"chart",attrs:{id:"get_next"}})]],2)])]):t._e(),t.processSummary.count!==t.processSummary.maxCount?i("div",{staticClass:"queue-step-wrap single"},[i("div",{staticClass:"title"},[t._v(t._s(t.$t("profiling.queueStep")))]),i("div",{staticClass:"chart-content"},[i("div",{staticClass:"chart-wrap",class:{highlight:"connector_queue"===t.selected}},[i("div",{staticClass:"title"},[t._v(t._s(t.connectorQuene))]),t.connectQueueChart.noData?t._e():[i("div",{staticClass:"data-tips"},[void 0!==t.connectQueueChart.queueSummary.empty_queue?i("div",[t._v(" "+t._s(t.$t("profiling.queueTip2"))+t._s(t.connectQueueChart.queueSummary.empty_queue)+" /"+t._s(t.connectQueueChart.size))]):t._e(),void 0!==t.connectQueueChart.queueSummary.full_queue?i("div",[t._v(" "+t._s(t.$t("profiling.queueTip1"))+t._s(t.connectQueueChart.queueSummary.full_queue)+" /"+t._s(t.connectQueueChart.size))]):t._e()]),i("div",{staticClass:"chart",attrs:{id:"connect-queue"}})]],2)])]):t._e()]),t.processSummary.noData?i("div",{staticClass:"image-noData"},[i("div",[i("img",{attrs:{src:a("9485")}})]),i("p",[t._v(t._s(t.initOver?t.$t("public.noData"):t.$t("public.dataLoading")))])]):t._e()]),i("el-tab-pane",{attrs:{label:t.$t("profiling.pipeline"),name:"pipeLine"}},[i("div",{directives:[{name:"show",rawName:"v-show",value:!t.pipeData,expression:"!pipeData"}],staticClass:"pipeline-wrap"},[i("div",{staticClass:"pipeline-top"},[i("div",{staticClass:"pipeline-top-title"},[t._v(" "+t._s(t.$t("profiling.pipelineTopTitle"))+" ")]),i("div",{staticClass:"average-rate-wrap"},[i("div",{attrs:{id:"average-rate"}})])]),i("div",{staticClass:"pipeline-middle"},[i("div",{staticClass:"pipeline-middle-title"},[t._v(" "+t._s(t.$t("profiling.pipelineMiddleTitle"))+" ")]),i("div",{staticClass:"operator-graph"},[i("div",{attrs:{id:"graph"}})])]),i("div",{staticClass:"pipeline-bottom"},[i("div",{staticClass:"queue-deep-wrap"},[i("div",{staticClass:"left"},[i("div",{attrs:{id:"queue-deep"}})]),i("div",{staticClass:"right"},[i("div",{staticClass:"title"},[t._v(t._s(t.$t("profiling.operatorInfo",{msg1:t.current_op.name,msg2:t.parent_op.name})))]),i("div",{staticClass:"item-wrap"},[i("div",{staticClass:"item"},[i("span",[t._v(t._s(t.current_op.name)+" ID:")]),t._v(t._s(t.current_op.op_id))]),i("div",{staticClass:"item"},[i("span",[t._v(t._s(t.current_op.name)+" type:")]),t._v(t._s(t.current_op.op_type))]),i("div",{staticClass:"item"},[i("span",[t._v(t._s(t.current_op.name)+" "+t._s(t.$t("profiling.workersNum"))+":")]),t._v(" "+t._s(t.current_op.num_workers)+" ")]),i("div",{staticClass:"item"},[i("span",[t._v(t._s(t.parent_op.name)+" ID:")]),t._v(t._s(t.parent_op.op_id))]),i("div",{staticClass:"item"},[i("span",[t._v(t._s(t.parent_op.name)+" type:")]),t._v(t._s(t.parent_op.op_type))]),i("div",{staticClass:"item"},[i("span",[t._v(t._s(t.parent_op.name)+" "+t._s(t.$t("profiling.workersNum"))+":")]),t._v(" "+t._s(t.parent_op.num_workers)+" ")])])])])])]),t.pipeData?i("div",{staticClass:"image-noData"},[i("div",[i("img",{attrs:{src:a("9485")}})]),i("p",[t._v(t._s(t.initOver?t.$t("public.noData"):t.$t("public.dataLoading")))])]):t._e()])],1)],1)},r=[],s=(a("99af"),a("4de4"),a("4160"),a("a630"),a("c975"),a("a15b"),a("d81d"),a("b0c0"),a("b680"),a("b64b"),a("ac1f"),a("3ca3"),a("1276"),a("498a"),a("159b"),a("313e")),n=a.n(s),o=a("3778"),u=a("5698"),c=a("0165"),l=(a("6d21"),{select:u["d"],selectAll:u["e"],zoom:u["f"]}),d={props:{},data:function(){return{dir:"",currentCard:"",connectQueueChart:{id:"connect-queue",chartDom:null,data:[],queueSummary:{},advise:"",type:0,params:"device_queue",noData:!0,size:null,deviceId:null,initOver:!1},dataQueueChart:{id:"data-queue",chartDom:null,data:[],queueSummary:{},advise:"",type:0,params:"get_next",noData:!0,size:null,initOver:!1},deviceQueueOpChart:{id:"device_queue_op",chartDom:null,data:[],timeSummary:{},type:1,params:"device_queue",noData:!0,initOver:!1},getNextChart:{id:"get_next",chartDom:null,data:[],timeSummary:{},type:1,params:"get_next",noData:!0,initOver:!1},processSummary:{noData:!0,count:6,maxCount:6,device:{empty:0,full:0,total:0},get_next:{empty:0,full:0,total:0}},activeName:"queueInfo",averageRateChart:{id:"average-rate",chartDom:null,deviceId:null},queueDeepChart:{id:"queue-deep",chartDom:null},current_op:{},parent_op:{},pipeData:!0,initOver:!1,allGraphData:{},graphviz:null,totalMemory:33554432,scaleRange:[1e-4,1e4],initQueue:"",trainId:"",selected:"",connectorQuene:""}},watch:{"$parent.curDashboardInfo.curCardNum":{handler:function(t,e){(t||0===t)&&(this.dir=this.$route.query.dir,this.trainId=this.$route.query.id,this.currentCard=t,this.trainId?document.title="".concat(decodeURIComponent(this.trainId))+"-".concat(this.$t("profiling.mindData"),"-MindInsight"):document.title="".concat(this.$t("profiling.mindData"),"-MindInsight"),"queueInfo"===this.activeName?(this.initOver=!1,this.init()):this.queryAverageRate()),"queueInfo"===this.activeName&&this.$parent.curDashboardInfo.initOver&&(this.initOver=!0)},deep:!0,immediate:!0}},computed:{},mounted:function(){var t=this;window.addEventListener("resize",this.debounce(this.resizeCallback,200),!1),setTimeout((function(){t.$bus.$on("collapse",t.debounce(t.resizeCallback,200))}),500)},methods:{debounce:function(t,e){var a=null;return function(){a&&clearTimeout(a),a=setTimeout(t,e)}},handleClick:function(){var t=this;"pipeLine"===this.activeName&&this.averageRateChart.deviceId!==this.currentCard?this.queryAverageRate():"queueInfo"===this.activeName&&this.connectQueueChart.deviceId!==this.currentCard&&this.init(),this.$nextTick((function(){t.resizeCallback()}))},init:function(){this.connectorQuene=this.$t("profiling.connectorQuene"),this.queryProcessSummary()},resizeCallback:function(){var t=this,e=["connectQueueChart","dataQueueChart","deviceQueueOpChart","getNextChart","averageRateChart","queueDeepChart"];e.forEach((function(e){t[e].chartDom&&setTimeout((function(){t[e].chartDom.resize()}),300)}))},queryMinddataOp:function(t){var e=this,a={profile:this.dir,device_id:this.currentCard,type:t.params,train_id:this.trainId};o["a"].minddataOp(a).then((function(a){if(a&&a.data){t.initOver=!0;var i=a.data;t.data=i.info,i.summary&&(t.timeSummary=i.summary.time_summary||{},Object.keys(t.timeSummary).forEach((function(e){t.timeSummary[e]=parseFloat(t.timeSummary[e]).toFixed(3)}))),t.advise=i.advise,i.size>0?(t.noData=!1,e.$nextTick((function(){e.setOption(t)}))):(t.chartDom&&t.chartDom.clear(),t.noData=!0)}}),(function(e){t.chartDom&&t.chartDom.clear(),t.initOver=!0,t.noData=!0}))},queryQueueInfo:function(t){var e=this,a={profile:this.dir,device_id:this.currentCard,type:t.params,train_id:this.trainId};o["a"].queueInfo(a).then((function(a){if(a&&a.data){t.initOver=!0;var i=a.data;t.data=i.info,i.summary&&(t.queueSummary=i.summary.queue_summary||{}),t.advise=i.advise,i.size>0?(t.noData=!1,t.size=i.size,e.$nextTick((function(){e.setOption(t)}))):(t.chartDom&&t.chartDom.clear(),t.noData=!0)}}),(function(e){t.initOver=!0,t.noData=!0,t.chartDom&&t.chartDom.clear()}))},setOption:function(t){var e=n.a.init(document.getElementById(t.id)),a={tooltip:{trigger:"axis",confine:!0},toolbox:{show:!0},xAxis:{name:"step",data:[]},yAxis:{},series:[],grid:{left:50,top:20,right:50,bottom:60},dataZoom:[{start:0,end:100,bottom:0},{start:0,end:100,type:"inside",bottom:0}]},i=[];Object.keys(t.data).forEach((function(e,a){var r={type:"line"};if(r.data=t.data[e],r.name=e,0===t.type){var s=[];r.data.forEach((function(t,e){0===t&&s.push({xAxis:e,yAxis:t,symbolSize:20})})),r.markPoint={data:s}}i.push(r)})),a.series=i,a.xAxis.data=t.data[Object.keys(t.data)[0]].map((function(t,e){return e+1})),e.setOption(a),t.chartDom=e,this.connectQueueChart.chartDom&&this.deviceQueueOpChart.chartDom&&n.a.connect([this.connectQueueChart.chartDom,this.deviceQueueOpChart.chartDom]),this.getNextChart.chartDom&&this.dataQueueChart.chartDom&&n.a.connect([this.getNextChart.chartDom,this.dataQueueChart.chartDom])},queryProcessSummary:function(){var t=this,e={profile:this.dir,device_id:this.currentCard,train_id:this.trainId};this.connectQueueChart.deviceId=this.currentCard,this.initOver=!1,o["a"].queryProcessSummary(e).then((function(e){if(e&&e.data){var a=JSON.parse(JSON.stringify(e.data));t.processSummary.count=Object.keys(a).length,t.processSummary.count?(t.dealProcess(a),t.$nextTick((function(){t.processSummary.count<t.processSummary.maxCount?(t.queryQueueInfo(t.connectQueueChart),t.dataQueueChart.noData=!1,t.deviceQueueOpChart.noData=!1,t.getNextChart.noData=!1):(t.queryQueueInfo(t.connectQueueChart),t.queryQueueInfo(t.dataQueueChart),t.queryMinddataOp(t.deviceQueueOpChart),t.queryMinddataOp(t.getNextChart))}))):t.dealProcess(null)}else t.dealProcess(null)}),(function(e){t.dealProcess(null)}))},dealProcess:function(t){this.processSummary.device={empty:0,full:0,total:0},this.processSummary.get_next={empty:0,full:0,total:0},this.processSummary.noData=!0,this.initOver=!0,t&&(t.device_queue_info&&t.device_queue_info.summary&&(this.processSummary.device={empty:t.device_queue_info.summary.empty_batch_count,full:t.device_queue_info.summary.full_batch_count,total:t.device_queue_info.summary.total_batch}),t.get_next_queue_info&&t.get_next_queue_info.summary&&(this.processSummary.get_next={empty:t.get_next_queue_info.summary.empty_batch_count,full:t.get_next_queue_info.summary.full_batch_count,total:t.get_next_queue_info.summary.total_batch}),this.processSummary.noData=!1)},queryAverageRate:function(){var t=this,e={params:{train_id:this.trainId,profile:this.dir},body:{device_id:this.currentCard}};this.averageRateChart.deviceId=this.currentCard,this.initOver=!1,o["a"].queryOpQueue(e).then((function(e){if(t.initOver=!0,e&&e.data){t.removeGraph();var a=JSON.parse(JSON.stringify(e.data));if(t.dealPipeLineData(a),t.pipeData=!(e.data.object&&e.data.object.length),e.data.object&&e.data.object.length&&e.data.col_name){var i=e.data.object.map((function(t){var a={};return e.data.col_name.forEach((function(e,i){a[e]=t[i]})),a})),r=i.sort((function(t,e){return t.output_queue_usage_rate-e.output_queue_usage_rate})).filter((function(t){return null!==t.parent_id})),s=r.map((function(t){return(100*t.output_queue_usage_rate).toFixed(4)})),o=r.map((function(t){return"Queue_".concat(t.op_id)})),u=t.$t("profiling"),c={tooltip:{trigger:"axis",axisPointer:{type:"shadow"},confine:!0,formatter:function(t){var e={};return r.forEach((function(a){"".concat(a.op_id)===t[0].axisValue.split("")[6]&&(e=a)})),"".concat(t[0].axisValue,"<br>").concat(t[0].marker)+"".concat(u.averageCapacity,"：").concat(e.output_queue_average_size,"<br>")+"".concat(t[0].marker).concat(u.totalCapacity,"：")+"".concat(e.output_queue_length)}},grid:{left:70,top:20,right:100,bottom:50},xAxis:{type:"value",boundaryGap:[0,.01],max:100,axisLabel:{formatter:function(t){return"".concat(t,"%")}}},yAxis:{type:"category",data:o},series:[{type:"bar",data:s,itemStyle:{color:"#00a5a7"},label:{show:!0,position:"right",color:"#000",formatter:function(t){return"".concat(t.value,"%")}}}],dataZoom:[{start:0,end:100,orient:"vertical",right:10},{start:0,end:100,type:"inside",orient:"vertical",right:10}]};t.$nextTick((function(){var e=n.a.init(document.getElementById(t.averageRateChart.id));e.setOption(c),t.averageRateChart.chartDom=e}))}}}),(function(){t.initOver=!0,t.pipeData=!0,t.removeGraph()}))},queryQueue:function(t){var e=this,a={profile:this.dir,train_id:this.trainId,device_id:this.currentCard,op_id:t};o["a"].queryQueue(a).then((function(a){if(a&&a.data){var i=a.data.queue_info,r=i.output_queue_size;e.current_op=a.data.current_op||{},e.parent_op=a.data.parent_op||{},e.current_op.name="".concat(e.current_op.op_type,"_").concat(e.current_op.op_id),e.parent_op.name="".concat(e.parent_op.op_type,"_").concat(e.parent_op.op_id);var s={title:{text:e.$t("profiling.queueDeepChartTitle",{msg:"Queue".concat(t)}),textStyle:{fontSize:13},left:20,top:10},tooltip:{trigger:"axis",confine:!0},xAxis:{name:"".concat(e.$t("profiling.sampleInterval"),"/").concat(i.sample_interval,"ms").split(" ").join("\n"),data:r.map((function(t,e){return e+1}))},yAxis:{name:""},series:[{type:"line",data:r,itemStyle:{color:"#00a5a7"}}],grid:{left:50,top:40,right:100,bottom:60},dataZoom:[{start:0,end:100,bottom:10},{start:0,end:100,type:"inside",bottom:10}]};e.$nextTick((function(){var t=n.a.init(document.getElementById(e.queueDeepChart.id));t.setOption(s),e.queueDeepChart.chartDom=t}))}}))},highlight:function(t){if("device_queue_op"!==t||this.processSummary.count===this.processSummary.maxCount){var e=document.querySelectorAll(".data-process-top *[clickKey]");Array.prototype.forEach.call(e,(function(e){e.getAttribute("clickKey")===t?e.classList.add("selected"):e.classList.remove("selected")})),this.selected=t}},dealPipeLineData:function(t){var e=this,a=t.col_name,i=a.length,r=t.object;if(r.forEach((function(t){if(t&&t.length===i){var r={output:""};if(a.forEach((function(e,a){r[e]=t[a]})),r.op_id||0===r.op_id){if(r.key="".concat(r.op_id,"_operator"),r.parent_id||0===r.parent_id){var s="".concat(r.op_id,"_queue");r.output=s;var n=JSON.parse(JSON.stringify(r));n.key=s,n.op_type="queue",n.output="".concat(r.parent_id,"_operator"),e.allGraphData[s]=n,e.initQueue||0===e.initQueue||(e.initQueue=n.op_id)}e.allGraphData[r.key]=r}}})),Object.keys(this.allGraphData).length){var s=this.packageGraphData();this.initGraph(s)}else this.removeGraph()},packageGraphData:function(){var t=this,e="",a="";Object.keys(this.allGraphData).forEach((function(i){var r=t.allGraphData[i];e+="<".concat(i,'>[id="').concat(i,'";')+"".concat("queue"===r.op_type?'shape=rect;class="queue";label="Queue_'.concat(r.op_id,"(").concat(parseFloat((100*(r.output_queue_usage_rate||0)).toFixed(4)),'%)";'):'shape=Mrecord;class="operator";label="'.concat(r.op_type,"_").concat(r.op_id,'";'),"];"),r.output&&(a+="<".concat(r.key,">-><").concat(r.output,">"))}));var i='node[style="filled";fontsize="10px"];edge[fontsize="6px";];';return"digraph {compound=true;rankdir=LR;".concat(i).concat(e).concat(a,"}")},initGraph:function(t){this.graphviz=l.select("#graph").graphviz({useWorker:!1,totalMemory:this.totalMemory}).zoomScaleExtent(this.scaleRange).dot(t).attributer(this.attributer).render(this.startApp)},attributer:function(t,e,a){if("svg"===t.tag){var i="100%",r="100%";t.attributes.width=i,t.attributes.height=r}},startApp:function(){var t=this;setTimeout((function(){t.graphviz&&(t.graphviz._data=null,t.graphviz._dictionary=null,t.graphviz=null)}),500),l.select("#graph").selectAll(".operator>title").remove();for(var e=Array.from(document.querySelectorAll("#graph .queue")),a=0,i=e.length;a<i;a++){var r=e[a],s=this.allGraphData[r.id];if(s){var n=r.querySelector("polygon"),o="rgba(19, 171, 173, ".concat(s.output_queue_usage_rate,")");n.setAttribute("fill",o),n.setAttribute("stroke",o);var u=r.querySelector("title");u.textContent="".concat(this.$t("profiling.averageCapacity"),":").concat(s.output_queue_average_size||0,"\n")+"".concat(this.$t("profiling.totalCapacity"),":").concat(s.output_queue_length||0)}}this.initZooming();var c=l.selectAll("g.queue");c.on("click",(function(e,a,i){var r=i[a];c.classed("selected",!1),l.select('g[id="'.concat(r.id,'"]')).classed("selected",!0);var s=t.allGraphData[r.id];s&&t.queryQueue(s.op_id)})),l.select('g[id="'.concat(this.initQueue,'_queue"]')).classed("selected",!0),this.queryQueue(this.initQueue)},initZooming:function(){var t=this,e=document.querySelector("#graph svg"),a=e.getBoundingClientRect(),i=document.querySelector("#graph #graph0"),r=i.getBBox(),s=i.getBoundingClientRect(),n={},o=Math.min(a.width/2/s.width,a.height/2/s.height),u=4,d=20,p={start:{x:0,y:0},end:{x:0,y:0}},m=l.zoom().on("start",(function(){var t=c["c"].sourceEvent;p.start.x=t.x,p.start.y=t.y})).on("zoom",(function(){var e=c["c"].sourceEvent,s=t.getTransformData(i);Object.keys(n).length||(n={x:s.translate[0],y:s.translate[1],k:s.scale[0]});var l="",m={},h=s.scale[0],v=i.getBoundingClientRect(),_=r.width/v.width;if("mousemove"===e.type){p.end.x=e.x,p.end.y=e.y;var g=p.end.x-p.start.x,f=p.end.y-p.start.y,y=Math.max(u/_*h,d);v.left+y+g>=a.left+a.width&&(g=Math.min(g,0)),v.left+v.width-y+g<=a.left&&(g=Math.max(g,0)),v.top+y+f>=a.top+a.height&&(f=Math.min(f,0)),v.top+v.height-y+f<=a.top&&(f=Math.max(f,0)),m={x:g*_*h,y:f*_*h},p.start.x=p.end.x,p.start.y=p.end.y}else if("wheel"===e.type){var C=-e.deltaY,q=1.2;h=C>0?s.scale[0]*q:s.scale[0]/q,h=Math.max(t.scaleRange[0],h,o),h=Math.min(t.scaleRange[1],h),m={x:(v.x+u/_-e.x)*_*(h-s.scale[0]),y:(v.bottom-u/_-e.y)*_*(h-s.scale[0])}}n={x:s.translate[0]+m.x,y:s.translate[1]+m.y,k:h},l="translate(".concat(n.x,",").concat(n.y,") scale(").concat(n.k,")"),i.setAttribute("transform",l),e.stopPropagation(),e.preventDefault()})),h=l.select("#graph svg");h.on(".zoom",null),h.call(m),h.on("dblclick.zoom",null),h.on("wheel.zoom",null);var v=l.select("#graph #graph0");v.on(".zoom",null),v.call(m)},getTransformData:function(t){if(!t)return[];var e=t.getAttribute("transform"),a={};if(e){var i=e.trim().split(" ");i.forEach((function(t){var e=t.indexOf("("),i=t.indexOf(")"),r=t.substring(0,e),s=t.substring(e+1,i).split(",").map((function(t){return parseFloat(t)||0}));a[r]=s}))}return a},removeGraph:function(){var t=document.querySelector("#graph svg");t&&t.remove(),this.allGraphData={}}},destroyed:function(){window.removeEventListener("resize",this.debounce(this.resizeCallback,200),!1),this.$bus.$off("collapse")}},p=d,m=(a("2a4b"),a("2877")),h=Object(m["a"])(p,i,r,!1,null,null,null);e["default"]=h.exports},a263:function(t,e,a){},a630:function(t,e,a){var i=a("23e7"),r=a("4df4"),s=a("1c7e"),n=!s((function(t){Array.from(t)}));i({target:"Array",stat:!0,forced:n},{from:r})},b0c0:function(t,e,a){var i=a("83ab"),r=a("9bf2").f,s=Function.prototype,n=s.toString,o=/^\s*function ([^ (]*)/,u="name";i&&!(u in s)&&r(s,u,{configurable:!0,get:function(){try{return n.call(this).match(o)[1]}catch(t){return""}}})},b680:function(t,e,a){"use strict";var i=a("23e7"),r=a("a691"),s=a("408a"),n=a("1148"),o=a("d039"),u=1..toFixed,c=Math.floor,l=function(t,e,a){return 0===e?a:e%2===1?l(t,e-1,a*t):l(t*t,e/2,a)},d=function(t){var e=0,a=t;while(a>=4096)e+=12,a/=4096;while(a>=2)e+=1,a/=2;return e},p=u&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!o((function(){u.call({})}));i({target:"Number",proto:!0,forced:p},{toFixed:function(t){var e,a,i,o,u=s(this),p=r(t),m=[0,0,0,0,0,0],h="",v="0",_=function(t,e){var a=-1,i=e;while(++a<6)i+=t*m[a],m[a]=i%1e7,i=c(i/1e7)},g=function(t){var e=6,a=0;while(--e>=0)a+=m[e],m[e]=c(a/t),a=a%t*1e7},f=function(){var t=6,e="";while(--t>=0)if(""!==e||0===t||0!==m[t]){var a=String(m[t]);e=""===e?a:e+n.call("0",7-a.length)+a}return e};if(p<0||p>20)throw RangeError("Incorrect fraction digits");if(u!=u)return"NaN";if(u<=-1e21||u>=1e21)return String(u);if(u<0&&(h="-",u=-u),u>1e-21)if(e=d(u*l(2,69,1))-69,a=e<0?u*l(2,-e,1):u/l(2,e,1),a*=4503599627370496,e=52-e,e>0){_(0,a),i=p;while(i>=7)_(1e7,0),i-=7;_(l(10,i,1),0),i=e-1;while(i>=23)g(1<<23),i-=23;g(1<<i),_(1,1),g(2),v=f()}else _(0,a),_(1<<-e,0),v=f()+n.call("0",p);return p>0?(o=v.length,v=h+(o<=p?"0."+n.call("0",p-o)+v:v.slice(0,o-p)+"."+v.slice(o-p))):v=h+v,v}})}}]);