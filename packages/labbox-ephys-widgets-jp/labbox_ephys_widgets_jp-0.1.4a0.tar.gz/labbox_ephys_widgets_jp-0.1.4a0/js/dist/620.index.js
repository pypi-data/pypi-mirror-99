(self.webpackChunklabbox_ephys_widgets_jp=self.webpackChunklabbox_ephys_widgets_jp||[]).push([[620],{71866:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var i=n(83334),s=n(53167),l=n(69297),r=n.n(l);const c=({job:e,message:t="",width:n=200,height:l=200})=>e?r().createElement(i.Z,{display:"flex",width:n,height:l},r().createElement(i.Z,{m:"auto"},"running"===e.status?r().createElement("span",null,"[",t,"] ",r().createElement(s.Z,null)):"error"===e.status?r().createElement("span",null,"Error: ",e.error_message," [",t,"]"):"pending"===e.status?r().createElement("span",null,t):r().createElement("span",null,"[",t,"] ",e.status))):r().createElement("div",null,"No job")},90667:(e,t,n)=>{"use strict";n.d(t,{Z:()=>a});var i=n(81459),s=n(95898),l=n(69297),r=n.n(l),c=n(95849),o=n(10051);const a=({sorting:e,selection:t,selectionDispatch:n,unitComponent:a})=>{const[d,u]=(0,l.useState)(30),h=(0,o.D)(e.sortingObject,e.recordingObject),p=t.visibleUnitIds;let g=(h?h.unit_ids:[]).filter((e=>!p||p.includes(e))).filter((n=>!t.applyMerges||(0,c.GI)(n,e.curation))),m=!1;g.length>d&&(g=g.slice(0,d),m=!0);const b=(0,l.useCallback)((e=>{const t=Number(e.currentTarget.dataset.unitId);n({type:"UnitClicked",unitId:t,ctrlKey:e.ctrlKey,shiftKey:e.shiftKey})}),[n]);return r().createElement(i.Z,{container:!0},g.map((e=>{var n;return r().createElement(i.Z,{key:e,item:!0},r().createElement("div",{className:"plotWrapperStyle"},r().createElement("div",{"data-unit-id":e,className:(null===(n=t.selectedUnitIds)||void 0===n?void 0:n.includes(e))?"plotSelectedStyle":"plotUnselectedStyle",onClick:b},r().createElement("div",{className:"plotUnitLabel"},r().createElement("div",null,"Unit ",e)),a(e))))})),m&&r().createElement("div",{className:"plotWrapperStyle"},r().createElement("div",{className:"plotWrapperStyleButton"},r().createElement(s.Z,{onClick:()=>{u(d+60)}},"Show more units"))))}},3527:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c});var i=n(69297),s=n.n(i),l=n(31315),r=n.n(l);const c=e=>{var t,n,l;const{width:c,height:o,initialPosition:a,onChange:d,adjustable:u=!0,positionFromRight:h=!1}=e,[p,g]=(0,i.useState)(a);if(!e.children)throw Error("Unexpected: no props.children");let m,b;if(Array.isArray(e.children)){const t=e.children.filter((e=>void 0!==e));m=t[0],b=t[1]||null}else m=e.children,b=null;if(!b)return s().createElement(m.type,Object.assign({},m.props,{width:c,height:o}));const E=h?c-p:p,y=u?null!==(t=e.gripThickness)&&void 0!==t?t:10:0,v=u?null!==(n=e.gripInnerThickness)&&void 0!==n?n:4:0,j=u?null!==(l=e.gripMargin)&&void 0!==l?l:2:0,w=E-y/2-j,f=c-w-y-2*j;let O={top:0,left:0,width:c,height:o},I={left:0,top:0,width:w,height:o,zIndex:0,overflowY:"auto",overflowX:"hidden"},k={left:w+y+2*j,top:0,width:f,height:o,zIndex:0,overflowY:"auto",overflowX:"hidden"},C={left:0,top:0,width:y+2*j,height:o,backgroundColor:"transparent",cursor:"col-resize",zIndex:9998},S={left:j,top:0,width:y,height:o,background:"rgb(230, 230, 230)",cursor:"col-resize"},Z={top:0,left:(y-v)/2,width:v,height:o,background:"gray",cursor:"col-resize"};return s().createElement("div",{className:"splitter",style:Object.assign(Object.assign({},O),{position:"relative"})},s().createElement("div",{key:"child1",style:Object.assign(Object.assign({},I),{position:"absolute"}),className:"SplitterChild"},s().createElement(m.type,Object.assign({},m.props,{width:w,height:o}))),u&&s().createElement(r(),{key:"drag",position:{x:E-y/2-j,y:0},axis:"x",onDrag:(e,t)=>{},onStop:(e,t)=>((e,t)=>{const n=t.x;if(n===E)return;const i=h?c-n:n;g(i),d&&d(i)})(0,t)},s().createElement("div",{style:Object.assign(Object.assign({},C),{position:"absolute"})},s().createElement("div",{style:Object.assign(Object.assign({},S),{position:"absolute"})},s().createElement("div",{style:Object.assign(Object.assign({},Z),{position:"absolute"})})))),s().createElement("div",{key:"child2",style:Object.assign(Object.assign({},k),{position:"absolute"}),className:"SplitterChild"},s().createElement(b.type,Object.assign({},b.props,{width:f,height:o}))))}},1620:(e,t,n)=>{"use strict";n.r(t),n.d(t,{activate:()=>j});var i=n(72792),s=n(69297),l=n.n(s),r=n(90667),c=n(5443),o=n(45810),a=n(71866),d=n(95849);const u=(0,c.zy)({maxSimultaneous:6}),h=({sorting:e,unitId1:t,unitId2:n,selection:i,selectionDispatch:s,width:r,height:h})=>{const{result:p,job:g}=(0,c.lG)("createjob_fetch_correlogram_plot_data",{sorting_object:e.sortingObject,unit_x:(0,d.kN)(t,e.curation,i.applyMerges),unit_y:void 0!==n?(0,d.kN)(n,e.curation,i.applyMerges):null},{useClientCache:!1,calculationPool:u});if(!p)return l().createElement(a.Z,{job:g,width:r,height:h});const m=p.bins.map(((e,t)=>({x:e,y:p.bin_counts[t]})));return l().createElement("div",{className:"App"},l().createElement(o.dp,{margin:30,height:h,width:r},l().createElement(o.XQ,{data:m,barWidth:1}),l().createElement(o.Kc,null),l().createElement(o.B2,null)),l().createElement("div",{style:{textAlign:"center",fontSize:"12px"}},"dt (msec)"))},p=({sorting:e,selection:t,selectionDispatch:n})=>{const i=(0,s.useMemo)((()=>i=>l().createElement(h,Object.assign({},{sorting:e,unitId1:i,selection:t,selectionDispatch:n},{width:180,height:180}))),[e,t,n]);return l().createElement(r.Z,{sorting:e,selection:t,selectionDispatch:n,unitComponent:i})};var g=n(3527),m=n(86729),b=n(81459);const E=({sorting:e,selection:t,selectionDispatch:n,unitIds:i,unitPairComponent:s})=>l().createElement(b.Z,{container:!0,spacing:0},i.map((e=>l().createElement(b.Z,{container:!0,key:e},i.map((t=>l().createElement(b.Z,{key:t,item:!0},l().createElement("div",{className:"plotWrapperStyle"},l().createElement("div",{"data-unit-id1":e,"data-unit-id2":t},l().createElement("div",{className:"plotUnitLabel"},l().createElement("div",null,"Units ",e," vs ",t)),s(e,t)))))))))),y=({sorting:e,selection:t,selectionDispatch:n,unitIds:i,width:r,height:c})=>{const o=i.length||1,a=Math.min(220,(r-10*(o+1))/o),d=a,u=(0,s.useMemo)((()=>(i,s)=>l().createElement(h,{sorting:e,selection:t,selectionDispatch:n,unitId1:i,unitId2:s,width:a,height:d})),[e,t,n,a,d]);return l().createElement(E,{sorting:e,selection:t,selectionDispatch:n,unitIds:i,unitPairComponent:u})},v=({sorting:e,selection:t,selectionDispatch:n,width:i,height:r})=>{const[c,o]=((e,t)=>{const[n,i]=(0,s.useState)([]);return[(0,s.useMemo)((()=>Object.assign(Object.assign({},e),{selectedUnitIds:n})),[n,e]),(0,s.useMemo)((()=>e=>{"SetSelectedUnitIds"===e.type?i(e.selectedUnitIds):t(e)}),[t])]})(t,n);return l().createElement(g.Z,{width:i||600,height:r||900,initialPosition:200},l().createElement(m.Z,{sorting:e,selection:c,selectionDispatch:o}),l().createElement(y,Object.assign({sorting:e,selection:c,selectionDispatch:o,unitIds:c.selectedUnitIds||[]},{width:0,height:0})))};function j(e){e.registerPlugin({type:"SortingView",name:"Autocorrelograms",label:"Autocorrelograms",priority:50,component:p,icon:l().createElement(i.Z,null),singleton:!0}),e.registerPlugin({type:"SortingView",name:"CrossCorrelograms",label:"Cross-Correlograms",component:v,icon:l().createElement(i.Z,null),singleton:!1})}},86729:(e,t,n)=>{"use strict";n.d(t,{Z:()=>o});var i=n(69297),s=n.n(i),l=n(10051),r=n(95849),c=n(3940);const o=({sorting:e,selection:t,selectionDispatch:n})=>{const i=(0,l.D)(e.sortingObject,e.recordingObject);if(!i)return s().createElement("div",null,"No sorting info");const o=((null==i?void 0:i.unit_ids)||[]).filter((n=>!t.applyMerges||(0,r.GI)(n,e.curation)));return s().createElement(c.Z,Object.assign({units:o},{selection:t,selectionDispatch:n,sorting:e}))}}}]);