
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>intelmq.bots.experts.threshold package &#8212; intelmq 3.0.0.alpha.1 documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="section" id="intelmq-bots-experts-threshold-package">
<h1>intelmq.bots.experts.threshold package<a class="headerlink" href="#intelmq-bots-experts-threshold-package" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-intelmq.bots.experts.threshold.expert">
<span id="intelmq-bots-experts-threshold-expert-module"></span><h2>intelmq.bots.experts.threshold.expert module<a class="headerlink" href="#module-intelmq.bots.experts.threshold.expert" title="Permalink to this headline">¶</a></h2>
<p>Threshold value expert bot</p>
<p>SPDX-FileCopyrightText: 2020 Linköping University &lt;<a class="reference external" href="https://liu.se/">https://liu.se/</a>&gt;
SPDX-License-Identifier: AGPL-3.0-or-later</p>
<p>Given a stream of messages, this bot will let through only the single
one that makes the count of similar messages go above a threshold
value.</p>
<p>This bot is not multiprocessing safe. Do not run more than one
instance on the same Redis cache database.</p>
<dl class="field-list simple">
<dt class="field-odd">param redis_cache_host</dt>
<dd class="field-odd"><p>string</p>
</dd>
<dt class="field-even">param redis_cache_port</dt>
<dd class="field-even"><p>int</p>
</dd>
<dt class="field-odd">param redis_cache_db</dt>
<dd class="field-odd"><p>int</p>
</dd>
<dt class="field-even">param redis_cache_password</dt>
<dd class="field-even"><p>string.  default: {None}</p>
</dd>
<dt class="field-odd">param filter_type</dt>
<dd class="field-odd"><p>string [“whitelist”, “blacklist”], when determining
whether two messages are similar, consider either
only the named fields, or all but the named fields
(time.observation is always ignored).</p>
</dd>
<dt class="field-even">param bypass</dt>
<dd class="field-even"><p>boolean default: False</p>
</dd>
<dt class="field-odd">param filter_keys</dt>
<dd class="field-odd"><p>list of strings, keys to exclude or include when
determining whether messages are similar.
time.observation is always ignored.</p>
</dd>
<dt class="field-even">param threshold</dt>
<dd class="field-even"><p>int, number of messages after which one is sent on. As
long as the count is above the threshold, no new
messages will be sent.</p>
</dd>
<dt class="field-odd">param timeout</dt>
<dd class="field-odd"><p>int, number of seconds to keep counts of similar
messages. After this many seconds have elapsed, the count
is deleted and “threshold” number of new messages will
result in a new message being sent.</p>
</dd>
<dt class="field-even">param add_keys</dt>
<dd class="field-even"><p>optional, array of strings to strings, keys to add to
forwarded messages. Regardless of this setting, the
field “extra.count” will be set to the number of
messages seen (which will be the threshold value).</p>
</dd>
</dl>
<dl class="py attribute">
<dt id="intelmq.bots.experts.threshold.expert.BOT">
<code class="sig-prename descclassname">intelmq.bots.experts.threshold.expert.</code><code class="sig-name descname">BOT</code><a class="headerlink" href="#intelmq.bots.experts.threshold.expert.BOT" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <a class="reference internal" href="#intelmq.bots.experts.threshold.expert.ThresholdExpertBot" title="intelmq.bots.experts.threshold.expert.ThresholdExpertBot"><code class="xref py py-class docutils literal notranslate"><span class="pre">intelmq.bots.experts.threshold.expert.ThresholdExpertBot</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt id="intelmq.bots.experts.threshold.expert.ThresholdExpertBot">
<em class="property">class </em><code class="sig-prename descclassname">intelmq.bots.experts.threshold.expert.</code><code class="sig-name descname">ThresholdExpertBot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">bot_id</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">start</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">sighup_event</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">disable_multithreading</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>bool<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="headerlink" href="#intelmq.bots.experts.threshold.expert.ThresholdExpertBot" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="intelmq.lib.html#intelmq.lib.bot.Bot" title="intelmq.lib.bot.Bot"><code class="xref py py-class docutils literal notranslate"><span class="pre">intelmq.lib.bot.Bot</span></code></a></p>
<p>Check if the number of similar messages during a specified time interval exceeds a set value</p>
<dl class="py attribute">
<dt id="intelmq.bots.experts.threshold.expert.ThresholdExpertBot.add_keys">
<code class="sig-name descname">add_keys</code><em class="property">: dict</em><em class="property"> = {'comment': 'Threshold reached'}</em><a class="headerlink" href="#intelmq.bots.experts.threshold.expert.ThresholdExpertBot.add_keys" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="intelmq.bots.experts.threshold.expert.ThresholdExpertBot.bypass">
<code class="sig-name descname">bypass</code><em class="property"> = False</em><a class="headerlink" href="#intelmq.bots.experts.threshold.expert.ThresholdExpertBot.bypass" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="intelmq.bots.experts.threshold.expert.ThresholdExpertBot.filter_keys">
<code class="sig-name descname">filter_keys</code><em class="property">: Iterable</em><em class="property"> = ['raw', 'time.observation']</em><a class="headerlink" href="#intelmq.bots.experts.threshold.expert.ThresholdExpertBot.filter_keys" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="intelmq.bots.experts.threshold.expert.ThresholdExpertBot.filter_type">
<code class="sig-name descname">filter_type</code><em class="property">: str</em><em class="property"> = 'blacklist'</em><a class="headerlink" href="#intelmq.bots.experts.threshold.expert.ThresholdExpertBot.filter_type" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="intelmq.bots.experts.threshold.expert.ThresholdExpertBot.init">
<code class="sig-name descname">init</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#intelmq.bots.experts.threshold.expert.ThresholdExpertBot.init" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="intelmq.bots.experts.threshold.expert.ThresholdExpertBot.process">
<code class="sig-name descname">process</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#intelmq.bots.experts.threshold.expert.ThresholdExpertBot.process" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="intelmq.bots.experts.threshold.expert.ThresholdExpertBot.redis_cache_db">
<code class="sig-name descname">redis_cache_db</code><em class="property">: int</em><em class="property"> = 11</em><a class="headerlink" href="#intelmq.bots.experts.threshold.expert.ThresholdExpertBot.redis_cache_db" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="intelmq.bots.experts.threshold.expert.ThresholdExpertBot.redis_cache_host">
<code class="sig-name descname">redis_cache_host</code><em class="property">: str</em><em class="property"> = '127.0.0.1'</em><a class="headerlink" href="#intelmq.bots.experts.threshold.expert.ThresholdExpertBot.redis_cache_host" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="intelmq.bots.experts.threshold.expert.ThresholdExpertBot.redis_cache_password">
<code class="sig-name descname">redis_cache_password</code><em class="property">: Optional<span class="p">[</span>str<span class="p">]</span></em><em class="property"> = None</em><a class="headerlink" href="#intelmq.bots.experts.threshold.expert.ThresholdExpertBot.redis_cache_password" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="intelmq.bots.experts.threshold.expert.ThresholdExpertBot.redis_cache_port">
<code class="sig-name descname">redis_cache_port</code><em class="property">: int</em><em class="property"> = 6379</em><a class="headerlink" href="#intelmq.bots.experts.threshold.expert.ThresholdExpertBot.redis_cache_port" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="intelmq.bots.experts.threshold.expert.ThresholdExpertBot.threshold">
<code class="sig-name descname">threshold</code><em class="property">: int</em><em class="property"> = 100</em><a class="headerlink" href="#intelmq.bots.experts.threshold.expert.ThresholdExpertBot.threshold" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="intelmq.bots.experts.threshold.expert.ThresholdExpertBot.timeout">
<code class="sig-name descname">timeout</code><em class="property">: int</em><em class="property"> = 3600</em><a class="headerlink" href="#intelmq.bots.experts.threshold.expert.ThresholdExpertBot.timeout" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-intelmq.bots.experts.threshold">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-intelmq.bots.experts.threshold" title="Permalink to this headline">¶</a></h2>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/Logo_Intel_MQ.svg" alt="Logo"/>
    
  </a>
</p>



<p class="blurb">IntelMQ is a solution for IT security teams for collecting and processing security feeds using a message queuing protocol.</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=certtools&repo=intelmq&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/upgrade.html">Upgrade instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/configuration-management.html">Configuration and Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/bots.html">Bots</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/intelmqctl.html">intelmqctl documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/feeds.html">Feeds</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/FAQ.html">Frequently asked questions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/intelmq-api.html">IntelMQ API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/intelmq-manager.html">IntelMQ Manager</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user/ecosystem.html">IntelMQ Ecosystem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/ELK-Stack.html">ELK Stack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/MISP-Integrations.html">MISP integrations in IntelMQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/n6-integrations.html">IntelMQ - n6 Integration</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dev/guide.html">Developers Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/harmonization-fields.html">Harmonization field names</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/release-procedure.html">Release procedure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/feeds-wishlist.html">Feeds wishlist</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2021, cert.at.
      
      |
      <a href="../_sources/source/intelmq.bots.experts.threshold.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>