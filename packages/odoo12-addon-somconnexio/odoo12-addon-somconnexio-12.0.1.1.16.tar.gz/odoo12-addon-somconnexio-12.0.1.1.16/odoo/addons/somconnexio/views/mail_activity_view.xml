<?xml version="1.0" encoding="UTF-8"?>
<odoo>
  <record id="mail_activity_view_tree" model="ir.ui.view">
    <field name="name">mail.activity.boards.view.tree</field>
    <field name="model">mail.activity</field>
    <field name="inherit_id" ref="mail_activity_board.mail_activity_view_tree" />
    <field name="arch" type="xml">
      <xpath expr="//tree" position="attributes">
        <attribute name="decoration-danger">(date_deadline &lt; current_date and date_done == False)</attribute>
        <attribute name="decoration-warning">(date_deadline == current_date and date_done == False)</attribute>
        <attribute name="decoration-success">(date_deadline &gt; current_date and date_done == False)</attribute>
      </xpath>
      <field name="res_name" position="before">
        <field name="id" widget="open_tab"/>
      </field>
      <field name="date_deadline" position="before">
        <field name="res_model_id_name"/>
        <field name="location"/>
        <field name="create_date"/>
        <field name="activity_type_name" invisible="1"/>
        <field name="create_user_id"/>
      </field>
    </field>
  </record>

  <record id="act_res_partner_2_mail_activity_tree_view" model="ir.actions.act_window.view">
    <field name="sequence">0</field>
    <field name="view_mode">tree</field>
    <field name="act_window_id" ref="act_res_partner_2_mail_activity" />
    <field name="view_id" ref="mail_activity_view_tree"/>
  </record>
  <record id="act_contract_contract_2_mail_activity_tree_view" model="ir.actions.act_window.view">
    <field name="sequence">0</field>
    <field name="view_mode">tree</field>
    <field name="act_window_id" ref="act_contract_contract_2_mail_activity" />
    <field name="view_id" ref="mail_activity_view_tree"/>
  </record>

  <record id="mail_activity_view_form_board" model="ir.ui.view">
    <field name="name">mail.activity.boards.view.form</field>
    <field name="model">mail.activity</field>
    <field name="inherit_id" ref="mail_activity_board.mail_activity_view_form_board" />
    <field name="arch" type="xml">
      <field name="res_model_id_name" position="after">
        <field name="reference" widget="reference" string="Record"/>
        <field name="state"/>
      </field>
      <field name="note" position="after">
        <field name="location" />
        <field name="create_date"/>
        <field name="force_next" invisible="1"/>
      </field>
      <field name="date_deadline" position="after">
        <field name="date_done" readonly="1" />
        <field name="create_user_id" readonly="1" />
      </field>
      <xpath expr="//field[@name='note']/.." position="after">
          <field name="done" invisible="1" />
          <footer>
              <button attrs="{'invisible': ['|',('force_next', '=', True),('done', '!=', False)]}" string="Mark as Done" name="action_done" type="object" class="btn-secondary" context="{'mail_activity_quick_update': True}"/>
              <button attrs="{'invisible': ['|',('force_next', '=', True),('done', '!=', False)]}" string="Done &amp; Schedule Next" name="action_done_schedule_next" type="object" class="btn-secondary" context="{'mail_activity_quick_update': True}"/>
              <button attrs="{'invisible': [('force_next', '=', False)]}" string="Done &amp; Launch Next" name="action_done_schedule_next" type="object" class="btn-secondary" context="{'mail_activity_quick_update': True}"/>
              <button attrs="{'invisible': [('done', '=', False)]}" string="Reopen" name="action_reopen" type="object" class="btn-secondary" context="{'mail_activity_quick_update': True}"/>
          </footer>
      </xpath>
      <form position="attributes">
        <attribute name="edit">true</attribute>
      </form>
    </field>
  </record>

  <record id="act_res_partner_2_mail_activity_form_view" model="ir.actions.act_window.view">
    <field name="sequence">1</field>
    <field name="view_mode">form</field>
    <field name="act_window_id" ref="act_res_partner_2_mail_activity" />
    <field name="view_id" ref="mail_activity_view_form_board"/>
  </record>

  <record id="act_contract_contract_2_mail_activity_form_view" model="ir.actions.act_window.view">
    <field name="sequence">1</field>
    <field name="view_mode">form</field>
    <field name="act_window_id" ref="act_contract_contract_2_mail_activity" />
    <field name="view_id" ref="mail_activity_view_form_board"/>
  </record>

  <record id="mail_activity_view_search" model="ir.ui.view">
    <field name="name">mail.activity.boards.view.search</field>
    <field name="model">mail.activity</field>
    <field name="inherit_id" ref="mail_activity_board.mail_activity_view_search"/>
    <field name="arch" type="xml">
      <filter name="activities_upcoming_all" position="after">
        <separator/>
        <filter
          string="Returned first time"
          name="activities_return_1st"
          domain="[('activity_type_name', '=', 'Return 1st'), ('done', '=', False)]"/>
        <filter
          string="Returned more than one time"
          name="activities_return_n"
          domain="[('activity_type_name', '=', 'Return n'), ('done', '=', False)]"/>
      </filter>
      <field name="user_id" position="after">
        <field name="partner_id" />
        <field name="res_model" />
        <field name="res_id" />
      </field>
    </field>
  </record>
  <record id="mail_activity_view_form_popup" model="ir.ui.view">
    <field name="name">mail.activity.view.form.popup</field>
    <field name="model">mail.activity</field>
    <field name="inherit_id" ref="mail.mail_activity_view_form_popup" />
    <field name="arch" type="xml">
      <field name="user_id" position="after">
        <field name="location" />
      </field>
    </field>
  </record>
  <record id="mail_activity_view_form_popup_activity_done" model="ir.ui.view">
    <field name="name">mail.activity.view.form.popup.activity.done</field>
    <field name="model">mail.activity</field>
    <field name="inherit_id" ref="mail_activity_done.mail_activity_view_form_popup" />
    <field name="arch" type="xml">
      <field name="date_done" position="attributes">
        <attribute name="invisible">1</attribute>
      </field>
    </field>
  </record>
</odoo>
