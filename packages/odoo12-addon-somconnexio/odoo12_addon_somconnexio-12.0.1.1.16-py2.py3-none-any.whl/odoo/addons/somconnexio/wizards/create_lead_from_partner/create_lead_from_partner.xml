<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
  <data>
    <record id="view_form_partner_create_lead_wizard" model="ir.ui.view">
       <field name="name">Partner Lead Create Wizard</field>
       <field name="model">partner.create.lead.wizard</field>
       <field name="arch" type="xml">
           <form>
              <field name="available_email_ids" invisible="1" />
              <field name="service_type" invisible="1" />
              <h1>
                     <field name="title"/>
              </h1>
              <group col="2">
                     <group name="basic info">
                            <field name="opportunity"/>
                            <field name="partner_id"/>
                            <field name="bank_id"
                                   options="{'no_create_edit':True}"
                                   domain="[('partner_id', '=', partner_id)]"/>
                            <field name="email_id" widget="many2one_tags_crm_lead_email"
                                   options="{'no_create_edit':True}"
                                   context="{'email_tags': True}"
                                   domain="[('id', 'in', available_email_ids)]"
                            />
                            <field name="phone_contact"/>
                            <field name="product_id"
                                   options="{'no_create_edit':True}"
                                   domain="[('product_tmpl_id.categ_id.id', 'in', [
                                                 %(somconnexio.mobile_service)d,
                                                 %(somconnexio.broadband_fiber_service)d,
                                                 %(somconnexio.broadband_adsl_service)d
                                          ]),
                                          ('discontinued', '=', False)]"/>
                            <field name="icc"
                                   attrs="{'invisible':[('service_type','!=','mobile')]}"/>
                            <field name="type"/>
                            <separator/>
                     </group>
                     <group name="portability info">
                            <field name="previous_contract_type"
                                   attrs="{'required': [('service_type','=','mobile'),
                                                        ('type','=','portability')],
                                           'invisible': ['|', ('service_type','!=','mobile'),
                                                        ('type','!=','portability')]
                                          }"/>
                             <field name="phone_number"
                                   attrs="{'required': [('service_type','=','mobile'),
                                                        ('type','=','portability')],
                                           'invisible': ['|', ('service_type','!=','mobile'),
                                                        ('type','!=','portability')]
                                          }"/>
                            <field name="donor_icc"
                                   attrs="{'required': [('service_type','=','mobile'),
                                                        ('type','=','portability'),
                                                        ('previous_contract_type', '=', 'prepaid')],
                                           'invisible': ['|', ('service_type','!=','mobile'),
                                                        ('type','!=','portability')]
                                          }"/>
                            <field name="previous_mobile_provider"
                                   domain="[('mobile', '=', True)]"
                                   options="{'no_create_edit':True}"
                                   attrs="{'required': [('service_type','=','mobile'),
                                                        ('type','=','portability')],
                                           'invisible': ['|', ('service_type','!=','mobile'),
                                                        ('type','!=','portability')]
                                          }"/>
                            <field name="keep_landline"
                                   attrs="{'invisible': ['|', ('service_type','!=','BA'),
                                                        ('type','!=','portability')]
                                          }"/>
                            <field name="landline"
                                   attrs="{'required': [('keep_landline','=', True)],
                                           'invisible': ['|', ('service_type','!=','BA'),
                                                        ('type','!=','portability')]
                                          }"/>
                            <field name="previous_BA_service"
                                   attrs="{'required': [('service_type','=','BA'),
                                                        ('type','=','portability')],
                                           'invisible': ['|', ('service_type','!=','BA'),
                                                        ('type','!=','portability')]
                                          }"/>
                            <field name="previous_BA_provider"
                                   domain="[('broadband', '=', True)]"
                                   options="{'no_create_edit':True}"
                                   attrs="{'required': [('service_type','=','BA'),
                                                        ('type','=','portability')],
                                           'invisible': ['|', ('service_type','!=','BA'),
                                                        ('type','!=','portability')]
                                          }"/>
                            <field name="previous_owner_vat_number"
                                   attrs="{'invisible':[('type','!=','portability')]}"/>
                            <field name="previous_owner_first_name"
                                   attrs="{'invisible':[('type','!=','portability')]}"/>
                            <field name="previous_owner_name"
                                   attrs="{'invisible':[('type','!=','portability')]}"/>
                     </group>
              </group>
              <group col="2">
                     <group string="Delivery address">
                            <field name="delivery_country_id"
                                   options="{'no_create_edit':True}"/>
                            <field name="delivery_state_id"
                                   domain="[('country_id', '=', delivery_country_id)]"
                                   options="{'no_create_edit':True}"/>
                            <field name="delivery_street" />
                            <field name="delivery_zip_code" />
                            <field name="delivery_city" />
                     </group>
                     <group string="Invoice address">
                            <field name="invoice_country_id"
                                   options="{'no_create_edit':True}"/>
                            <field name="invoice_state_id"
                                   domain="[('country_id', '=', invoice_country_id)]"
                                   options="{'no_create_edit':True}"/>
                            <field name="invoice_street" />
                            <field name="invoice_zip_code" />
                            <field name="invoice_city" />
                     </group>
              </group>
              <group col="2">
                     <group string="Service address"
                            attrs="{'invisible':[('service_type','!=','BA')]}">
                            <field name="service_country_id"
                                   options="{'no_create_edit':True}"
                                   attrs="{'required': [('service_type','=','BA')]}"/>
                            <field name="service_state_id"
                                   domain="[('country_id', '=', service_country_id)]"
                                   options="{'no_create_edit':True}"
                                   attrs="{'required': [('service_type','=','BA')]}"/>
                            <field name="service_street"
                                   attrs="{'required': [('service_type','=','BA')]}"/>
                            <field name="service_zip_code"
                                   attrs="{'required': [('service_type','=','BA')]}"/>
                            <field name="service_city"
                                   attrs="{'required': [('service_type','=','BA')]}"/>
                     </group>
                     <group name="empty group">
                     </group>
              </group>
              <footer>
                     <button type="object" name="create_lead" string="Create" />
                     <button special="cancel" string="Cancel" class="btn-secondary"/>
              </footer>
           </form>
       </field>
    </record>
    <act_window id="action_partner_lead_create_wizard"
                name="Create Lead"
                res_model="partner.create.lead.wizard"
                view_type="form"
                view_mode="form"
                target="new"
                />
    <record id="view_partner_form_lead_creation_wizard_button" model="ir.ui.view">
      <field name="name">partner.form.lead.creation.wizard.button</field>
      <field name="model">res.partner</field>
      <field name="inherit_id" ref="easy_my_coop.view_partner_form_easy_my_coop"/>
      <field name="arch" type="xml">
        <button id="action_view_update_partner_info" position="after">
            <button name="%(action_partner_lead_create_wizard)d"
                string="Create Lead"
                type="action"
                context="{'default_active_id': active_id}"
                />
        </button>
      </field>
    </record>
  </data>
</odoo>