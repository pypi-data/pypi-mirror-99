(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[2259],{52259:(e,t,n)=>{"use strict";n.r(t),n.d(t,{DEFAULT_SCREEN_DPI:()=>_,METERS_PER_UNIT:()=>v,GOOGLE_MERCATOR:()=>E,EXTENT_TO_ZOOM_HOOK:()=>S,ZOOM_TO_EXTENT_HOOK:()=>h,RESOLUTIONS_HOOK:()=>b,RESOLUTION_HOOK:()=>T,COMPUTE_BBOX_HOOK:()=>M,GET_PIXEL_FROM_COORDINATES_HOOK:()=>I,GET_COORDINATES_FROM_PIXEL_HOOK:()=>x,registerHook:()=>C,getHook:()=>P,executeHook:()=>H,clearHooks:()=>k,dpi2dpm:()=>w,dpi2dpu:()=>N,getSphericalMercatorScale:()=>D,getGoogleMercatorScale:()=>G,getSphericalMercatorScales:()=>K,getGoogleMercatorScales:()=>U,getResolutionsForScales:()=>L,getGoogleMercatorResolutions:()=>j,getResolutions:()=>F,getScales:()=>A,getZoomFromResolution:()=>X,defaultGetZoomForExtent:()=>Z,getZoomForExtent:()=>B,getCurrentResolution:()=>z,getCenterForExtent:()=>V,getBbox:()=>q,isNearlyEqual:()=>W,mapUpdated:()=>Y,transformExtent:()=>$,groupSaveFormatted:()=>J,saveMapConfiguration:()=>Q,generateNewUUIDs:()=>ee,mergeMapConfigs:()=>te,addRootParentGroup:()=>ne,isSimpleGeomType:()=>re,getSimpleGeomType:()=>oe,getIdFromUri:()=>ie,parseLayoutValue:()=>ae,prepareMapObjectToCompare:()=>ue,updateObjectFieldKey:()=>ce,compareMapChanges:()=>se,createRegisterHooks:()=>le,default:()=>fe});var r=n(96486),o=n(23570),i=n.n(o),a=n(90183),u=n(61868),c=n(24262),s=n(27418),l=n.n(s);function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function p(e){return function(e){if(Array.isArray(e))return d(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var _=96,v={m:1,degrees:111194.87428468118,ft:.3048,"us-ft":1200/3937},E={RADIUS:6378137,TILE_WIDTH:256,ZOOM_FACTOR:2},S="EXTENT_TO_ZOOM_HOOK",h="ZOOM_TO_EXTENT_HOOK",b="RESOLUTIONS_HOOK",T="RESOLUTION_HOOK",M="COMPUTE_BBOX_HOOK",I="GET_PIXEL_FROM_COORDINATES_HOOK",x="GET_COORDINATES_FROM_PIXEL_HOOK",R={};function C(e,t){R[e]=t}function P(e){return R[e]}function H(e,t,n){var r=P(e);return r?t(r):n?n():null}function k(){R={}}function w(e){return e*(100/2.54)}function N(e,t){var n=(0,a.getUnits)(t||"EPSG:3857");return v[n]*w(e||_)}function D(e,t,n,r,o){return 2*Math.PI*e/(t*Math.pow(n,r)/w(o||_))}function G(e,t){return D(E.RADIUS,E.TILE_WIDTH,E.ZOOM_FACTOR,e,t)}function K(e,t,n,r,o,i){for(var a=[],u=r;u<=o;u++)a.push(D(e,t,n,u,i));return a}function U(e,t,n){return K(E.RADIUS,E.TILE_WIDTH,E.ZOOM_FACTOR,e,t,n)}function L(e,t,n){var r=N(n,t);return e.map((function(e){return e/r}))}function j(e,t,n){return L(U(e,t,n),"EPSG:3857",n)}function F(){return P("RESOLUTIONS_HOOK")?P("RESOLUTIONS_HOOK")():j(0,21,_)}function A(e,t){var n=N(t,e);return F().map((function(e){return e*n}))}function X(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:F(),n=t.map((function(t,n){return{diff:Math.abs(t-e),zoom:n}})),o=(0,r.minBy)(n,"diff"),i=o.zoom;return i}function Z(e,t,n,r,o,i){var a=e[2]-e[0],u=e[3]-e[1],c=Math.abs(a/t.width),s=Math.abs(u/t.height),l=Math.max(c,s),f=(i||L(U(n,r,o||_),"EPSG:3857",o)).reduce((function(e,t,n){var r=Math.abs(t-l);return r>e.diff?e:{diff:r,zoom:n}}),{diff:Number.POSITIVE_INFINITY,zoom:0}).zoom;return Math.max(0,Math.min(f,r))}function B(e,t,n,r,o){return P("EXTENT_TO_ZOOM_HOOK")?P("EXTENT_TO_ZOOM_HOOK")(e,t,n,r,o):Z(e,t,n,r,o,P("RESOLUTIONS_HOOK")?P("RESOLUTIONS_HOOK")(e,t,n,r,o,w(o||_)):null)}function z(e,t,n,r){return P("RESOLUTION_HOOK")?P("RESOLUTION_HOOK")(e,t,n,r):j(t,n,r)[e]}function V(e,t){var n=(e[2]-e[0])/2,r=(e[3]-e[1])/2;return{x:e[0]+n,y:e[1]+r,crs:t}}function q(e,t){return H("COMPUTE_BBOX_HOOK",(function(n){return n(e,t)}))}var W=function(e,t){return void 0!==e&&void 0!==t&&e.toFixed(12)-t.toFixed(12)==0};function Y(e,t){var n,o,i,a;return!(!e||(0,r.isEmpty)(e)||!t||(0,r.isEmpty)(t)||W(null==t||null===(n=t.center)||void 0===n?void 0:n.x,null==e||null===(o=e.center)||void 0===o?void 0:o.x)&&W(null==t||null===(i=t.center)||void 0===i?void 0:i.y,null==e||null===(a=e.center)||void 0===a?void 0:a.y)&&(null==t?void 0:t.zoom)===(null==e?void 0:e.zoom))}function $(e,t,n,r){var o=(0,a.getUnits)(e);return"ft"===o?{width:n/v.ft,height:r/v.ft}:"us-ft"===o?{width:n/v["us-ft"],height:r/v["us-ft"]}:"degrees"===o?{width:n/(111132.92-559.82*Math.cos(2*t.y)+1.175*Math.cos(4*t.y)),height:r/(111412.84*Math.cos(t.y)-93.5*Math.cos(3*t.y))}:{width:n,height:r}}var J=function(e){return{id:e.id,title:e.title,description:e.description,tooltipOptions:e.tooltipOptions,tooltipPlacement:e.tooltipPlacement,expanded:e.expanded}};function Q(e,t,n,o,i,a,s){var f={center:e.center,maxExtent:e.maxExtent,projection:e.projection,units:e.units,mapInfoControl:e.mapInfoControl,zoom:e.zoom,mapOptions:e.mapOptions||{}},g=t.map((function(e){return(0,c.saveLayer)(e)})),p=n.reduce((function(e,t){return e.concat((0,c.getGroupNodes)(t))}),[].concat(n.map((function(e){return e.id})))).map((function(e){var t=(0,c.getNode)(n,e);return t&&t.nodes?J(t):null})).filter((function(e){return e})),d=o.filter((function(e){return!!e.thumbnail})),O=(0,c.extractSourcesFromLayers)(g),y=g.map((function(e){return l()({},e,{tileMatrixSet:e.tileMatrixSet&&e.tileMatrixSet.length>0,matrixIds:e.matrixIds&&Object.keys(e.matrixIds)})})),_=(0,r.findIndex)(y,(function(e){return"annotations"===e.id}));if(-1!==_){var v=y[_].features.map((function(e){return"FeatureCollection"===e.type?m(m({},e),{},{features:e.features.map((function(e){return e.properties.geometryGeodesic?(0,u.t8)("properties.geometryGeodesic",null,e):e}))}):e.properties.geometryGeodesic?(0,u.t8)("properties.geometryGeodesic",null,e):{}}));y[_]=(0,u.t8)("features",v,y[_])}return m({version:2,map:l()({},f,{layers:y,groups:p,backgrounds:d,text_search_config:i,bookmark_search_config:a},!(0,r.isEmpty)(O)&&{sources:O}||{})},s)}var ee=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(0,r.cloneDeep)(e),n=m(m({},(0,r.get)(e,"map.layers",[]).reduce((function(e,t){return m(m({},e),{},y({},t.id,"annotations"===t.id?t.id:i()()))}),{})),(0,r.get)(e,"widgetsConfig.widgets",[]).reduce((function(e,t){return m(m({},e),{},y({},t.id,i()()))}),{}));return(0,u.t8)("map.backgrounds",(0,r.get)(e,"map.backgrounds",[]).map((function(e){return m(m({},e),{},{id:n[e.id]})})),(0,u.t8)("widgetsConfig",{collapsed:(0,r.mapValues)((0,r.mapKeys)((0,r.get)(e,"widgetsConfig.collapsed",{}),(function(e,t){return n[t]})),(function(e){return m(m({},e),{},{layouts:(0,r.mapValues)(e.layouts,(function(e){return m(m({},e),{},{i:n[e.i]})}))})})),layouts:(0,r.mapValues)((0,r.get)(e,"widgetsConfig.layouts",{}),(function(e){return e.map((function(e){return m(m({},e),{},{i:n[e.i]})}))})),widgets:(0,r.get)(e,"widgetsConfig.widgets",[]).map((function(e){return m(m({},e),{},{id:n[e.id],layer:m(m({},(0,r.get)(e,"layer",{})),{},{id:n[(0,r.get)(e,"layer.id")]})})}))},(0,u.t8)("map.layers",(0,r.get)(e,"map.layers",[]).map((function(e){return m(m({},e),{},{id:n[e.id]})})),t)))},te=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.map((function(e){return(0,r.pick)(e,(0,r.keys)(e).filter((function(t){return void 0!==e[t]})))}))},o=ee(t),i=[].concat(p((0,r.get)(e,"map.backgrounds",[])),p((0,r.get)(o,"map.backgrounds",[]))),a=n((0,r.get)(e,"map.layers",[])),u=n((0,r.get)(o,"map.layers",[])),c=(0,r.find)(a,(function(e){return"annotations"===e.id})),s=(0,r.find)(u,(function(e){return"annotations"===e.id})),l=[].concat(p(u.filter((function(e){return"annotations"!==e.id}))),p(a.filter((function(e){return"annotations"!==e.id}))),p(c||s?[m(m(m({},c||{}),s||{}),{},{features:[].concat(p((0,r.get)(c,"features",[])),p((0,r.get)(s,"features",[])))})]:[])),f=l.filter((function(e){return"background"===e.group})),g=(0,r.findIndex)(f,(function(e){return e.visibility})),d=(0,r.get)(e,"map.sources",{}),O=(0,r.get)(o,"map.sources",{}),_=m(m({},d),O),v=(0,r.get)(e,"widgetsConfig",{}),E=(0,r.get)(o,"widgetsConfig",{});return m(m(m({},o),e),{},{catalogServices:m(m({},(0,r.get)(e,"catalogServices",{})),{},{services:m(m({},(0,r.get)(e,"catalogServices.services",{})),(0,r.get)(o,"catalogServices.services",{}))}),map:m(m(m({},o.map),e.map),{},{backgrounds:i,groups:(0,r.uniqWith)([].concat(p((0,r.get)(e,"map.groups",[])),p((0,r.get)(o,"map.groups",[]))),(function(e,t){return e.id===t.id})),layers:[].concat(p(f.slice(0,g+1)),p(f.slice(g+1).map((function(e){return m(m({},e),{},{visibility:!1})}))),p(l.filter((function(e){return"background"!==e.group})))),sources:(0,r.isEmpty)(_)?void 0:_}),widgetsConfig:{collapsed:m(m({},v.collapsed),E.collapsed),layouts:(0,r.uniq)([].concat(p((0,r.keys)(v.layouts)),p((0,r.keys)(E.layouts)))).reduce((function(e,t){return m(m({},e),{},y({},t,[].concat(p((0,r.get)(v,"layouts.".concat(t),[])),p((0,r.get)(E,"layouts.".concat(t),[])))))}),{}),widgets:[].concat(p((0,r.get)(v,"widgets",[])),p((0,r.get)(E,"widgets",[])))},timelineData:m(m({},(0,r.get)(e,"timelineData",{})),(0,r.get)(o,"timelineData",{})),dimensionData:m(m({},(0,r.get)(e,"dimensionData",{})),(0,r.get)(o,"dimensionData",{}))})},ne=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"RootGroup",n=(0,r.get)(e,"map.groups",[]),o=n.filter((function(e){return"Default"!==e.id})),a=(0,r.find)(n,(function(e){return"Default"===e.id})),u=a&&{id:i()(),title:t,expanded:a.expanded},c=a?[].concat(p(o.map((function(e){var t=e.id,n=g(e,["id"]);return m({id:"".concat(u.id,".").concat(t)},n)}))),[u]):o;return m(m({},e),{},{map:m(m({},e.map),{},{groups:c,layers:(0,r.get)(e,"map.layers",[]).map((function(e){var t,n=e.group;return m(m({},g(e,["group"])),{},{group:!a||"background"===n||"Default"!==n&&n?a&&(null===(t=(0,r.find)(c,(function(e){var t=e.id;return t.slice(t.indexOf(".")+1)===n})))||void 0===t?void 0:t.id)||n:u.id})}))})})};function re(e){switch(e){case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":case"Text":return!1;case"Point":case"Circle":case"LineString":case"Polygon":default:return!0}}function oe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Point";switch(e){case"Point":case"LineString":case"Polygon":case"Circle":return e;case"MultiPoint":case"Marker":return"Point";case"MultiLineString":return"LineString";case"MultiPolygon":return"Polygon";case"GeometryCollection":return"GeometryCollection";case"Text":return"Point";default:return e}}var ie=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:/data\/(\d+)/,n=decodeURIComponent(e),r=t.exec(n);return r&&r.length&&r.length>1?r[1]:null},ae=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return(0,r.isString)(e)&&-1!==e.indexOf("%")?parseFloat((0,r.trim)(e))*t/100:(0,r.isNumber)(e)?e:0},ue=function e(t){var n=["apiKey","time","args","fixed"],r=function(e){return n.reduce((function(t,n){return t||e===n}),!1)};Object.keys(t).forEach((function(n){var o=t[n],i=f(o);"object"!==i||null===o||r(n)?"undefined"!==i&&o&&!r(n)||delete t[n]:(e(o),Object.keys(o).length||delete t[n])}))},ce=function(e,t,n){e[t]&&(Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(e,t)),delete e[t])},se=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=["map.layers","map.backgrounds","map.text_search_config","map.bookmark_search_config","map.text_serch_config","map.zoom","widgetsConfig"],o=(0,r.pick)((0,r.cloneDeep)(e),n),i=(0,r.pick)((0,r.cloneDeep)(t),n);return ce(o.map,"text_serch_config","text_search_config"),ce(i.map,"text_serch_config","text_search_config"),ue(o),ue(i),(0,r.isEqual)(o,i)},le=function(){var e={};return{registerHook:function(t,n){e[t]=n},getHook:function(t){return e[t]},executeHook:function(t,n,r){var o=e[t];return o?n(o):r?r():null}}};const fe={createRegisterHooks:le,EXTENT_TO_ZOOM_HOOK:S,RESOLUTIONS_HOOK:b,RESOLUTION_HOOK:T,COMPUTE_BBOX_HOOK:M,GET_PIXEL_FROM_COORDINATES_HOOK:I,GET_COORDINATES_FROM_PIXEL_HOOK:x,DEFAULT_SCREEN_DPI:_,ZOOM_TO_EXTENT_HOOK:h,registerHook:C,getHook:P,dpi2dpm:w,getSphericalMercatorScales:K,getSphericalMercatorScale:D,getGoogleMercatorScales:U,getGoogleMercatorResolutions:j,getGoogleMercatorScale:G,getResolutionsForScales:L,getZoomForExtent:B,defaultGetZoomForExtent:Z,getCenterForExtent:V,getResolutions:F,getScales:A,getBbox:q,mapUpdated:Y,getCurrentResolution:z,transformExtent:$,saveMapConfiguration:Q,generateNewUUIDs:ee,mergeMapConfigs:te,addRootParentGroup:ne,isSimpleGeomType:re,getSimpleGeomType:oe,getIdFromUri:ie,parseLayoutValue:ae,prepareMapObjectToCompare:ue,updateObjectFieldKey:ce,compareMapChanges:se,clearHooks:k}}}]);