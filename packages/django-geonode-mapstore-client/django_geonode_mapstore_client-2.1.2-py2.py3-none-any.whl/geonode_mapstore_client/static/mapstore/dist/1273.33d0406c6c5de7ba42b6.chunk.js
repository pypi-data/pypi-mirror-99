(self.webpackChunkgeonode_mapstore_client=self.webpackChunkgeonode_mapstore_client||[]).push([[1273],{31273:(e,t,n)=>{"use strict";n.d(t,{WX:()=>s,V3:()=>c,xi:()=>l,ur:()=>p,CO:()=>y,mh:()=>f,$Y:()=>d,UT:()=>L,tt:()=>m,nX:()=>A,Rc:()=>v,K4:()=>O,Dw:()=>C,In:()=>T,N3:()=>h,SU:()=>b,ye:()=>R,m:()=>x,ky:()=>E,E9:()=>S});var r=n(59551),i=n(67007),a=n(3475),o=n(32354),u=(n(24262),n(37275),n(96486),n(88113),n(75110),n(97395));r.Z,i.ZP,a.Z,o.Z;var s="CATALOG:ADD_LAYERS_FROM_CATALOGS",c="CATALOG:TEXT_SEARCH",l="CATALOG:RESET_CATALOG",p="CATALOG:CATALOG_CLOSE",y="CATALOG:CHANGE_TEXT",f="CATALOG:ADD_SERVICE",d="CATALOG:DELETE_SERVICE",L="CATALOG:GET_METADATA_RECORD_BY_ID",g="CATALOG:SET_LOADING";function m(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.format,n=e.url,r=e.startPosition,i=e.maxRecords,a=e.text,o=e.options,u=void 0===o?{}:o;return{type:c,format:t,url:n,startPosition:r,maxRecords:i,text:a,options:u}}function A(e,t){return{type:"CATALOG:RECORD_LIST_LOADED",searchOptions:e,result:t}}function v(e){return{type:"CATALOG:SAVING_SERVICE",status:e}}function O(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{type:g,loading:e}}function C(e){return{type:"CATALOG:CHANGE_SELECTED_SERVICE",service:e}}function T(e,t){return{type:"CATALOG:CHANGE_CATALOG_MODE",mode:e,isNew:t}}function h(e){return{type:"CATALOG:ADD_CATALOG_SERVICE",service:e}}function b(e){return{type:"CATALOG:DELETE_CATALOG_SERVICE",service:e}}function R(){return{type:l}}function x(e){return{type:"CATALOG:RECORD_LIST_LOAD_ERROR",error:e}}function E(e){return{type:L,metadataOptions:e}}function S(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return(0,u.vU)({title:"catalog.notification.errorTitle",message:"catalog.notification.errorSearchingRecords",values:{records:e}})}},67007:(e,t,n)=>{"use strict";n.d(t,{ZP:()=>b});var r=n(8575),i=n(96486),a=n.n(i),o=n(27418),u=n.n(o),s=n(5055),c=n.n(s),l=n(75875),p=n.n(l),y=n(37275),f=n(90183);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function L(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){g(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var m={},A=function(e){var t=(a().isArray(e)&&e||e.split(","))[0],n=r.parse(t,!0);return r.format(u()({},n,{search:null},{query:u()({service:"WMS",version:"1.3.0",request:"GetCapabilities"},n.query)}))},v=function(e){var t=e&&e.Title,n=e.LogoURL&&L(L({},a().get(e,"LogoURL.$")||{}),{},{format:a().get(e,"LogoURL.Format")}),r=a().get(e,'OnlineResource.$["xlink:href"]');return{title:t,logo:n,imageUrl:a().get(e,'LogoURL.OnlineResource.$["xlink:href"]'),link:r}},O=function e(t){return t.Layer?(a().isArray(t.Layer)&&t.Layer||[t.Layer]).reduce((function(t,n){return t.concat(e(n)).concat(n.Layer&&n.Name?[n]:[])}),[]):t.Name&&[t]||[]},C=function(e){return e.Request&&e.Request.GetMap&&e.Request.GetMap.DCPType&&e.Request.GetMap.DCPType.HTTP&&e.Request.GetMap.DCPType.HTTP.Get&&e.Request.GetMap.DCPType.HTTP.Get.OnlineResource&&e.Request.GetMap.DCPType.HTTP.Get.OnlineResource.$||void 0},T=function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,o=arguments.length>3?arguments[3]:void 0,s=(n.WMS_Capabilities||n.WMT_MS_Capabilities||{}).Capability,c=(n.WMS_Capabilities||n.WMT_MS_Capabilities||{}).Service,l=C(s),p=s.Layer&&(s.Layer.SRS||s.Layer.CRS)||[],y=s.Layer&&s.Layer.Attribution&&v(s.Layer.Attribution),f=s.Request&&s.Request.GetMap&&s.Request.GetMap.Format||[],d=O(s),L=a().isArray(d)?d:[d],g=L.filter((function(e){return!o||-1!==e.Name.toLowerCase().indexOf(o.toLowerCase())||e.Title&&-1!==e.Title.toLowerCase().indexOf(o.toLowerCase())||e.Abstract&&-1!==e.Abstract.toLowerCase().indexOf(o.toLowerCase())}));return{numberOfRecordsMatched:g.length,numberOfRecordsReturned:Math.min(i,g.length),nextRecord:r+Math.min(i,g.length)+1,service:c,layerOptions:{version:(null===(e=n.WMS_Capabilities||n.WMT_MS_Capabilities)||void 0===e||null===(t=e.$)||void 0===t?void 0:t.version)||"1.3.0"},records:g.filter((function(e,t){return t>=r-1&&t<r-1+i})).map((function(e){return u()({},e,{formats:f,onlineResource:l,SRS:p,credits:e.Attribution?v(e.Attribution):y})}))}},h=function(e,t,n,r){var i=m[e];return i&&(new Date).getTime()<i.timestamp+1e3*((0,y.u8)("cacheExpire")||60)?new Promise((function(e){e(T(i.data,t,n,r))})):p().get(A(e)).then((function(i){var a;return c().parseString(i.data,{explicitArray:!1},(function(e,t){a=t})),m[e]={timestamp:(new Date).getTime(),data:a},T(a,t,n,r)}))};const b={flatLayers:O,parseUrl:A,getDimensions:function(e){return a().castArray(e.Dimension||e.dimension||[]).map((function(t,n){var r=e.Extent&&a().castArray(e.Extent)[n]||e.extent&&a().castArray(e.extent)[n];return{name:t.$.name,units:t.$.units,unitSymbol:t.$.unitSymbol,default:t.$.default||r&&r.$.default,values:t._&&t._.split(",")||r&&r._&&r._.split(",")}}))},getCapabilities:function(e,t){var i=r.parse(e,!0),a=r.format(u()({},i,{query:u()({service:"WMS",version:"1.1.1",request:"GetCapabilities"},i.query)}));return new Promise((function(e){Promise.all([n.e(9942),n.e(7260)]).then(function(){var r=n(67260).unmarshaller;e(p().get(A(a)).then((function(e){var n;if(t)return c().parseString(e.data,{explicitArray:!1},(function(e,t){n=t})),n;var i=r.unmarshalString(e.data);return i&&i.value})))}.bind(null,n)).catch(n.oe)}))},describeLayer:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=r.parse(e,!0),o=r.format(u()({},a,{query:u()({service:"WMS",version:"1.1.1",layers:t,request:"DescribeLayer"},a.query,i.query||{})}));return new Promise((function(e){Promise.all([n.e(9942),n.e(7260)]).then(function(){var t=n(67260).unmarshaller;e(p().get(A(o)).then((function(e){var n=t.unmarshalString(e.data);return n&&n.value&&n.value.layerDescription&&n.value.layerDescription[0]})))}.bind(null,n)).catch(n.oe)}))},getRecords:h,describeLayers:function(e,t){var n=r.parse(e,!0),i=r.format(u()({},n,{query:u()({service:"WMS",version:"1.1.1",layers:t,request:"DescribeLayer"},n.query)}));return p().get(A(i)).then((function(e){var t;return c().parseString(e.data,{explicitArray:!1},(function(e,n){t=n&&n.WMS_DescribeLayerResponse&&n.WMS_DescribeLayerResponse.LayerDescription})),(t=Array.isArray(t)?t:[t]).map((function(e){return L(L({},e&&e.$||{}),{},{layerName:e&&e.$&&e.$.name,query:L({},e&&e.query&&e.query.$||{})})}))}))},textSearch:function(e,t,n,r){return h(e,t,n,r)},parseLayerCapabilities:function e(t,n,r){return a().castArray(r||a().get(t,"capability.layer.layer")).reduce((function(r,i){return r||(!i.name&&i.layer?e(t,n,a().castArray(i.layer)):2===n.name.split(":").length&&i.name&&2===i.name.split(":").length?n.name===i.name&&i:i.name&&2===i.name.split(":").length?n.name===i.name.split(":")[1]&&i:2===n.name.split(":").length?n.name.split(":")[1]===i.name&&i:n.name===i.name&&i)}),null)},getBBox:function(e,t){for(var n=e,r=n.EX_GeographicBoundingBox||n.exGeographicBoundingBox||(0,f.getWMSBoundingBox)(n.BoundingBox)||n.LatLonBoundingBox&&n.LatLonBoundingBox.$||n.latLonBoundingBox;!r&&n.Layer&&n.Layer.length;)r=(n=n.Layer[0]).EX_GeographicBoundingBox||n.exGeographicBoundingBox||(0,f.getWMSBoundingBox)(n.BoundingBox)||n.LatLonBoundingBox&&n.LatLonBoundingBox.$||n.latLonBoundingBox;r||(r={westBoundLongitude:-180,southBoundLatitude:-90,eastBoundLongitude:180,northBoundLatitude:90});var i={extent:[r.westBoundLongitude||r.minx,r.southBoundLatitude||r.miny,r.eastBoundLongitude||r.maxx,r.northBoundLatitude||r.maxy],crs:"EPSG:4326"};return t?{crs:i.crs,bounds:{minx:i.extent[0],miny:i.extent[1],maxx:i.extent[2],maxy:i.extent[3]}}:i},reset:function(){Object.keys(m).forEach((function(e){delete m[e]}))}}}}]);