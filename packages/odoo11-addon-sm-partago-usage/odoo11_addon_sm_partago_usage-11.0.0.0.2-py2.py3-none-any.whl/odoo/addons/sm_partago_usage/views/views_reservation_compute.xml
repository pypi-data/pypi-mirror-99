<odoo>
  <data>

    <record id="view_reservation_compute_window" model="ir.actions.act_window">
      <field name="name">Reservation Computes</field>
      <field name="res_model">smp.sm_reservation_compute</field>
      <field name="view_mode">tree,form,pivot</field>
    </record>

    <record id="research_current_car" model="ir.actions.server">
      <field name="name">Search current car</field>
      <field name="type">ir.actions.server</field>
      <field name="model_id" ref="model_smp_sm_reservation_compute"/>
      <field name="binding_model_id" ref="model_smp_sm_reservation_compute"/>
      <field name="state">code</field>
      <field name="code">action = model.reset_current_car_from_action()</field>
    </record>

    <record id="view_reservation_compute_mark_forgiven_workflow" model="ir.actions.server">
      <field name="name">Mark as forgiven</field>
      <field name="type">ir.actions.server</field>
      <field name="model_id" ref="model_smp_sm_reservation_compute"/>
      <field name="binding_model_id" ref="model_smp_sm_reservation_compute"/>
      <field name="state">code</field>
      <field name="code">action = model.mark_as_forgiven()</field>
    </record>

    <record id="view_reservation_compute_mark_toinvoice_workflow" model="ir.actions.server">
      <field name="name">Mark as to-invoice</field>
      <field name="type">ir.actions.server</field>
      <field name="model_id" ref="model_smp_sm_reservation_compute"/>
      <field name="binding_model_id" ref="model_smp_sm_reservation_compute"/>
      <field name="state">code</field>
      <field name="code">action = model.mark_as_toinvoice()</field>
    </record>

    <record id="view_reservation_compute_update_values" model="ir.actions.server">
      <field name="name">Update values</field>
      <field name="type">ir.actions.server</field>
      <field name="model_id" ref="model_smp_sm_reservation_compute"/>
      <field name="binding_model_id" ref="model_smp_sm_reservation_compute"/>
      <field name="state">code</field>
      <field name="code">action = model.calculate_values()</field>
    </record>

    <record id="view_reservation_compute_autoforgive" model="ir.actions.server">
      <field name="name">Autoforgive</field>
      <field name="type">ir.actions.server</field>
      <field name="model_id" ref="model_smp_sm_reservation_compute"/>
      <field name="binding_model_id" ref="model_smp_sm_reservation_compute"/>
      <field name="state">code</field>
      <field name="code">action = model.autoforgive()</field>
    </record>

    <record id="view_reservation_compute_search" model="ir.ui.view">
      <field name="name">smp.reservation_compute.search</field>
      <field name="model">smp.sm_reservation_compute</field>
      <field name="type">search</field>
      <field name="arch" type="xml">
        <search string="Reservation search">
          <field name="name"/>
          <field name="carconfig_id"/>
          <field name="member_id"/>
          <filter string="To invoice" name="reservations_to_invoice"
            domain="[('compute_invoiced','=',False), ('compute_forgiven', '=', False)]"/>
          <filter string="Anomaly reservation" name="anomaly_reservation"
            domain="['&amp;','&amp;',('compute_invoiced','=',False), ('compute_forgiven', '=', False),'|',('non_usage_mins_invoiced','>','300'),('extra_usage_mins_invoiced','>','300')]"/>
        </search>
      </field>
    </record>

    <record id="view_reservation_compute_list" model="ir.ui.view">
      <field name="name">smp.reservation_compute.tree</field>
      <field name="model">smp.sm_reservation_compute</field>
      <field name="type">tree</field>
      <field name="arch" type="xml">

        <tree>
          <field name="name"/>
          <field name="carconfig_id"/>
          <field name="member_id"/>
          <field name="cs_user_type"/>
          <field name="related_company"/>
          <field name="startTimechar"/>
          <field name="effectiveStartTimechar"/>
          <field name="effectiveEndTimechar"/>
          <field name="endTimechar"/>
        </tree>

      </field>
    </record>

    <record id="view_reservation_compute_pivot" model="ir.ui.view">
      <field name="name">smp.reservation_compute.pivot</field>
      <field name="model">smp.sm_reservation_compute</field>
      <field name="type">pivot</field>
      <field name="arch" type="xml">

        <pivot>
          <field name="name" type="row"/>
        </pivot>

      </field>
    </record>

    <record id="view_reservation_compute_form" model="ir.ui.view">
      <field name="name">smp.reservation_compute.form</field>
      <field name="model">smp.sm_reservation_compute</field>
      <field name="type">form</field>
      <field name="arch" type="xml">
        <form string="Edit place" version="7.0" delete="false">
          <header>
            <button name="create_edit_reservation_compute_wizard" type="object"
              string="Edit dates"/>
          </header>
          <sheet>
            <notebook>
              <page string="General">
                <group>
                  <field name="compute_invoiced"/>
                  <field name="compute_forgiven"/>
                  <field name="compute_cancelled"/>
                  <field name="compute_unused"/>
                  <field name="ignore_update"/>
                  <field name="credits"/>
                  <field name="price"/>
                </group>
                <group>
                  <field name="name"/>
                  <field name="member_id"/>
                  <field name="cs_user_type"/>
                </group>
                <group col="4">
                  <field name="related_company"/>
                  <field name="related_company_object"/>
                </group>
                <group col="4">
                  <field name="carconfig_id"/>
                  <field name="current_car"/>
                  <field name="related_current_car"/>
                </group>
                <group col="4">
                  <field name="startTimechar" readonly="1"/>
                  <field name="effectiveStartTimechar" readonly="1"/>
                  <field name="endTimechar" readonly="1"/>
                  <field name="effectiveEndTimechar" readonly="1"/>
                </group>
                <group col="4">
                  <field name="duration"/>
                  <field name="effectiveDuration"/>
                  <field name="initial_fuel_level"/>
                  <field name="final_fuel_level"/>
                  <field name="used_mileage"/>
                  <field name="fuel_consume"/>
                </group>
                <group>
                  <field name="observations"/>
                </group>
              </page>
              <page string="Accounting">
                <group>
                  <field name="usage_mins_invoiced" string="Used mins (Total)"/>
                  <field name="non_usage_mins_invoiced" string="Not used mins (Total)"/>
                  <field name="extra_usage_mins_invoiced" string="Extra used mins (Total)"/>
                </group>
                <group>
                  <field name="usage_mins_nontariff" string="Used mins (NONtariff)"/>
                  <field name="non_usage_mins_nontariff" string="Not used mins (NONtariff)"/>
                  <field name="extra_usage_mins_nontariff" string="Extra used mins (NONtariff)"/>
                </group>
                <group>
                  <field name="usage_mins_tariff" string="Used mins (Tariff)"/>
                  <field name="non_usage_mins_tariff" string="Not used mins (Tariff)"/>
                  <field name="extra_usage_mins_tariff" string="Extra used mins (Tariff)"/>
                </group>
                <group>
                  <field name="total_usage_days_invoiced"
                       string="Total used days (NONtariff-invoice)"/>
                  <field name="total_usage_mins_invoiced"
                       string="Total used mins (NONtariff-invoice)"/>
                  <field name="total_usage_days_tariff" string="Total used days (tariff-invoice)"/>
                  <field name="total_usage_mins_tariff" string="Total used mins (tariff-invoice)"/>
                  <field name="fuel_consume_invoiced" string="Fuel consume (invoice)"/>
                  <field name="used_mileage_invoiced" string="Used mileage (invoice)"/>
                </group>
              </page>
            </notebook>
          </sheet>
        </form>
      </field>
    </record>

    <menuitem name="Reservation computes" id="sm_partago_usage.computations" parent="sm_partago_usage.menu_root"
      action="view_reservation_compute_window"/>

  </data>
</odoo>
