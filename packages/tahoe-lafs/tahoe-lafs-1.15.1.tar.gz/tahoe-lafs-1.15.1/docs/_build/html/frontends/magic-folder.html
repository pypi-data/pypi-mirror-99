
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Tahoe-LAFS Magic Folder Frontend &#8212; Tahoe-LAFS 1.x documentation</title>
    <link rel="stylesheet" href="../_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Download status" href="download-status.html" />
    <link rel="prev" title="Tahoe-LAFS SFTP and FTP Frontends" href="FTP-and-SFTP.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="download-status.html" title="Download status"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="FTP-and-SFTP.html" title="Tahoe-LAFS SFTP and FTP Frontends"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Tahoe-LAFS 1.x documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="tahoe-lafs-magic-folder-frontend">
<h1>Tahoe-LAFS Magic Folder Frontend<a class="headerlink" href="#tahoe-lafs-magic-folder-frontend" title="Permalink to this headline">¶</a></h1>
<ol class="arabic simple">
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#configuration">Configuration</a></li>
<li><a class="reference internal" href="#known-issues-and-limitations-with-magic-folder">Known Issues and Limitations With Magic-Folder</a></li>
</ol>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The Magic Folder frontend synchronizes local directories on two or more
clients, using a Tahoe-LAFS grid for storage. Whenever a file is created
or changed under the local directory of one of the clients, the change is
propagated to the grid and then to the other clients.</p>
<p>The implementation of the “drop-upload” frontend, on which Magic Folder is
based, was written as a prototype at the First International Tahoe-LAFS
Summit in June 2011. In 2015, with the support of a grant from the
<a class="reference external" href="https://www.opentech.fund/">Open Technology Fund</a>, it was redesigned and extended to support
synchronization between clients. It currently works on Linux and Windows.</p>
<p>Magic Folder is not currently in as mature a state as the other frontends
(web, CLI, SFTP and FTP). This means that you probably should not rely on
all changes to files in the local directory to result in successful uploads.
There might be (and have been) incompatible changes to how the feature is
configured.</p>
<p>We are very interested in feedback on how well this feature works for you, and
suggestions to improve its usability, functionality, and reliability.</p>
</div>
<div class="section" id="configuration">
<h2>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h2>
<p>The Magic Folder frontend runs as part of a gateway node. To set it up, you
must use the tahoe magic-folder CLI. For detailed information see our
<a class="reference internal" href="../proposed/magic-folder/user-interface-design.html"><span class="doc">Magic-Folder CLI design
documentation</span></a>. For a
given Magic-Folder collective directory you need to run the <code class="docutils literal notranslate"><span class="pre">tahoe</span>
<span class="pre">magic-folder</span> <span class="pre">create</span></code> command. After that the <code class="docutils literal notranslate"><span class="pre">tahoe</span> <span class="pre">magic-folder</span> <span class="pre">invite</span></code>
command must used to generate an <em>invite code</em> for each member of the
magic-folder collective. A confidential, authenticated communications channel
should be used to transmit the invite code to each member, who will be
joining using the <code class="docutils literal notranslate"><span class="pre">tahoe</span> <span class="pre">magic-folder</span> <span class="pre">join</span></code> command.</p>
<p>These settings are persisted in the <code class="docutils literal notranslate"><span class="pre">[magic_folder]</span></code> section of the
gateway’s <code class="docutils literal notranslate"><span class="pre">tahoe.cfg</span></code> file.</p>
<p><code class="docutils literal notranslate"><span class="pre">[magic_folder]</span></code></p>
<p><code class="docutils literal notranslate"><span class="pre">enabled</span> <span class="pre">=</span> <span class="pre">(boolean,</span> <span class="pre">optional)</span></code></p>
<blockquote>
<div>If this is <code class="docutils literal notranslate"><span class="pre">True</span></code>, Magic Folder will be enabled. The default value is
<code class="docutils literal notranslate"><span class="pre">False</span></code>.</div></blockquote>
<p><code class="docutils literal notranslate"><span class="pre">local.directory</span> <span class="pre">=</span> <span class="pre">(UTF-8</span> <span class="pre">path)</span></code></p>
<blockquote>
<div>This specifies the local directory to be monitored for new or changed
files. If the path contains non-ASCII characters, it should be encoded
in UTF-8 regardless of the system’s filesystem encoding. Relative paths
will be interpreted starting from the node’s base directory.</div></blockquote>
<p>You should not normally need to set these fields manually because they are
set by the <code class="docutils literal notranslate"><span class="pre">tahoe</span> <span class="pre">magic-folder</span> <span class="pre">create</span></code> and/or <code class="docutils literal notranslate"><span class="pre">tahoe</span> <span class="pre">magic-folder</span> <span class="pre">join</span></code>
commands. Use the <code class="docutils literal notranslate"><span class="pre">--help</span></code> option to these commands for more information.</p>
<p>After setting up a Magic Folder collective and starting or restarting each
gateway, you can confirm that the feature is working by copying a file into
any local directory, and checking that it appears on other clients.
Large files may take some time to appear.</p>
<p>The ‘Operational Statistics’ page linked from the Welcome page shows counts
of the number of files uploaded, the number of change events currently
queued, and the number of failed uploads. The ‘Recent Uploads and Downloads’
page and the node <a class="reference internal" href="../logging.html"><span class="doc">log</span></a> may be helpful to determine the
cause of any failures.</p>
</div>
<div class="section" id="known-issues-and-limitations-with-magic-folder">
<span id="known-issues-in-magic-folder"></span><h2>Known Issues and Limitations With Magic-Folder<a class="headerlink" href="#known-issues-and-limitations-with-magic-folder" title="Permalink to this headline">¶</a></h2>
<p>This feature only works on Linux and Windows. There is a ticket to add
support for Mac OS X and BSD-based systems (<a class="reference external" href="https://tahoe-lafs.org/trac/tahoe-lafs/ticket/1432">#1432</a>).</p>
<p>The only way to determine whether uploads have failed is to look at the
‘Operational Statistics’ page linked from the Welcome page. This only shows
a count of failures, not the names of files. Uploads are never retried.</p>
<p>The Magic Folder frontend performs its uploads sequentially (i.e. it waits
until each upload is finished before starting the next), even when there
would be enough memory and bandwidth to efficiently perform them in parallel.
A Magic Folder upload can occur in parallel with an upload by a different
frontend, though. (<a class="reference external" href="https://tahoe-lafs.org/trac/tahoe-lafs/ticket/1459">#1459</a>)</p>
<p>On Linux, if there are a large number of near-simultaneous file creation or
change events (greater than the number specified in the file
<code class="docutils literal notranslate"><span class="pre">/proc/sys/fs/inotify/max_queued_events</span></code>), it is possible that some events
could be missed. This is fairly unlikely under normal circumstances, because
the default value of <code class="docutils literal notranslate"><span class="pre">max_queued_events</span></code> in most Linux distributions is
16384, and events are removed from this queue immediately without waiting for
the corresponding upload to complete. (<a class="reference external" href="https://tahoe-lafs.org/trac/tahoe-lafs/ticket/1430">#1430</a>)</p>
<p>The Windows implementation might also occasionally miss file creation or
change events, due to limitations of the underlying Windows API
(ReadDirectoryChangesW). We do not know how likely or unlikely this is.
(<a class="reference external" href="https://tahoe-lafs.org/trac/tahoe-lafs/ticket/1431">#1431</a>)</p>
<p>Some filesystems may not support the necessary change notifications.
So, it is recommended for the local directory to be on a directly attached
disk-based filesystem, not a network filesystem or one provided by a virtual
machine.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">private/magic_folder_dircap</span></code> and <code class="docutils literal notranslate"><span class="pre">private/collective_dircap</span></code> files
cannot use an alias or path to specify the upload directory. (<a class="reference external" href="https://tahoe-lafs.org/trac/tahoe-lafs/ticket/1711">#1711</a>)</p>
<p>If a file in the upload directory is changed (actually relinked to a new
file), then the old file is still present on the grid, and any other caps
to it will remain valid. Eventually it will be possible to use
<a class="reference internal" href="../garbage-collection.html"><span class="doc">Garbage Collection in Tahoe</span></a> to reclaim the space used by these files; however
currently they are retained indefinitely. (<a class="reference external" href="https://tahoe-lafs.org/trac/tahoe-lafs/ticket/2440">#2440</a>)</p>
<p>Unicode filenames are supported on both Linux and Windows, but on Linux, the
local name of a file must be encoded correctly in order for it to be uploaded.
The expected encoding is that printed by
<code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-c</span> <span class="pre">&quot;import</span> <span class="pre">sys;</span> <span class="pre">print</span> <span class="pre">sys.getfilesystemencoding()&quot;</span></code>.</p>
<p>On Windows, local directories with non-ASCII names are not currently working.
(<a class="reference external" href="https://tahoe-lafs.org/trac/tahoe-lafs/ticket/2219">#2219</a>)</p>
<p>On Windows, when a node has Magic Folder enabled, it is unresponsive to Ctrl-C
(it can only be killed using Task Manager or similar). (<a class="reference external" href="https://tahoe-lafs.org/trac/tahoe-lafs/ticket/2218">#2218</a>)</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="../index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Tahoe-LAFS Magic Folder Frontend</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#configuration">Configuration</a></li>
<li><a class="reference internal" href="#known-issues-and-limitations-with-magic-folder">Known Issues and Limitations With Magic-Folder</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="FTP-and-SFTP.html"
                        title="previous chapter">Tahoe-LAFS SFTP and FTP Frontends</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="download-status.html"
                        title="next chapter">Download status</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/frontends/magic-folder.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="download-status.html" title="Download status"
             >next</a> |</li>
        <li class="right" >
          <a href="FTP-and-SFTP.html" title="Tahoe-LAFS SFTP and FTP Frontends"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">Tahoe-LAFS 1.x documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016, The Tahoe-LAFS Developers.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
  </body>
</html>