
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>The Convergence Secret &#8212; Tahoe-LAFS 1.x documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Garbage Collection in Tahoe" href="garbage-collection.html" />
    <link rel="prev" title="The Tahoe Upload Helper" href="helper.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="garbage-collection.html" title="Garbage Collection in Tahoe"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="helper.html" title="The Tahoe Upload Helper"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Tahoe-LAFS 1.x documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="the-convergence-secret">
<h1>The Convergence Secret<a class="headerlink" href="#the-convergence-secret" title="Permalink to this headline">¶</a></h1>
<div class="section" id="what-is-it">
<h2>What Is It?<a class="headerlink" href="#what-is-it" title="Permalink to this headline">¶</a></h2>
<p>The identifier of a file (also called the “capability” to a file) is derived
from two pieces of information when the file is uploaded: the content of the
file and the upload client’s “convergence secret”. By default, the
convergence secret is randomly generated by the client when it first starts
up, then stored in the client’s base directory (&lt;Tahoe’s node
dir&gt;/private/convergence) and re-used after that. So the same file content
uploaded from the same client will always have the same cap. Uploading the
file from a different client with a different convergence secret would result
in a different cap – and in a second copy of the file’s contents stored on
the grid. If you want files you upload to converge (also known as
“deduplicate”) with files uploaded by someone else, just make sure you’re
using the same convergence secret when you upload files as them.</p>
<p>The advantages of deduplication should be clear, but keep in mind that the
convergence secret was created to protect confidentiality. There are two
attacks that can be used against you by someone who knows the convergence
secret you use.</p>
<p>The first one is called the “Confirmation-of-a-File Attack”. Someone who
knows the convergence secret that you used when you uploaded a file, and who
has a copy of that file themselves, can check whether you have a copy of that
file. This is usually not a problem, but it could be if that file is, for
example, a book or movie that is banned in your country.</p>
<p>The second attack is more subtle. It is called the
“Learn-the-Remaining-Information Attack”. Suppose you’ve received a
confidential document, such as a PDF from your bank which contains many pages
of boilerplate text as well as containing your bank account number and
balance. Someone who knows your convergence secret can generate a file with
all of the boilerplate text (perhaps they would open an account with the same
bank so they receive the same document with their account number and
balance). Then they can try a “brute force search” to find your account
number and your balance.</p>
<p>The defense against these attacks is that only someone who knows the
convergence secret that you used on each file can perform these attacks on
that file.</p>
<p>Both of these attacks and the defense are described in more detail in <a class="reference external" href="https://tahoe-lafs.org/hacktahoelafs/drew_perttula.html">Drew
Perttula’s Hack Tahoe-LAFS Hall Of Fame entry</a></p>
</div>
<div class="section" id="what-if-i-change-my-convergence-secret">
<h2>What If I Change My Convergence Secret?<a class="headerlink" href="#what-if-i-change-my-convergence-secret" title="Permalink to this headline">¶</a></h2>
<p>All your old file capabilities will still work, but the new data that you
upload will not be deduplicated with the old data. If you upload all of the
same things to the grid, you will end up using twice the space until garbage
collection kicks in (if it’s enabled). Changing the convergence secret that a
storage client uses for uploads can be though of as moving the client to a
new “deduplication domain”.</p>
</div>
<div class="section" id="how-to-use-it">
<h2>How To Use It<a class="headerlink" href="#how-to-use-it" title="Permalink to this headline">¶</a></h2>
<p>To enable deduplication between different clients, <strong>securely</strong> copy the
convergence secret file from one client to all the others.</p>
<p>For example, if you are on host A and have an account on host B and you have
scp installed, run:</p>
<blockquote>
<div><em>scp ~/.tahoe/private/convergence
my_other_account&#64;B:.tahoe/private/convergence</em></div></blockquote>
<p>If you have two different clients on a single computer, say one for each
disk, you would do:</p>
<blockquote>
<div><em>cp /tahoe1/private/convergence /tahoe2/private/convergence</em></div></blockquote>
<p>After you change the convergence secret file, you must restart the client
before it will stop using the old one and read the new one from the file.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">The Convergence Secret</a><ul>
<li><a class="reference internal" href="#what-is-it">What Is It?</a></li>
<li><a class="reference internal" href="#what-if-i-change-my-convergence-secret">What If I Change My Convergence Secret?</a></li>
<li><a class="reference internal" href="#how-to-use-it">How To Use It</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="helper.html"
                        title="previous chapter">The Tahoe Upload Helper</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="garbage-collection.html"
                        title="next chapter">Garbage Collection in Tahoe</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/convergence-secret.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="garbage-collection.html" title="Garbage Collection in Tahoe"
             >next</a> |</li>
        <li class="right" >
          <a href="helper.html" title="The Tahoe Upload Helper"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Tahoe-LAFS 1.x documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2016, The Tahoe-LAFS Developers.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.
    </div>
  </body>
</html>